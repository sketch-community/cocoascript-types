{
  "abstract": [
    {
      "type": "text",
      "text": "Provide regular updates to Maps about the status of a booked ride."
    }
  ],
  "documentVersion": 0,
  "hierarchy": {
    "paths": [
      [
        "doc://com.apple.documentation/documentation/technologies",
        "doc://com.apple.documentation/documentation/sirikit",
        "doc://com.apple.documentation/documentation/sirikit/ride_booking",
        "doc://com.apple.documentation/documentation/sirikit/ingetridestatusintentresponseobserver"
      ],
      [
        "doc://com.apple.documentation/documentation/technologies",
        "doc://com.apple.documentation/documentation/sirikit",
        "doc://com.apple.documentation/documentation/sirikit/ride_booking",
        "doc://com.apple.documentation/documentation/sirikit/ride_booking/handling_the_ride-booking_intents"
      ]
    ]
  },
  "identifier": {
    "url": "doc://com.apple.documentation/documentation/sirikit/ingetridestatusintentresponseobserver/providing_live_status_updates",
    "interfaceLanguage": "occ"
  },
  "legacy_identifier": 2865107,
  "kind": "article",
  "metadata": {
    "title": "Providing Live Status Updates",
    "role": "article",
    "roleHeading": "Article"
  },
  "schemaVersion": {
    "major": 0,
    "minor": 1,
    "patch": 0
  },
  "sections": [],
  "variants": [
    {
      "traits": [
        {
          "interfaceLanguage": "occ"
        }
      ],
      "paths": [
        "documentation/sirikit/ingetridestatusintentresponseobserver/providing_live_status_updates",
        "documentation/sirikit/ride_booking/handling_the_ride-booking_intents/providing_live_status_updates"
      ]
    },
    {
      "traits": [
        {
          "interfaceLanguage": "swift"
        }
      ],
      "paths": [
        "documentation/sirikit/ingetridestatusintentresponseobserver/providing_live_status_updates",
        "documentation/sirikit/ride_booking/handling_the_ride-booking_intents/providing_live_status_updates"
      ]
    }
  ],
  "references": {
    "doc://com.apple.documentation/documentation/sirikit": {
      "title": "SiriKit",
      "identifier": "doc://com.apple.documentation/documentation/sirikit",
      "url": "/documentation/sirikit",
      "type": "topic",
      "kind": "symbol",
      "role": "collection"
    },
    "doc://com.apple.documentation/documentation/sirikit/ride_booking": {
      "title": "Ride Booking",
      "identifier": "doc://com.apple.documentation/documentation/sirikit/ride_booking",
      "url": "/documentation/sirikit/ride_booking",
      "type": "topic",
      "kind": "article",
      "role": "collectionGroup"
    },
    "doc://com.apple.documentation/documentation/sirikit/ingetridestatusintentresponseobserver": {
      "title": "INGetRideStatusIntentResponseObserver",
      "identifier": "doc://com.apple.documentation/documentation/sirikit/ingetridestatusintentresponseobserver",
      "url": "/documentation/sirikit/ingetridestatusintentresponseobserver",
      "type": "topic",
      "kind": "symbol",
      "role": "symbol"
    },
    "doc://com.apple.documentation/documentation/sirikit/ride_booking/handling_the_ride-booking_intents": {
      "title": "Handling the Ride-Booking Intents",
      "identifier": "doc://com.apple.documentation/documentation/sirikit/ride_booking/handling_the_ride-booking_intents",
      "url": "/documentation/sirikit/ride_booking/handling_the_ride-booking_intents",
      "type": "topic",
      "kind": "article",
      "role": "article"
    },
    "doc://com.apple.documentation/documentation/sirikit/ingetridestatusintenthandling/1649845-startsendingupdatesforgetridesta": {
      "title": "startSendingUpdatesForGetRideStatus:toObserver:",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/sirikit/ingetridestatusintenthandling/1649845-startsendingupdatesforgetridesta",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/sirikit/ingetridestatusintenthandling/1649845-startsendingupdatesforgetridesta",
      "fragments": [
        {
          "kind": "text",
          "text": "- "
        },
        {
          "kind": "identifier",
          "text": "startSendingUpdatesForGetRideStatus:toObserver:"
        }
      ]
    },
    "doc://com.apple.documentation/documentation/sirikit/ingetridestatusintenthandling": {
      "title": "INGetRideStatusIntentHandling",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/sirikit/ingetridestatusintenthandling",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/sirikit/ingetridestatusintenthandling"
    },
    "doc://com.apple.documentation/documentation/sirikit/ingetridestatusintentresponseobserver/providing_live_status_updates#2865108": {
      "title": "Listing 1",
      "type": "section",
      "identifier": "doc://com.apple.documentation/documentation/sirikit/ingetridestatusintentresponseobserver/providing_live_status_updates#2865108",
      "kind": "article",
      "role": "codeListing",
      "url": "/documentation/sirikit/ingetridestatusintentresponseobserver/providing_live_status_updates#2865108",
      "abstract": [
        {
          "type": "text",
          "text": "Generating live updates for a booked ride"
        }
      ]
    },
    "doc://com.apple.documentation/documentation/sirikit/inridestatus": {
      "title": "INRideStatus",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/sirikit/inridestatus",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/sirikit/inridestatus"
    },
    "doc://com.apple.documentation/documentation/sirikit/inridestatus/1648490-phase": {
      "title": "phase",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/sirikit/inridestatus/1648490-phase",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/sirikit/inridestatus/1648490-phase"
    },
    "doc://com.apple.documentation/documentation/sirikit/inridephase/inridephaseunknown": {
      "title": "INRidePhaseUnknown",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/sirikit/inridephase/inridephaseunknown",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/sirikit/inridephase/inridephaseunknown"
    },
    "doc://com.apple.documentation/documentation/sirikit/inridephase/inridephasecompleted": {
      "title": "INRidePhaseCompleted",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/sirikit/inridephase/inridephasecompleted",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/sirikit/inridephase/inridephasecompleted"
    },
    "doc://com.apple.documentation/documentation/sirikit/inridestatus/2127692-completionstatus": {
      "title": "completionStatus",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/sirikit/inridestatus/2127692-completionstatus",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/sirikit/inridestatus/2127692-completionstatus"
    },
    "doc://com.apple.documentation/documentation/sirikit/inridestatus/1648484-rideidentifier": {
      "title": "rideIdentifier",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/sirikit/inridestatus/1648484-rideidentifier",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/sirikit/inridestatus/1648484-rideidentifier"
    },
    "doc://com.apple.documentation/documentation/sirikit/inridestatus/1648482-rideoption": {
      "title": "rideOption",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/sirikit/inridestatus/1648482-rideoption",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/sirikit/inridestatus/1648482-rideoption"
    },
    "doc://com.apple.documentation/documentation/sirikit/inridevehicle/1649590-mapannotationimage": {
      "title": "mapAnnotationImage",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/sirikit/inridevehicle/1649590-mapannotationimage",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/sirikit/inridevehicle/1649590-mapannotationimage"
    },
    "doc://com.apple.documentation/documentation/sirikit/inridevehicle": {
      "title": "INRideVehicle",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/sirikit/inridevehicle",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/sirikit/inridevehicle"
    },
    "doc://com.apple.documentation/documentation/sirikit/ingetridestatusintenthandling/1649844-stopsendingupdatesforgetridestat": {
      "title": "stopSendingUpdatesForGetRideStatus:",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/sirikit/ingetridestatusintenthandling/1649844-stopsendingupdatesforgetridestat",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/sirikit/ingetridestatusintenthandling/1649844-stopsendingupdatesforgetridestat",
      "fragments": [
        {
          "kind": "text",
          "text": "- "
        },
        {
          "kind": "identifier",
          "text": "stopSendingUpdatesForGetRideStatus:"
        }
      ]
    },
    "doc://com.apple.documentation/documentation/sirikit/ingetridestatusintentresponseobserver/providing_live_status_updates#2865109": {
      "title": "Listing 2",
      "type": "section",
      "identifier": "doc://com.apple.documentation/documentation/sirikit/ingetridestatusintentresponseobserver/providing_live_status_updates#2865109",
      "kind": "article",
      "role": "codeListing",
      "url": "/documentation/sirikit/ingetridestatusintentresponseobserver/providing_live_status_updates#2865109",
      "abstract": [
        {
          "type": "text",
          "text": "Stopping live updates"
        }
      ]
    },
    "doc://com.apple.documentation/documentation/sirikit/ingetridestatusintentresponseobserver/providing_live_status_updates": {
      "title": "Providing Live Status Updates",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/sirikit/ingetridestatusintentresponseobserver/providing_live_status_updates",
      "kind": "article",
      "role": "article",
      "url": "/documentation/sirikit/ingetridestatusintentresponseobserver/providing_live_status_updates",
      "abstract": [
        {
          "type": "text",
          "text": "Provide regular updates to Maps about the status of a booked ride."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/sirikit/ingetridestatusintentresponseobserver/1639309-getridestatusresponsedidupdate": {
      "title": "getRideStatusResponseDidUpdate:",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/sirikit/ingetridestatusintentresponseobserver/1639309-getridestatusresponsedidupdate",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/sirikit/ingetridestatusintentresponseobserver/1639309-getridestatusresponsedidupdate",
      "required": true,
      "abstract": [
        {
          "type": "text",
          "text": "Call this method when you have updated information about the ride."
        }
      ],
      "fragments": [
        {
          "kind": "text",
          "text": "- "
        },
        {
          "kind": "identifier",
          "text": "getRideStatusResponseDidUpdate:"
        }
      ]
    },
    "doc://com.apple.documentation/documentation/technologies": {
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/technologies",
      "url": "/documentation/technologies",
      "kind": "technologies",
      "title": "Technologies"
    }
  },
  "seeAlsoSections": [
    {
      "identifiers": [
        "doc://com.apple.documentation/documentation/sirikit/ingetridestatusintentresponseobserver/1639309-getridestatusresponsedidupdate"
      ],
      "title": "Updating the Status of a Ride",
      "generated": true
    }
  ],
  "primaryContentSections": [
    {
      "kind": "content",
      "content": [
        {
          "anchor": "overview",
          "level": 2,
          "text": "Overview",
          "type": "heading"
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "After the user books a ride, Maps may call the "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/sirikit/ingetridestatusintenthandling/1649845-startsendingupdatesforgetridesta"
            },
            {
              "type": "text",
              "text": " method of your "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/sirikit/ingetridestatusintenthandling"
            },
            {
              "type": "text",
              "text": " handler object to ask for live status updates. Maps calls this method only once. Your implementation must set up a timer or other repeating task to generate status updates for the ride and deliver them to the provided observer object. Maps uses your updates to keep the user informed about the ride’s location and estimated arrival time."
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/sirikit/ingetridestatusintentresponseobserver/providing_live_status_updates#2865108"
            },
            {
              "type": "text",
              "text": " shows a skeletal implementation of the "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/sirikit/ingetridestatusintenthandling/1649845-startsendingupdatesforgetridesta"
            },
            {
              "type": "text",
              "text": " method that sets up a timer for generating status updates. Because the system can call this method may on any thread, the implementation sets up the timer on the main thread, which ensures that the timer continues to fire."
            }
          ]
        },
        {
          "type": "codeListing",
          "code": [
            "public func startSendingUpdates(forGetRideStatus intent: INGetRideStatusIntent, ",
            "            to observer: INGetRideStatusIntentResponseObserver) {",
            "   // Save a reference to the observer object",
            "   self.observer = observer",
            "   // Set up the timer on the main thread and save a reference to it.",
            "   DispatchQueue.main.async {",
            "      self.timer = Timer.scheduledTimer(withTimeInterval: 5, ",
            "                      repeats: true, block: { (timer) in",
            "         let rideStatus = INRideStatus()",
            "         // FOR YOU TO DO: Configure the INRideStatus object.",
            "",
            "         // Create the response and deliver it.",
            "         let response = INGetRideStatusIntentResponse(code: .success, userActivity: nil)",
            "         response.rideStatus = rideStatus",
            "         self.observer?.didUpdate(getRideStatus: response)",
            "      })",
            "   }",
            "} "
          ],
          "syntax": "swift",
          "metadata": {
            "anchor": "2865108",
            "title": "Listing 1",
            "abstract": [
              {
                "type": "text",
                "text": "Generating live updates for a booked ride"
              }
            ]
          }
        },
        {
          "type": "paragraph",
          "inlineContent": []
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "When crafting your response, always include a valid "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/sirikit/inridestatus"
            },
            {
              "type": "text",
              "text": " object. Here are some tips for configuring the status object to ensure that SiriKit processes your updates successfully:"
            }
          ]
        },
        {
          "type": "unorderedList",
          "items": [
            {
              "content": [
                {
                  "type": "paragraph",
                  "inlineContent": [
                    {
                      "type": "strong",
                      "inlineContent": [
                        {
                          "type": "text",
                          "text": "Always specify a valid ride phase and completion status."
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "text": " Maps uses the "
                    },
                    {
                      "type": "reference",
                      "isActive": true,
                      "identifier": "doc://com.apple.documentation/documentation/sirikit/inridestatus/1648490-phase"
                    },
                    {
                      "type": "text",
                      "text": " property of the "
                    },
                    {
                      "type": "reference",
                      "isActive": true,
                      "identifier": "doc://com.apple.documentation/documentation/sirikit/inridestatus"
                    },
                    {
                      "type": "text",
                      "text": " object to communicate the ride status to the user. Specifically, when the phase changes, Maps updates that information in its interface. Never set the ride phase to "
                    },
                    {
                      "type": "reference",
                      "isActive": true,
                      "identifier": "doc://com.apple.documentation/documentation/sirikit/inridephase/inridephaseunknown"
                    },
                    {
                      "type": "text",
                      "text": "."
                    }
                  ]
                }
              ]
            },
            {
              "content": [
                {
                  "type": "paragraph",
                  "inlineContent": [
                    {
                      "type": "strong",
                      "inlineContent": [
                        {
                          "type": "text",
                          "text": "Always provide a completion status for a completed ride."
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "text": " When setting the ride phase to "
                    },
                    {
                      "type": "reference",
                      "isActive": true,
                      "identifier": "doc://com.apple.documentation/documentation/sirikit/inridephase/inridephasecompleted"
                    },
                    {
                      "type": "text",
                      "text": ", assign an appropriate value to the "
                    },
                    {
                      "type": "reference",
                      "isActive": true,
                      "identifier": "doc://com.apple.documentation/documentation/sirikit/inridestatus/2127692-completionstatus"
                    },
                    {
                      "type": "text",
                      "text": " property of the "
                    },
                    {
                      "type": "reference",
                      "isActive": true,
                      "identifier": "doc://com.apple.documentation/documentation/sirikit/inridestatus"
                    },
                    {
                      "type": "text",
                      "text": " object to indicate how to resolve the ride. "
                    }
                  ]
                }
              ]
            },
            {
              "content": [
                {
                  "type": "paragraph",
                  "inlineContent": [
                    {
                      "type": "strong",
                      "inlineContent": [
                        {
                          "type": "text",
                          "text": "Always use the same ride identifier that you used during booking."
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "text": " Updates must include the same value in the "
                    },
                    {
                      "type": "reference",
                      "isActive": true,
                      "identifier": "doc://com.apple.documentation/documentation/sirikit/inridestatus/1648484-rideidentifier"
                    },
                    {
                      "type": "text",
                      "text": " property of the "
                    },
                    {
                      "type": "reference",
                      "isActive": true,
                      "identifier": "doc://com.apple.documentation/documentation/sirikit/inridestatus"
                    },
                    {
                      "type": "text",
                      "text": " object that you used when booking the ride. If the identifiers do not match, SiriKit ignores any further updates."
                    }
                  ]
                }
              ]
            },
            {
              "content": [
                {
                  "type": "paragraph",
                  "inlineContent": [
                    {
                      "type": "strong",
                      "inlineContent": [
                        {
                          "type": "text",
                          "text": "Provide a valid ride option object."
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "text": " The value in the "
                    },
                    {
                      "type": "reference",
                      "isActive": true,
                      "identifier": "doc://com.apple.documentation/documentation/sirikit/inridestatus/1648482-rideoption"
                    },
                    {
                      "type": "text",
                      "text": " property of the "
                    },
                    {
                      "type": "reference",
                      "isActive": true,
                      "identifier": "doc://com.apple.documentation/documentation/sirikit/inridestatus"
                    },
                    {
                      "type": "text",
                      "text": " object need not match the one you specified during booking, but the ride option name and estimated pickup date must be valid."
                    }
                  ]
                }
              ]
            },
            {
              "content": [
                {
                  "type": "paragraph",
                  "inlineContent": [
                    {
                      "type": "strong",
                      "inlineContent": [
                        {
                          "type": "text",
                          "text": "Provide a map annotation image for your vehicle."
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "text": " Maps uses the map annotation image from your status object to show the position of your vehicle on the map surface. Specify this image using the "
                    },
                    {
                      "type": "reference",
                      "isActive": true,
                      "identifier": "doc://com.apple.documentation/documentation/sirikit/inridevehicle/1649590-mapannotationimage"
                    },
                    {
                      "type": "text",
                      "text": " property of the "
                    },
                    {
                      "type": "reference",
                      "isActive": true,
                      "identifier": "doc://com.apple.documentation/documentation/sirikit/inridevehicle"
                    },
                    {
                      "type": "text",
                      "text": " object you assign to your status object."
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": []
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "Upon the completion of a ride, call your handler object’s "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/sirikit/ingetridestatusintenthandling/1649844-stopsendingupdatesforgetridestat"
            },
            {
              "type": "text",
              "text": " method when you want to stop the delivery of live updates. You implement this method and use it to cancel the recurring task that you use to generates updates. You can stop updates at any time, but typically you do so after the ride is complete and have settled any charges."
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/sirikit/ingetridestatusintentresponseobserver/providing_live_status_updates#2865109"
            },
            {
              "type": "text",
              "text": " shows an implementation of the "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/sirikit/ingetridestatusintenthandling/1649844-stopsendingupdatesforgetridestat"
            },
            {
              "type": "text",
              "text": " method that invalidates the timer used to deliver live updates and removes references to the observer object. Because both your code and SiriKit can call this method, it is an ideal place to perform all cleanup associated with live updates."
            }
          ]
        },
        {
          "type": "codeListing",
          "code": [
            "public func stopSendingUpdates(forGetRideStatus intent: INGetRideStatusIntent) {",
            "   self.observer = nil",
            "   self.timer?.invalidate()",
            "\t// Clean up any other state information.",
            "}"
          ],
          "syntax": "swift",
          "metadata": {
            "anchor": "2865109",
            "title": "Listing 2",
            "abstract": [
              {
                "type": "text",
                "text": "Stopping live updates"
              }
            ]
          }
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "The code you use to generate live updates must be fault-tolerant and able to handle errors well. Because getting live updates involves communicating with your server, you should handle cases where your server does not respond or returns an error. For example, you might return a cached response if your server does not respond in a timely manner. If you deliver an invalid response object to the observer, Maps calls the "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/sirikit/ingetridestatusintenthandling/1649844-stopsendingupdatesforgetridestat"
            },
            {
              "type": "text",
              "text": " of your handler object and notifies the user that a problem occurred."
            }
          ]
        }
      ]
    }
  ],
  "legalNotices": {
    "copyright": "Copyright &copy; 2021 Apple Inc. All rights reserved.",
    "termsOfUse": "https://www.apple.com/legal/internet-services/terms/site.html",
    "privacyPolicy": "https://www.apple.com/privacy/privacy-policy"
  }
}