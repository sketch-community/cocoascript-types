{
  "abstract": [
    {
      "type": "text",
      "text": "A Core Animation layer that Metal can render into, typically to be displayed onscreen."
    }
  ],
  "documentVersion": 0,
  "hierarchy": {
    "paths": [
      [
        "doc://com.apple.documentation/documentation/technologies",
        "doc://com.apple.documentation/documentation/quartzcore"
      ],
      [
        "doc://com.apple.documentation/documentation/technologies",
        "doc://com.apple.documentation/documentation/metal",
        "doc://com.apple.documentation/documentation/metal/drawable_objects"
      ]
    ]
  },
  "identifier": {
    "url": "doc://com.apple.documentation/documentation/quartzcore/cametallayer",
    "interfaceLanguage": "occ"
  },
  "legacy_identifier": 1478177,
  "kind": "symbol",
  "metadata": {
    "title": "CAMetalLayer",
    "role": "symbol",
    "roleHeading": "Class",
    "modules": [
      {
        "name": "Core Animation"
      }
    ],
    "platforms": [
      {
        "name": "iOS",
        "introducedAt": "8.0",
        "current": "14.3"
      },
      {
        "name": "macOS",
        "introducedAt": "10.11",
        "current": "11.1"
      },
      {
        "name": "Mac Catalyst",
        "introducedAt": "13.0",
        "current": "14.3"
      },
      {
        "name": "tvOS",
        "introducedAt": "9.0",
        "current": "14.3"
      }
    ],
    "externalID": "c:objc(cs)CAMetalLayer",
    "symbolKind": "cl"
  },
  "schemaVersion": {
    "major": 1,
    "minor": 0,
    "patch": 0
  },
  "sections": [],
  "variants": [
    {
      "traits": [
        {
          "interfaceLanguage": "occ"
        }
      ],
      "paths": [
        "documentation/quartzcore/cametallayer"
      ]
    },
    {
      "traits": [
        {
          "interfaceLanguage": "swift"
        }
      ],
      "paths": [
        "documentation/quartzcore/cametallayer"
      ]
    }
  ],
  "references": {
    "doc://com.apple.documentation/documentation/quartzcore": {
      "title": "Core Animation",
      "identifier": "doc://com.apple.documentation/documentation/quartzcore",
      "url": "/documentation/quartzcore",
      "type": "topic",
      "kind": "symbol",
      "role": "collection"
    },
    "doc://com.apple.documentation/documentation/metal": {
      "title": "Metal",
      "identifier": "doc://com.apple.documentation/documentation/metal",
      "url": "/documentation/metal",
      "type": "topic",
      "kind": "symbol",
      "role": "collection"
    },
    "doc://com.apple.documentation/documentation/metal/drawable_objects": {
      "title": "Drawable Objects",
      "identifier": "doc://com.apple.documentation/documentation/metal/drawable_objects",
      "url": "/documentation/metal/drawable_objects",
      "type": "topic",
      "kind": "article",
      "role": "collectionGroup"
    },
    "doc://com.apple.documentation/documentation/quartzcore/cametallayer": {
      "title": "CAMetalLayer",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/quartzcore/cametallayer",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/quartzcore/cametallayer",
      "abstract": [
        {
          "type": "text",
          "text": "A Core Animation layer that Metal can render into, typically to be displayed onscreen."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/quartzcore/cametaldrawable": {
      "title": "CAMetalDrawable",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/quartzcore/cametaldrawable",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/quartzcore/cametaldrawable",
      "abstract": [
        {
          "type": "text",
          "text": "A Metal drawable associated with a Core Animation layer."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/quartzcore/cametallayer/1478172-nextdrawable": {
      "title": "nextDrawable",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/quartzcore/cametallayer/1478172-nextdrawable",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/quartzcore/cametallayer/1478172-nextdrawable",
      "abstract": [
        {
          "type": "text",
          "text": "Waits until a Metal drawable is available, and then returns it."
        }
      ],
      "fragments": [
        {
          "kind": "text",
          "text": "- "
        },
        {
          "kind": "identifier",
          "text": "nextDrawable"
        }
      ]
    },
    "doc://com.apple.documentation/documentation/quartzcore/cametallayer#3385508": {
      "title": "Listing 3",
      "type": "section",
      "identifier": "doc://com.apple.documentation/documentation/quartzcore/cametallayer#3385508",
      "kind": "article",
      "role": "codeListing",
      "url": "/documentation/quartzcore/cametallayer#3385508"
    },
    "doc://com.apple.documentation/documentation/metal/mtlcommandbuffer/1443029-presentdrawable": {
      "title": "presentDrawable:",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/metal/mtlcommandbuffer/1443029-presentdrawable",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/metal/mtlcommandbuffer/1443029-presentdrawable",
      "fragments": [
        {
          "kind": "text",
          "text": "- "
        },
        {
          "kind": "identifier",
          "text": "presentDrawable:"
        }
      ]
    },
    "doc://com.apple.documentation/documentation/quartzcore/cametallayer#3385894": {
      "title": "Listing 4",
      "type": "section",
      "identifier": "doc://com.apple.documentation/documentation/quartzcore/cametallayer#3385894",
      "kind": "article",
      "role": "codeListing",
      "url": "/documentation/quartzcore/cametallayer#3385894"
    },
    "doc://com.apple.documentation/documentation/quartzcore/cametallayer#3172023": {
      "title": "Listing 5",
      "type": "section",
      "identifier": "doc://com.apple.documentation/documentation/quartzcore/cametallayer#3172023",
      "kind": "article",
      "role": "codeListing",
      "url": "/documentation/quartzcore/cametallayer#3172023"
    },
    "doc://com.apple.documentation/documentation/metal/mtldrawable/2806860-drawableid": {
      "title": "drawableID",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/metal/mtldrawable/2806860-drawableid",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/metal/mtldrawable/2806860-drawableid"
    },
    "doc://com.apple.documentation/documentation/metal/mtldrawable/2806855-presentedtime": {
      "title": "presentedTime",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/metal/mtldrawable/2806855-presentedtime",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/metal/mtldrawable/2806855-presentedtime"
    },
    "doc://com.apple.documentation/documentation/metalkit/mtkview": {
      "title": "MTKView",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/metalkit/mtkview",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/metalkit/mtkview"
    },
    "devLink-1734986": {
      "identifier": "devLink-1734986",
      "type": "link",
      "title": "UIView",
      "url": "https://developer.apple.com/library/archive/releasenotes/iPhone/RN-iPhoneSDK/index.html#//apple_ref/doc/uid/TP40007428-CH1-SW18"
    },
    "doc://com.apple.documentation/documentation/uikit/uiview/1622626-layerclass": {
      "title": "layerClass",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/uikit/uiview/1622626-layerclass",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/uikit/uiview/1622626-layerclass"
    },
    "doc://com.apple.documentation/documentation/quartzcore/cametallayer#3385506": {
      "title": "Listing 1",
      "type": "section",
      "identifier": "doc://com.apple.documentation/documentation/quartzcore/cametallayer#3385506",
      "kind": "article",
      "role": "codeListing",
      "url": "/documentation/quartzcore/cametallayer#3385506"
    },
    "doc://com.apple.documentation/documentation/appkit/nsview": {
      "title": "NSView",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/appkit/nsview",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/appkit/nsview"
    },
    "doc://com.apple.documentation/documentation/quartzcore/cametallayer#3385509": {
      "title": "Listing 2",
      "type": "section",
      "identifier": "doc://com.apple.documentation/documentation/quartzcore/cametallayer#3385509",
      "kind": "article",
      "role": "codeListing",
      "url": "/documentation/quartzcore/cametallayer#3385509"
    },
    "doc://com.apple.documentation/documentation/quartzcore/calayer": {
      "title": "CALayer",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/quartzcore/calayer",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/quartzcore/calayer"
    },
    "doc://com.apple.documentation/documentation/quartzcore/cametallayer/1478163-device": {
      "title": "device",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/quartzcore/cametallayer/1478163-device",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/quartzcore/cametallayer/1478163-device",
      "abstract": [
        {
          "type": "text",
          "text": "The Metal device responsible for the layer’s drawable resources."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/quartzcore/cametallayer/3175021-preferreddevice": {
      "title": "preferredDevice",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/quartzcore/cametallayer/3175021-preferreddevice",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/quartzcore/cametallayer/3175021-preferreddevice",
      "abstract": [
        {
          "type": "text",
          "text": "The device object that the system recommends using for this layer."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/quartzcore/cametallayer/1478155-pixelformat": {
      "title": "pixelFormat",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/quartzcore/cametallayer/1478155-pixelformat",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/quartzcore/cametallayer/1478155-pixelformat",
      "abstract": [
        {
          "type": "text",
          "text": "The pixel format of the layer’s textures."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/quartzcore/cametallayer/1478170-colorspace": {
      "title": "colorspace",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/quartzcore/cametallayer/1478170-colorspace",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/quartzcore/cametallayer/1478170-colorspace",
      "abstract": [
        {
          "type": "text",
          "text": "The color space of the rendered content."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/quartzcore/cametallayer/1478168-framebufferonly": {
      "title": "framebufferOnly",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/quartzcore/cametallayer/1478168-framebufferonly",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/quartzcore/cametallayer/1478168-framebufferonly",
      "abstract": [
        {
          "type": "text",
          "text": "A Boolean value that determines whether the layer’s textures are used only for rendering."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/quartzcore/cametallayer/1478174-drawablesize": {
      "title": "drawableSize",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/quartzcore/cametallayer/1478174-drawablesize",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/quartzcore/cametallayer/1478174-drawablesize",
      "abstract": [
        {
          "type": "text",
          "text": "The size, in pixels, of textures for rendering layer content."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/quartzcore/cametallayer/1478157-presentswithtransaction": {
      "title": "presentsWithTransaction",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/quartzcore/cametallayer/1478157-presentswithtransaction",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/quartzcore/cametallayer/1478157-presentswithtransaction",
      "abstract": [
        {
          "type": "text",
          "text": "A Boolean value that determines whether the layer presents its content using a Core Animation transaction."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/quartzcore/cametallayer/2887087-displaysyncenabled": {
      "title": "displaySyncEnabled",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/quartzcore/cametallayer/2887087-displaysyncenabled",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/quartzcore/cametallayer/2887087-displaysyncenabled",
      "abstract": [
        {
          "type": "text",
          "text": "A Boolean value that determines whether the layer synchronizes its updates to the display’s refresh rate."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/quartzcore/cametallayer/1478161-wantsextendeddynamicrangecontent": {
      "title": "wantsExtendedDynamicRangeContent",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/quartzcore/cametallayer/1478161-wantsextendeddynamicrangecontent",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/quartzcore/cametallayer/1478161-wantsextendeddynamicrangecontent",
      "abstract": [
        {
          "type": "text",
          "text": "Enables extended dynamic range values onscreen."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/quartzcore/cametallayer/3182052-edrmetadata": {
      "title": "EDRMetadata",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/quartzcore/cametallayer/3182052-edrmetadata",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/quartzcore/cametallayer/3182052-edrmetadata",
      "abstract": [
        {
          "type": "text",
          "text": "Metadata describing the tone mapping to apply to the extended dynamic range (EDR) values in the layer."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/quartzcore/cametallayer/2938720-maximumdrawablecount": {
      "title": "maximumDrawableCount",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/quartzcore/cametallayer/2938720-maximumdrawablecount",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/quartzcore/cametallayer/2938720-maximumdrawablecount",
      "abstract": [
        {
          "type": "text",
          "text": "The number of Metal drawables in the resource pool managed by Core Animation."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/quartzcore/cametallayer/2887086-allowsnextdrawabletimeout": {
      "title": "allowsNextDrawableTimeout",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/quartzcore/cametallayer/2887086-allowsnextdrawabletimeout",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/quartzcore/cametallayer/2887086-allowsnextdrawabletimeout",
      "abstract": [
        {
          "type": "text",
          "text": "A Boolean value that determines whether requests for a new buffer expire if the system can’t satisfy them."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/quartzcore/caeagllayer": {
      "title": "CAEAGLLayer",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/quartzcore/caeagllayer",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/quartzcore/caeagllayer",
      "abstract": [
        {
          "type": "text",
          "text": "A layer that supports drawing OpenGL content in iOS and tvOS applications.  "
        }
      ],
      "deprecated": true
    },
    "doc://com.apple.documentation/documentation/quartzcore/caedrmetadata": {
      "title": "CAEDRMetadata",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/quartzcore/caedrmetadata",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/quartzcore/caedrmetadata",
      "abstract": [
        {
          "type": "text",
          "text": "Metadata describing how extended dynamic range (EDR) values should be tone mapped."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/quartzcore/caopengllayer": {
      "title": "CAOpenGLLayer",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/quartzcore/caopengllayer",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/quartzcore/caopengllayer",
      "abstract": [
        {
          "type": "text",
          "text": "A layer that provides a layer suitable for rendering OpenGL content."
        }
      ],
      "deprecated": true
    },
    "doc://com.apple.documentation/documentation/quartzcore/carenderer": {
      "title": "CARenderer",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/quartzcore/carenderer",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/quartzcore/carenderer",
      "abstract": [
        {
          "type": "text",
          "text": "A layer that allows an application to render a layer tree into a Core OpenGL context. "
        }
      ]
    },
    "doc://com.apple.documentation/documentation/technologies": {
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/technologies",
      "url": "/documentation/technologies",
      "kind": "technologies",
      "title": "Technologies"
    }
  },
  "relationshipsSections": [
    {
      "kind": "relationships",
      "title": "Inherits From",
      "type": "inheritsFrom",
      "identifiers": [
        "doc://com.apple.documentation/documentation/quartzcore/calayer"
      ]
    }
  ],
  "topicSections": [
    {
      "kind": "taskGroup",
      "title": "Configuring the Metal Device",
      "identifiers": [
        "doc://com.apple.documentation/documentation/quartzcore/cametallayer/1478163-device",
        "doc://com.apple.documentation/documentation/quartzcore/cametallayer/3175021-preferreddevice"
      ]
    },
    {
      "kind": "taskGroup",
      "title": "Configuring the Layer's Drawable Objects",
      "identifiers": [
        "doc://com.apple.documentation/documentation/quartzcore/cametallayer/1478155-pixelformat",
        "doc://com.apple.documentation/documentation/quartzcore/cametallayer/1478170-colorspace",
        "doc://com.apple.documentation/documentation/quartzcore/cametallayer/1478168-framebufferonly",
        "doc://com.apple.documentation/documentation/quartzcore/cametallayer/1478174-drawablesize"
      ]
    },
    {
      "kind": "taskGroup",
      "title": "Configuring Presentation Behavior",
      "identifiers": [
        "doc://com.apple.documentation/documentation/quartzcore/cametallayer/1478157-presentswithtransaction",
        "doc://com.apple.documentation/documentation/quartzcore/cametallayer/2887087-displaysyncenabled"
      ]
    },
    {
      "kind": "taskGroup",
      "title": "Configuring Extended Dynamic Range Behavior",
      "identifiers": [
        "doc://com.apple.documentation/documentation/quartzcore/cametallayer/1478161-wantsextendeddynamicrangecontent",
        "doc://com.apple.documentation/documentation/quartzcore/cametallayer/3182052-edrmetadata"
      ]
    },
    {
      "kind": "taskGroup",
      "title": "Obtaining a Metal Drawable",
      "identifiers": [
        "doc://com.apple.documentation/documentation/quartzcore/cametallayer/1478172-nextdrawable",
        "doc://com.apple.documentation/documentation/quartzcore/cametallayer/2938720-maximumdrawablecount",
        "doc://com.apple.documentation/documentation/quartzcore/cametallayer/2887086-allowsnextdrawabletimeout"
      ]
    }
  ],
  "seeAlsoSections": [
    {
      "identifiers": [
        "doc://com.apple.documentation/documentation/quartzcore/cametaldrawable",
        "doc://com.apple.documentation/documentation/quartzcore/caeagllayer",
        "doc://com.apple.documentation/documentation/quartzcore/caedrmetadata",
        "doc://com.apple.documentation/documentation/quartzcore/caopengllayer",
        "doc://com.apple.documentation/documentation/quartzcore/carenderer"
      ],
      "title": "Metal and OpenGL",
      "generated": true
    }
  ],
  "primaryContentSections": [
    {
      "kind": "declarations",
      "declarations": [
        {
          "languages": [
            "occ"
          ],
          "tokens": [
            {
              "kind": "keyword",
              "text": "@interface"
            },
            {
              "kind": "text",
              "text": " "
            },
            {
              "kind": "identifier",
              "text": "CAMetalLayer"
            },
            {
              "kind": "text",
              "text": " : "
            },
            {
              "kind": "typeIdentifier",
              "preciseIdentifier": "c:objc(cs)CALayer",
              "identifier": "doc://com.apple.documentation/documentation/quartzcore/calayer",
              "text": "CALayer"
            }
          ],
          "platforms": [
            "iOS",
            "macOS",
            "Mac Catalyst",
            "tvOS"
          ]
        }
      ]
    },
    {
      "kind": "content",
      "content": [
        {
          "anchor": "overview",
          "level": 2,
          "text": "Overview",
          "type": "heading"
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "Use a "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/quartzcore/cametallayer"
            },
            {
              "type": "text",
              "text": " when you want to use Metal to render a layer’s contents; for example, to render into a view. Consider using "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/metalkit/mtkview"
            },
            {
              "type": "text",
              "text": " instead, because this class automatically wraps a "
            },
            {
              "type": "reference",
              "isActive": false,
              "identifier": "doc://com.apple.documentation/documentation/quartzcore/cametallayer"
            },
            {
              "type": "text",
              "text": " object and provides a higher-level abstraction."
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "If you’re using UIKit, to create a view that uses a "
            },
            {
              "type": "reference",
              "isActive": false,
              "identifier": "doc://com.apple.documentation/documentation/quartzcore/cametallayer"
            },
            {
              "type": "text",
              "text": ", create a subclass of "
            },
            {
              "type": "link",
              "title": "UIView",
              "destination": "https://developer.apple.com/library/archive/releasenotes/iPhone/RN-iPhoneSDK/index.html#//apple_ref/doc/uid/TP40007428-CH1-SW18"
            },
            {
              "type": "text",
              "text": " and override its "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/uikit/uiview/1622626-layerclass"
            },
            {
              "type": "text",
              "text": " class method to return a "
            },
            {
              "type": "reference",
              "isActive": false,
              "identifier": "doc://com.apple.documentation/documentation/quartzcore/cametallayer"
            },
            {
              "type": "text",
              "text": ":"
            }
          ]
        },
        {
          "type": "codeListing",
          "code": [
            "+ (Class) layerClass",
            "{",
            "    return [CAMetalLayer class];",
            "}"
          ],
          "syntax": "occ",
          "metadata": {
            "anchor": "3385506",
            "title": "Listing 1"
          }
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "If you’re using AppKit, configure an "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/appkit/nsview"
            },
            {
              "type": "text",
              "text": " object to use a backing layer and assign a "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/quartzcore/cametallayer"
            },
            {
              "type": "text",
              "text": " object to the view:"
            }
          ]
        },
        {
          "type": "codeListing",
          "code": [
            "myView.wantsLayer = YES;",
            "myView.layer = [CAMetalLayer layer];"
          ],
          "syntax": "occ",
          "metadata": {
            "anchor": "3385509",
            "title": "Listing 2"
          }
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "Adjust the layer’s properties to configure its underlying pixel format and other display behaviors."
            }
          ]
        },
        {
          "level": 3,
          "type": "heading",
          "text": "Rendering the Layer's Contents",
          "anchor": "3385505"
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "A "
            },
            {
              "type": "reference",
              "isActive": false,
              "identifier": "doc://com.apple.documentation/documentation/quartzcore/cametallayer"
            },
            {
              "type": "text",
              "text": " creates a pool of Metal drawable objects ("
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/quartzcore/cametaldrawable"
            },
            {
              "type": "text",
              "text": "). At any given time, one of these drawable objects contains the contents of the layer. To change the layer’s contents, ask the layer for a drawable object, render into it, and then update the layer’s contents to point to the new drawable."
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "Call the layer’s "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/quartzcore/cametallayer/1478172-nextdrawable"
            },
            {
              "type": "text",
              "text": " method to obtain a drawable object. Get the drawable object’s texture and create a render pass that renders to that texture, as shown in the code below:"
            }
          ]
        },
        {
          "type": "codeListing",
          "code": [
            "CAMetalLayer *metalLayer = (CAMetalLayer*)self.layer;",
            "id<CAMetalDrawable> *drawable = [metalLayer nextDrawable];",
            "",
            "MTLRenderPassDescriptor *renderPassDescriptor",
            "                               = [MTLRenderPassDescriptor renderPassDescriptor];",
            "",
            "renderPassDescriptor.colorAttachments[0].texture = drawable.texture;",
            "renderPassDescriptor.colorAttachments[0].loadAction = MTLLoadActionClear;",
            "renderPassDescriptor.colorAttachments[0].clearColor = MTLClearColorMake(0.0,0.0,0.0,1.0);",
            "..."
          ],
          "syntax": "occ",
          "metadata": {
            "anchor": "3385508",
            "title": "Listing 3"
          }
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "To change the layer’s contents to the new drawable, call the "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/metal/mtlcommandbuffer/1443029-presentdrawable"
            },
            {
              "type": "text",
              "text": " method (or one of its variants) on the command buffer containing the encoded render pass, passing in the drawable object to present."
            }
          ]
        },
        {
          "type": "codeListing",
          "code": [
            "[commandBuffer presentDrawable:drawable];"
          ],
          "syntax": "occ",
          "metadata": {
            "anchor": "3385894",
            "title": "Listing 4"
          }
        },
        {
          "type": "paragraph",
          "inlineContent": []
        },
        {
          "level": 3,
          "type": "heading",
          "text": "Keeping References to Drawables",
          "anchor": "3385893"
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "The layer reuses a drawable only if it isn’t onscreen and there are no strong references to it. Further, if a drawable isn’t available when you call "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/quartzcore/cametallayer/1478172-nextdrawable"
            },
            {
              "type": "text",
              "text": ", the system waits for one to become available. To avoid stalls in your app, request a new drawable only when you need it, and release any references to it as quickly as possible after you’re done with it."
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "For example, before retrieving a new drawable, you might perform other work on the CPU or submit commands to the GPU that don’t require the drawable. Then, obtain the drawable and encode a command buffer to render into it, as described above. After you commit this command buffer, release all strong references to the drawable. If you don’t release drawables correctly, the layer runs out of drawables, and future calls to "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/quartzcore/cametallayer/1478172-nextdrawable"
            },
            {
              "type": "text",
              "text": " return "
            },
            {
              "type": "codeVoice",
              "code": "nil"
            },
            {
              "type": "text",
              "text": "."
            }
          ]
        },
        {
          "level": 3,
          "type": "heading",
          "text": "Releasing the Drawable",
          "anchor": "3172024"
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "Don’t release the drawable explicitly; instead, embed your render loop within an autorelease pool block:"
            }
          ]
        },
        {
          "type": "codeListing",
          "code": [
            "- (void)drawInMTKView:(MTKView *)view {",
            "    @autoreleasepool {",
            "        [self render:view];",
            "    }",
            "}"
          ],
          "syntax": "occ",
          "metadata": {
            "anchor": "3172023",
            "title": "Listing 5"
          }
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "This block releases drawables promptly and avoids possible deadlock situations with multiple drawables. Release drawables as soon as possible after committing your onscreen render pass."
            }
          ]
        },
        {
          "type": "aside",
          "content": [
            {
              "type": "paragraph",
              "inlineContent": [
                {
                  "type": "text",
                  "text": "As of iOS 10 and tvOS 10, you can safely retain a drawable to query its properties, such as "
                },
                {
                  "type": "reference",
                  "isActive": true,
                  "identifier": "doc://com.apple.documentation/documentation/metal/mtldrawable/2806860-drawableid"
                },
                {
                  "type": "text",
                  "text": " and "
                },
                {
                  "type": "reference",
                  "isActive": true,
                  "identifier": "doc://com.apple.documentation/documentation/metal/mtldrawable/2806855-presentedtime"
                },
                {
                  "type": "text",
                  "text": ", after the system has presented it. If you don’t need to query these properties, release the drawable when you no longer need it."
                }
              ]
            }
          ],
          "style": "note",
          "name": "Note"
        },
        {
          "type": "paragraph",
          "inlineContent": []
        }
      ]
    }
  ],
  "legalNotices": {
    "copyright": "Copyright &copy; 2020 Apple Inc. All rights reserved.",
    "termsOfUse": "https://www.apple.com/legal/internet-services/terms/site.html",
    "privacyPolicy": "https://www.apple.com/privacy/privacy-policy"
  }
}