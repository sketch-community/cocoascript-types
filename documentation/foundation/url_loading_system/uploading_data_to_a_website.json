{
  "abstract": [
    {
      "type": "text",
      "text": "Post data from your app to servers."
    }
  ],
  "documentVersion": 0,
  "hierarchy": {
    "paths": [
      [
        "doc://com.apple.documentation/documentation/technologies",
        "doc://com.apple.documentation/documentation/foundation",
        "doc://com.apple.documentation/documentation/foundation/url_loading_system"
      ]
    ]
  },
  "identifier": {
    "url": "doc://com.apple.documentation/documentation/foundation/url_loading_system/uploading_data_to_a_website",
    "interfaceLanguage": "occ"
  },
  "legacy_identifier": 2919363,
  "kind": "article",
  "metadata": {
    "title": "Uploading Data to a Website",
    "role": "article",
    "roleHeading": "Article",
    "modules": [
      {
        "name": "Foundation"
      }
    ]
  },
  "schemaVersion": {
    "major": 0,
    "minor": 1,
    "patch": 0
  },
  "sections": [],
  "variants": [
    {
      "traits": [
        {
          "interfaceLanguage": "occ"
        }
      ],
      "paths": [
        "documentation/foundation/url_loading_system/uploading_data_to_a_website"
      ]
    },
    {
      "traits": [
        {
          "interfaceLanguage": "swift"
        }
      ],
      "paths": [
        "documentation/foundation/url_loading_system/uploading_data_to_a_website"
      ]
    }
  ],
  "references": {
    "doc://com.apple.documentation/documentation/foundation": {
      "title": "Foundation",
      "identifier": "doc://com.apple.documentation/documentation/foundation",
      "url": "/documentation/foundation",
      "type": "topic",
      "kind": "symbol",
      "role": "collection"
    },
    "doc://com.apple.documentation/documentation/foundation/url_loading_system": {
      "title": "URL Loading System",
      "identifier": "doc://com.apple.documentation/documentation/foundation/url_loading_system",
      "url": "/documentation/foundation/url_loading_system",
      "type": "topic",
      "kind": "article",
      "role": "collectionGroup"
    },
    "doc://com.apple.documentation/documentation/foundation/jsonencoder": {
      "title": "JSONEncoder",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/foundation/jsonencoder",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/foundation/jsonencoder"
    },
    "doc://com.apple.documentation/documentation/swift/encodable": {
      "title": "Encodable",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/swift/encodable",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/swift/encodable"
    },
    "doc://com.apple.documentation/documentation/swift/codable": {
      "title": "Codable",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/swift/codable",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/swift/codable"
    },
    "doc://com.apple.documentation/documentation/foundation/url_loading_system/uploading_data_to_a_website#2923850": {
      "title": "Listing 1",
      "type": "section",
      "identifier": "doc://com.apple.documentation/documentation/foundation/url_loading_system/uploading_data_to_a_website#2923850",
      "kind": "article",
      "role": "codeListing",
      "url": "/documentation/foundation/url_loading_system/uploading_data_to_a_website#2923850",
      "abstract": [
        {
          "type": "text",
          "text": "Preparing JSON data for upload"
        }
      ]
    },
    "doc://com.apple.documentation/documentation/foundation/urlrequest": {
      "title": "URLRequest",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/foundation/urlrequest",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/foundation/urlrequest"
    },
    "doc://com.apple.documentation/documentation/foundation/urlrequest/2011415-httpmethod": {
      "title": "httpMethod",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/foundation/urlrequest/2011415-httpmethod",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/foundation/urlrequest/2011415-httpmethod"
    },
    "doc://com.apple.documentation/documentation/foundation/urlrequest/2011447-setvalue": {
      "title": "setValue(_:forHTTPHeaderField:)",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/foundation/urlrequest/2011447-setvalue",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/foundation/urlrequest/2011447-setvalue"
    },
    "doc://com.apple.documentation/documentation/foundation/url_loading_system/uploading_data_to_a_website#2923851": {
      "title": "Listing 2",
      "type": "section",
      "identifier": "doc://com.apple.documentation/documentation/foundation/url_loading_system/uploading_data_to_a_website#2923851",
      "kind": "article",
      "role": "codeListing",
      "url": "/documentation/foundation/url_loading_system/uploading_data_to_a_website#2923851",
      "abstract": [
        {
          "type": "text",
          "text": "Configuring a URL request"
        }
      ]
    },
    "doc://com.apple.documentation/documentation/foundation/nsurlsession/1411518-uploadtaskwithrequest": {
      "title": "uploadTaskWithRequest:fromData:completionHandler:",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/foundation/nsurlsession/1411518-uploadtaskwithrequest",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/foundation/nsurlsession/1411518-uploadtaskwithrequest",
      "fragments": [
        {
          "kind": "text",
          "text": "- "
        },
        {
          "kind": "identifier",
          "text": "uploadTaskWithRequest:fromData:completionHandler:"
        }
      ]
    },
    "doc://com.apple.documentation/documentation/foundation/nsurlsession": {
      "title": "NSURLSession",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/foundation/nsurlsession",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/foundation/nsurlsession"
    },
    "doc://com.apple.documentation/documentation/foundation/nsurlsessiontask": {
      "title": "NSURLSessionTask",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/foundation/nsurlsessiontask",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/foundation/nsurlsessiontask"
    },
    "doc://com.apple.documentation/documentation/foundation/nsurlsessiontask/1411121-resume": {
      "title": "resume",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/foundation/nsurlsessiontask/1411121-resume",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/foundation/nsurlsessiontask/1411121-resume",
      "fragments": [
        {
          "kind": "text",
          "text": "- "
        },
        {
          "kind": "identifier",
          "text": "resume"
        }
      ]
    },
    "doc://com.apple.documentation/documentation/foundation/url_loading_system/uploading_data_to_a_website#2923852": {
      "title": "Listing 3",
      "type": "section",
      "identifier": "doc://com.apple.documentation/documentation/foundation/url_loading_system/uploading_data_to_a_website#2923852",
      "kind": "article",
      "role": "codeListing",
      "url": "/documentation/foundation/url_loading_system/uploading_data_to_a_website#2923852",
      "abstract": [
        {
          "type": "text",
          "text": "Starting an upload task"
        }
      ]
    },
    "doc://com.apple.documentation/documentation/foundation/nsurlsession/1409763-uploadtaskwithrequest": {
      "title": "uploadTaskWithRequest:fromData:",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/foundation/nsurlsession/1409763-uploadtaskwithrequest",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/foundation/nsurlsession/1409763-uploadtaskwithrequest",
      "fragments": [
        {
          "kind": "text",
          "text": "- "
        },
        {
          "kind": "identifier",
          "text": "uploadTaskWithRequest:fromData:"
        }
      ]
    },
    "doc://com.apple.documentation/documentation/foundation/nsurlsessiondelegate": {
      "title": "NSURLSessionDelegate",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/foundation/nsurlsessiondelegate",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/foundation/nsurlsessiondelegate"
    },
    "doc://com.apple.documentation/documentation/foundation/nsurlsessiontaskdelegate": {
      "title": "NSURLSessionTaskDelegate",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/foundation/nsurlsessiontaskdelegate",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/foundation/nsurlsessiontaskdelegate"
    },
    "doc://com.apple.documentation/documentation/foundation/nsurlsessionuploadtask": {
      "title": "NSURLSessionUploadTask",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/foundation/nsurlsessionuploadtask",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/foundation/nsurlsessionuploadtask"
    },
    "doc://com.apple.documentation/documentation/foundation/url_loading_system/uploading_data_to_a_website": {
      "title": "Uploading Data to a Website",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/foundation/url_loading_system/uploading_data_to_a_website",
      "kind": "article",
      "role": "article",
      "url": "/documentation/foundation/url_loading_system/uploading_data_to_a_website",
      "abstract": [
        {
          "type": "text",
          "text": "Post data from your app to servers."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/foundation/url_loading_system/uploading_streams_of_data": {
      "title": "Uploading Streams of Data",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/foundation/url_loading_system/uploading_streams_of_data",
      "kind": "article",
      "role": "article",
      "url": "/documentation/foundation/url_loading_system/uploading_streams_of_data",
      "abstract": [
        {
          "type": "text",
          "text": "Send a stream of data to a server."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/technologies": {
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/technologies",
      "url": "/documentation/technologies",
      "kind": "technologies",
      "title": "Technologies"
    }
  },
  "seeAlsoSections": [
    {
      "identifiers": [
        "doc://com.apple.documentation/documentation/foundation/url_loading_system/uploading_streams_of_data"
      ],
      "title": "Uploading",
      "generated": true
    }
  ],
  "primaryContentSections": [
    {
      "kind": "content",
      "content": [
        {
          "anchor": "overview",
          "level": 2,
          "text": "Overview",
          "type": "heading"
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "Many apps work with servers that accept uploads of files like images or documents, or use web service API endpoints that accept structured data like JSON. To upload data from your app, you use a "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/foundation/nsurlsession"
            },
            {
              "type": "text",
              "text": " instance to create a "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/foundation/nsurlsessionuploadtask"
            },
            {
              "type": "text",
              "text": " instance. The upload task uses a "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/foundation/urlrequest"
            },
            {
              "type": "text",
              "text": " instance that details how the upload is to be performed."
            }
          ]
        },
        {
          "level": 3,
          "type": "heading",
          "text": "Prepare Your Data for Upload",
          "anchor": "2923847"
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "The data to upload can be the contents of a file, a stream, or data, as is the case in "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/foundation/url_loading_system/uploading_data_to_a_website#2923850"
            },
            {
              "type": "text",
              "text": ". "
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "Many web service endpoints take JSON-formatted data, which you create by using the  "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/foundation/jsonencoder"
            },
            {
              "type": "text",
              "text": " class on "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/swift/encodable"
            },
            {
              "type": "text",
              "text": " types like arrays and dictionaries. As shown in "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/foundation/url_loading_system/uploading_data_to_a_website#2923850"
            },
            {
              "type": "text",
              "text": ", you can declare a structure that conforms to "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/swift/codable"
            },
            {
              "type": "text",
              "text": ", create an instance of this type, and use "
            },
            {
              "type": "reference",
              "isActive": false,
              "identifier": "doc://com.apple.documentation/documentation/foundation/jsonencoder"
            },
            {
              "type": "text",
              "text": " to encode the instance to JSON data for upload."
            }
          ]
        },
        {
          "type": "codeListing",
          "code": [
            "struct Order: Codable {",
            "    let customerId: String",
            "    let items: [String]",
            "}",
            "",
            "// ...",
            "",
            "let order = Order(customerId: \"12345\",",
            "                  items: [\"Cheese pizza\", \"Diet soda\"])",
            "guard let uploadData = try? JSONEncoder().encode(order) else {",
            "    return",
            "}"
          ],
          "syntax": "swift",
          "metadata": {
            "anchor": "2923850",
            "title": "Listing 1",
            "abstract": [
              {
                "type": "text",
                "text": "Preparing JSON data for upload"
              }
            ]
          }
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "There are many other ways to create a data instance, such as encoding an image as JPEG or PNG data, or converting a string to data by using an encoding like UTF-8."
            }
          ]
        },
        {
          "level": 3,
          "type": "heading",
          "text": "Configure an Upload Request",
          "anchor": "2923848"
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "An upload task requires a "
            },
            {
              "type": "reference",
              "isActive": false,
              "identifier": "doc://com.apple.documentation/documentation/foundation/urlrequest"
            },
            {
              "type": "text",
              "text": " instance. As shown in "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/foundation/url_loading_system/uploading_data_to_a_website#2923851"
            },
            {
              "type": "text",
              "text": ", set the "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/foundation/urlrequest/2011415-httpmethod"
            },
            {
              "type": "text",
              "text": " property of the request to "
            },
            {
              "type": "codeVoice",
              "code": "\""
            },
            {
              "type": "codeVoice",
              "code": "POST"
            },
            {
              "type": "codeVoice",
              "code": "\""
            },
            {
              "type": "text",
              "text": " or "
            },
            {
              "type": "codeVoice",
              "code": "\"PUT\""
            },
            {
              "type": "text",
              "text": ", depending on what the server supports and expects. Use the "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/foundation/urlrequest/2011447-setvalue"
            },
            {
              "type": "text",
              "text": " method to set the values of any HTTP headers that you want to provide, except the "
            },
            {
              "type": "codeVoice",
              "code": "Content-Length"
            },
            {
              "type": "text",
              "text": " header. The session figures out content length automatically from the size of your data."
            }
          ]
        },
        {
          "type": "codeListing",
          "code": [
            "let url = URL(string: \"https://example.com/post\")!",
            "var request = URLRequest(url: url)",
            "request.httpMethod = \"POST\"",
            "request.setValue(\"application/json\", forHTTPHeaderField: \"Content-Type\")"
          ],
          "syntax": "swift",
          "metadata": {
            "anchor": "2923851",
            "title": "Listing 2",
            "abstract": [
              {
                "type": "text",
                "text": "Configuring a URL request"
              }
            ]
          }
        },
        {
          "type": "paragraph",
          "inlineContent": []
        },
        {
          "level": 3,
          "type": "heading",
          "text": "Create and Start an Upload Task",
          "anchor": "2923849"
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "To begin an upload, call "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/foundation/nsurlsession/1411518-uploadtaskwithrequest"
            },
            {
              "type": "text",
              "text": " on a "
            },
            {
              "type": "reference",
              "isActive": false,
              "identifier": "doc://com.apple.documentation/documentation/foundation/nsurlsession"
            },
            {
              "type": "text",
              "text": " instance to create an uploading "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/foundation/nsurlsessiontask"
            },
            {
              "type": "text",
              "text": " instance, passing in the request and the data instances you’ve previously set up. Because tasks start in a suspended state, you begin the network loading process by calling "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/foundation/nsurlsessiontask/1411121-resume"
            },
            {
              "type": "text",
              "text": " on the task. "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/foundation/url_loading_system/uploading_data_to_a_website#2923852"
            },
            {
              "type": "text",
              "text": " uses the shared "
            },
            {
              "type": "codeVoice",
              "code": "URLSession"
            },
            {
              "type": "text",
              "text": " instance, and receives its results in a completion handler. The handler checks for transport and server errors before using any returned data."
            }
          ]
        },
        {
          "type": "codeListing",
          "code": [
            "let task = URLSession.shared.uploadTask(with: request, from: uploadData) { data, response, error in",
            "    if let error = error {",
            "        print (\"error: \\(error)\")",
            "        return",
            "    }",
            "    guard let response = response as? HTTPURLResponse,",
            "        (200...299).contains(response.statusCode) else {",
            "        print (\"server error\")",
            "        return",
            "    }",
            "    if let mimeType = response.mimeType,",
            "        mimeType == \"application/json\",",
            "        let data = data,",
            "        let dataString = String(data: data, encoding: .utf8) {",
            "        print (\"got data: \\(dataString)\")",
            "    }",
            "}",
            "task.resume()"
          ],
          "syntax": "swift",
          "metadata": {
            "anchor": "2923852",
            "title": "Listing 3",
            "abstract": [
              {
                "type": "text",
                "text": "Starting an upload task"
              }
            ]
          }
        },
        {
          "type": "paragraph",
          "inlineContent": []
        },
        {
          "level": 3,
          "type": "heading",
          "text": "Alternatively, Upload by Setting a Delegate",
          "anchor": "2936057"
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "As an alternative to the completion handler approach, you can instead set a delegate on a session you configure, and then create the upload task with "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/foundation/nsurlsession/1409763-uploadtaskwithrequest"
            },
            {
              "type": "text",
              "text": ". In this scenario, you implement methods from the "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/foundation/nsurlsessiondelegate"
            },
            {
              "type": "text",
              "text": " and "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/foundation/nsurlsessiontaskdelegate"
            },
            {
              "type": "text",
              "text": " protocols. These methods receive the server response and any data or transport errors."
            }
          ]
        }
      ]
    }
  ],
  "legalNotices": {
    "copyright": "Copyright &copy; 2021 Apple Inc. All rights reserved.",
    "termsOfUse": "https://www.apple.com/legal/internet-services/terms/site.html",
    "privacyPolicy": "https://www.apple.com/privacy/privacy-policy"
  }
}