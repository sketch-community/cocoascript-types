{
  "abstract": [
    {
      "type": "text",
      "text": "An operation for executing queries in a database."
    }
  ],
  "documentVersion": 0,
  "hierarchy": {
    "paths": [
      [
        "doc://com.apple.documentation/documentation/technologies",
        "doc://com.apple.documentation/documentation/cloudkit"
      ]
    ]
  },
  "identifier": {
    "url": "doc://com.apple.documentation/documentation/cloudkit/ckqueryoperation",
    "interfaceLanguage": "occ"
  },
  "legacy_identifier": 1515088,
  "kind": "symbol",
  "metadata": {
    "title": "CKQueryOperation",
    "role": "symbol",
    "roleHeading": "Class",
    "modules": [
      {
        "name": "CloudKit"
      }
    ],
    "platforms": [
      {
        "name": "iOS",
        "introducedAt": "8.0",
        "current": "14.3"
      },
      {
        "name": "macOS",
        "introducedAt": "10.10",
        "current": "11.1"
      },
      {
        "name": "Mac Catalyst",
        "introducedAt": "13.0",
        "current": "14.3"
      },
      {
        "name": "tvOS",
        "introducedAt": "9.0",
        "current": "14.3"
      },
      {
        "name": "watchOS",
        "introducedAt": "3.0",
        "current": "7.2"
      }
    ],
    "externalID": "c:objc(cs)CKQueryOperation",
    "symbolKind": "cl"
  },
  "schemaVersion": {
    "major": 1,
    "minor": 0,
    "patch": 0
  },
  "sections": [],
  "variants": [
    {
      "traits": [
        {
          "interfaceLanguage": "occ"
        }
      ],
      "paths": [
        "documentation/cloudkit/ckqueryoperation"
      ]
    },
    {
      "traits": [
        {
          "interfaceLanguage": "swift"
        }
      ],
      "paths": [
        "documentation/cloudkit/ckqueryoperation"
      ]
    }
  ],
  "references": {
    "doc://com.apple.documentation/documentation/cloudkit": {
      "title": "CloudKit",
      "identifier": "doc://com.apple.documentation/documentation/cloudkit",
      "url": "/documentation/cloudkit",
      "type": "topic",
      "kind": "symbol",
      "role": "collection"
    },
    "doc://com.apple.documentation/documentation/cloudkit/ckquery": {
      "title": "CKQuery",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/cloudkit/ckquery",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/cloudkit/ckquery",
      "abstract": [
        {
          "type": "text",
          "text": "A query that describes the criteria to apply when searching for records in a database."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/cloudkit/ckqueryoperation/1515067-querycompletionblock": {
      "title": "queryCompletionBlock",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/cloudkit/ckqueryoperation/1515067-querycompletionblock",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/cloudkit/ckqueryoperation/1515067-querycompletionblock",
      "abstract": [
        {
          "type": "text",
          "text": "The block to execute after CloudKit retrieves all of the records."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/cloudkit/ckqueryoperation/1515078-resultslimit": {
      "title": "resultsLimit",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/cloudkit/ckqueryoperation/1515078-resultslimit",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/cloudkit/ckqueryoperation/1515078-resultslimit",
      "abstract": [
        {
          "type": "text",
          "text": "The maximum number of records to return at one time."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/cloudkit/ckqueryoperation/1515268-desiredkeys": {
      "title": "desiredKeys",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/cloudkit/ckqueryoperation/1515268-desiredkeys",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/cloudkit/ckqueryoperation/1515268-desiredkeys",
      "abstract": [
        {
          "type": "text",
          "text": "The fields of the records to fetch."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/cloudkit/ckdatabase/1449116-addoperation": {
      "title": "addOperation:",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/cloudkit/ckdatabase/1449116-addoperation",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/cloudkit/ckdatabase/1449116-addoperation",
      "fragments": [
        {
          "kind": "text",
          "text": "- "
        },
        {
          "kind": "identifier",
          "text": "addOperation:"
        }
      ]
    },
    "doc://com.apple.documentation/documentation/foundation/nsoperation/1408085-completionblock": {
      "title": "completionBlock",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/foundation/nsoperation/1408085-completionblock",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/foundation/nsoperation/1408085-completionblock"
    },
    "doc://com.apple.documentation/documentation/cloudkit/ckdatabaseoperation": {
      "title": "CKDatabaseOperation",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/cloudkit/ckdatabaseoperation",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/cloudkit/ckdatabaseoperation"
    },
    "doc://com.apple.documentation/documentation/cloudkit/ckqueryoperation/1514958-initwithquery": {
      "title": "initWithQuery:",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/cloudkit/ckqueryoperation/1514958-initwithquery",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/cloudkit/ckqueryoperation/1514958-initwithquery",
      "abstract": [
        {
          "type": "text",
          "text": "Creates an operation that searches for records in the specified record zone."
        }
      ],
      "fragments": [
        {
          "kind": "text",
          "text": "- "
        },
        {
          "kind": "identifier",
          "text": "initWithQuery:"
        }
      ]
    },
    "doc://com.apple.documentation/documentation/cloudkit/ckqueryoperation/1515033-initwithcursor": {
      "title": "initWithCursor:",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/cloudkit/ckqueryoperation/1515033-initwithcursor",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/cloudkit/ckqueryoperation/1515033-initwithcursor",
      "abstract": [
        {
          "type": "text",
          "text": "Creates an operation with additional results from a previous search. "
        }
      ],
      "fragments": [
        {
          "kind": "text",
          "text": "- "
        },
        {
          "kind": "identifier",
          "text": "initWithCursor:"
        }
      ]
    },
    "doc://com.apple.documentation/documentation/cloudkit/ckqueryoperation/1515115-init": {
      "title": "init",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/cloudkit/ckqueryoperation/1515115-init",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/cloudkit/ckqueryoperation/1515115-init",
      "abstract": [
        {
          "type": "text",
          "text": "Creates an empty query operation."
        }
      ],
      "fragments": [
        {
          "kind": "text",
          "text": "- "
        },
        {
          "kind": "identifier",
          "text": "init"
        }
      ]
    },
    "doc://com.apple.documentation/documentation/cloudkit/ckqueryoperation/1515127-query": {
      "title": "query",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/cloudkit/ckqueryoperation/1515127-query",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/cloudkit/ckqueryoperation/1515127-query",
      "abstract": [
        {
          "type": "text",
          "text": "The query for the search."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/cloudkit/ckqueryoperation/1514975-cursor": {
      "title": "cursor",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/cloudkit/ckqueryoperation/1514975-cursor",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/cloudkit/ckqueryoperation/1514975-cursor",
      "abstract": [
        {
          "type": "text",
          "text": "The  cursor for continuing the search."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/cloudkit/ckquerycursor": {
      "title": "CKQueryCursor",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/cloudkit/ckquerycursor",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/cloudkit/ckquerycursor",
      "abstract": [
        {
          "type": "text",
          "text": "An object that marks the stopping point for a query and the starting point for retrieving the remaining results."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/cloudkit/ckqueryoperation/1515269-zoneid": {
      "title": "zoneID",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/cloudkit/ckqueryoperation/1515269-zoneid",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/cloudkit/ckqueryoperation/1515269-zoneid",
      "abstract": [
        {
          "type": "text",
          "text": "The ID of the record zone that contains the records to search."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/cloudkit/ckqueryoperationmaximumresults": {
      "title": "CKQueryOperationMaximumResults",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/cloudkit/ckqueryoperationmaximumresults",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/cloudkit/ckqueryoperationmaximumresults",
      "abstract": [
        {
          "type": "text",
          "text": "A constant value that represents the maximum number of results CloudKit retrieves."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/cloudkit/ckqueryoperation/1515283-recordfetchedblock": {
      "title": "recordFetchedBlock",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/cloudkit/ckqueryoperation/1515283-recordfetchedblock",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/cloudkit/ckqueryoperation/1515283-recordfetchedblock",
      "abstract": [
        {
          "type": "text",
          "text": "The block to execute when a record becomes available."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/cloudkit/ckqueryoperation": {
      "title": "CKQueryOperation",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/cloudkit/ckqueryoperation",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/cloudkit/ckqueryoperation",
      "abstract": [
        {
          "type": "text",
          "text": "An operation for executing queries in a database."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/cloudkit/cklocationsortdescriptor": {
      "title": "CKLocationSortDescriptor",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/cloudkit/cklocationsortdescriptor",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/cloudkit/cklocationsortdescriptor",
      "abstract": [
        {
          "type": "text",
          "text": "An object for sorting records that contain location data."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/technologies": {
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/technologies",
      "url": "/documentation/technologies",
      "kind": "technologies",
      "title": "Technologies"
    }
  },
  "diffAvailability": {
    "major": {
      "change": "modified",
      "platform": "Xcode",
      "versions": [
        "12.0",
        "12.3 Release Candidate"
      ]
    }
  },
  "relationshipsSections": [
    {
      "kind": "relationships",
      "title": "Inherits From",
      "type": "inheritsFrom",
      "identifiers": [
        "doc://com.apple.documentation/documentation/cloudkit/ckdatabaseoperation"
      ]
    }
  ],
  "topicSections": [
    {
      "kind": "taskGroup",
      "title": "Creating a Query Operation",
      "identifiers": [
        "doc://com.apple.documentation/documentation/cloudkit/ckqueryoperation/1514958-initwithquery",
        "doc://com.apple.documentation/documentation/cloudkit/ckqueryoperation/1515033-initwithcursor",
        "doc://com.apple.documentation/documentation/cloudkit/ckqueryoperation/1515115-init"
      ]
    },
    {
      "kind": "taskGroup",
      "title": "Configuring the Query Operation",
      "identifiers": [
        "doc://com.apple.documentation/documentation/cloudkit/ckqueryoperation/1515127-query",
        "doc://com.apple.documentation/documentation/cloudkit/ckqueryoperation/1514975-cursor",
        "doc://com.apple.documentation/documentation/cloudkit/ckquerycursor",
        "doc://com.apple.documentation/documentation/cloudkit/ckqueryoperation/1515269-zoneid",
        "doc://com.apple.documentation/documentation/cloudkit/ckqueryoperation/1515078-resultslimit",
        "doc://com.apple.documentation/documentation/cloudkit/ckqueryoperationmaximumresults",
        "doc://com.apple.documentation/documentation/cloudkit/ckqueryoperation/1515268-desiredkeys"
      ]
    },
    {
      "kind": "taskGroup",
      "title": "Processing the Query Results",
      "identifiers": [
        "doc://com.apple.documentation/documentation/cloudkit/ckqueryoperation/1515283-recordfetchedblock",
        "doc://com.apple.documentation/documentation/cloudkit/ckqueryoperation/1515067-querycompletionblock"
      ]
    }
  ],
  "seeAlsoSections": [
    {
      "identifiers": [
        "doc://com.apple.documentation/documentation/cloudkit/ckquery",
        "doc://com.apple.documentation/documentation/cloudkit/cklocationsortdescriptor"
      ],
      "title": "Queries",
      "generated": true
    }
  ],
  "primaryContentSections": [
    {
      "kind": "declarations",
      "declarations": [
        {
          "languages": [
            "occ"
          ],
          "tokens": [
            {
              "kind": "keyword",
              "text": "@interface"
            },
            {
              "kind": "text",
              "text": " "
            },
            {
              "kind": "identifier",
              "text": "CKQueryOperation"
            },
            {
              "kind": "text",
              "text": " : "
            },
            {
              "kind": "typeIdentifier",
              "preciseIdentifier": "c:objc(cs)CKDatabaseOperation",
              "identifier": "doc://com.apple.documentation/documentation/cloudkit/ckdatabaseoperation",
              "text": "CKDatabaseOperation"
            }
          ],
          "platforms": [
            "iOS",
            "macOS",
            "Mac Catalyst",
            "tvOS",
            "watchOS"
          ]
        }
      ]
    },
    {
      "kind": "content",
      "content": [
        {
          "anchor": "overview",
          "level": 2,
          "text": "Overview",
          "type": "heading"
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "A "
            },
            {
              "type": "codeVoice",
              "code": "CKQueryOperation"
            },
            {
              "type": "text",
              "text": " object is a concrete operation that you can use to execute queries. A query operation applies query parameters to the specified database and record zone, delivering any matching records asynchronously to the handlers that you provide. "
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "To perform a new search:"
            }
          ]
        },
        {
          "type": "orderedList",
          "items": [
            {
              "content": [
                {
                  "type": "paragraph",
                  "inlineContent": [
                    {
                      "type": "text",
                      "text": "Initialize a "
                    },
                    {
                      "type": "codeVoice",
                      "code": "CKQueryOperation"
                    },
                    {
                      "type": "text",
                      "text": " object with a "
                    },
                    {
                      "type": "reference",
                      "isActive": true,
                      "identifier": "doc://com.apple.documentation/documentation/cloudkit/ckquery"
                    },
                    {
                      "type": "text",
                      "text": " object that contains the search criteria and sorting information for the records you want."
                    }
                  ]
                }
              ]
            },
            {
              "content": [
                {
                  "type": "paragraph",
                  "inlineContent": [
                    {
                      "type": "text",
                      "text": "Assign a handler to the "
                    },
                    {
                      "type": "reference",
                      "isActive": true,
                      "identifier": "doc://com.apple.documentation/documentation/cloudkit/ckqueryoperation/1515067-querycompletionblock"
                    },
                    {
                      "type": "text",
                      "text": " property so that you can process the results and execute the operation. "
                    }
                  ]
                },
                {
                  "type": "paragraph",
                  "inlineContent": [
                    {
                      "type": "text",
                      "text": "If the search yields many records, the operation object may deliver a portion of the total results to your blocks immediately, along with a cursor for obtaining the remaining records. Use the cursor to initialize and execute a separate "
                    },
                    {
                      "type": "codeVoice",
                      "code": "CKQueryOperation"
                    },
                    {
                      "type": "text",
                      "text": " instance when you’re ready to process the next batch of results."
                    }
                  ]
                }
              ]
            },
            {
              "content": [
                {
                  "type": "paragraph",
                  "inlineContent": [
                    {
                      "type": "text",
                      "text": "Optionally, configure the results by specifying values for the "
                    },
                    {
                      "type": "reference",
                      "isActive": true,
                      "identifier": "doc://com.apple.documentation/documentation/cloudkit/ckqueryoperation/1515078-resultslimit"
                    },
                    {
                      "type": "text",
                      "text": " and "
                    },
                    {
                      "type": "reference",
                      "isActive": true,
                      "identifier": "doc://com.apple.documentation/documentation/cloudkit/ckqueryoperation/1515268-desiredkeys"
                    },
                    {
                      "type": "text",
                      "text": " properties. "
                    }
                  ]
                }
              ]
            },
            {
              "content": [
                {
                  "type": "paragraph",
                  "inlineContent": [
                    {
                      "type": "text",
                      "text": "Pass the query operation object to the "
                    },
                    {
                      "type": "reference",
                      "isActive": true,
                      "identifier": "doc://com.apple.documentation/documentation/cloudkit/ckdatabase/1449116-addoperation"
                    },
                    {
                      "type": "text",
                      "text": " method of the target database to execute the operation."
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "CloudKit restricts queries to the records in a single record zone. For new queries, you specify the zone when you initialize the query operation object. For cursor-based queries, the cursor contains the zone information. To search for records in multiple zones, you must create a separate "
            },
            {
              "type": "codeVoice",
              "code": "CKQueryOperation"
            },
            {
              "type": "text",
              "text": " object for each zone you want to search, although you can initialize each of them with the same "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/cloudkit/ckquery"
            },
            {
              "type": "text",
              "text": " object."
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "If you assign a handler to the operation’s "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/foundation/nsoperation/1408085-completionblock"
            },
            {
              "type": "text",
              "text": " property, the operation calls it after it executes and returns any results. Use a handler to perform housekeeping tasks for the operation, but don’t use it to process the results of the operation. The handler you provide should manage any failures, whether due to an error or an explicit cancellation. "
            }
          ]
        }
      ]
    }
  ],
  "legalNotices": {
    "copyright": "Copyright &copy; 2020 Apple Inc. All rights reserved.",
    "termsOfUse": "https://www.apple.com/legal/internet-services/terms/site.html",
    "privacyPolicy": "https://www.apple.com/privacy/privacy-policy"
  }
}