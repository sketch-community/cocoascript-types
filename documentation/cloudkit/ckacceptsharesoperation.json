{
  "abstract": [
    {
      "type": "text",
      "text": "An operation that confirms a user’s participation in a share."
    }
  ],
  "documentVersion": 0,
  "hierarchy": {
    "paths": [
      [
        "doc://com.apple.documentation/documentation/technologies",
        "doc://com.apple.documentation/documentation/cloudkit",
        "doc://com.apple.documentation/documentation/cloudkit/shared_records"
      ]
    ]
  },
  "identifier": {
    "url": "doc://com.apple.documentation/documentation/cloudkit/ckacceptsharesoperation",
    "interfaceLanguage": "occ"
  },
  "legacy_identifier": 1640460,
  "kind": "symbol",
  "metadata": {
    "title": "CKAcceptSharesOperation",
    "role": "symbol",
    "roleHeading": "Class",
    "modules": [
      {
        "name": "CloudKit"
      }
    ],
    "platforms": [
      {
        "name": "iOS",
        "introducedAt": "10.0",
        "current": "15.2"
      },
      {
        "name": "iPadOS",
        "introducedAt": "10.0",
        "current": "15.2"
      },
      {
        "name": "macOS",
        "introducedAt": "10.12",
        "current": "12.1"
      },
      {
        "name": "Mac Catalyst",
        "introducedAt": "13.0",
        "current": "15.2"
      },
      {
        "name": "tvOS",
        "introducedAt": "10.0",
        "current": "15.2"
      },
      {
        "name": "watchOS",
        "introducedAt": "3.0",
        "current": "8.3"
      }
    ],
    "externalID": "c:objc(cs)CKAcceptSharesOperation",
    "symbolKind": "cl"
  },
  "schemaVersion": {
    "major": 0,
    "minor": 1,
    "patch": 0
  },
  "sections": [],
  "variants": [
    {
      "traits": [
        {
          "interfaceLanguage": "occ"
        }
      ],
      "paths": [
        "documentation/cloudkit/ckacceptsharesoperation"
      ]
    },
    {
      "traits": [
        {
          "interfaceLanguage": "swift"
        }
      ],
      "paths": [
        "documentation/cloudkit/ckacceptsharesoperation"
      ]
    }
  ],
  "references": {
    "doc://com.apple.documentation/documentation/cloudkit": {
      "title": "CloudKit",
      "identifier": "doc://com.apple.documentation/documentation/cloudkit",
      "url": "/documentation/cloudkit",
      "type": "topic",
      "kind": "symbol",
      "role": "collection"
    },
    "doc://com.apple.documentation/documentation/cloudkit/shared_records": {
      "title": "Shared Records",
      "identifier": "doc://com.apple.documentation/documentation/cloudkit/shared_records",
      "url": "/documentation/cloudkit/shared_records",
      "type": "topic",
      "kind": "article",
      "role": "collectionGroup"
    },
    "doc://com.apple.documentation/documentation/cloudkit/ckshare/1640465-url": {
      "title": "URL",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/cloudkit/ckshare/1640465-url",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/cloudkit/ckshare/1640465-url"
    },
    "doc://com.apple.documentation/documentation/cloudkit/cksharemetadata": {
      "title": "CKShareMetadata",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/cloudkit/cksharemetadata",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/cloudkit/cksharemetadata",
      "abstract": [
        {
          "type": "text",
          "text": "An object that describes a shared record’s metadata."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/cloudkit/ckfetchsharemetadataoperation": {
      "title": "CKFetchShareMetadataOperation",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/cloudkit/ckfetchsharemetadataoperation",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/cloudkit/ckfetchsharemetadataoperation",
      "abstract": [
        {
          "type": "text",
          "text": "An operation that fetches metadata for one or more shares."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/cloudkit/cksharemetadata/1640400-containeridentifier": {
      "title": "containerIdentifier",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/cloudkit/cksharemetadata/1640400-containeridentifier",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/cloudkit/cksharemetadata/1640400-containeridentifier"
    },
    "doc://com.apple.documentation/documentation/cloudkit/ckacceptsharesoperation/1640426-persharecompletionblock": {
      "title": "perShareCompletionBlock",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/cloudkit/ckacceptsharesoperation/1640426-persharecompletionblock",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/cloudkit/ckacceptsharesoperation/1640426-persharecompletionblock",
      "abstract": [
        {
          "type": "text",
          "text": "The block to execute as CloudKit processes individual shares."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/cloudkit/ckerror/2325226-partialfailure": {
      "title": "partialFailure",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/cloudkit/ckerror/2325226-partialfailure",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/cloudkit/ckerror/2325226-partialfailure"
    },
    "doc://com.apple.documentation/documentation/foundation/nserror/1411580-userinfo": {
      "title": "userInfo",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/foundation/nserror/1411580-userinfo",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/foundation/nserror/1411580-userinfo"
    },
    "doc://com.apple.documentation/documentation/cloudkit/ckpartialerrorsbyitemidkey": {
      "title": "CKPartialErrorsByItemIDKey",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/cloudkit/ckpartialerrorsbyitemidkey",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/cloudkit/ckpartialerrorsbyitemidkey"
    },
    "doc://com.apple.documentation/documentation/cloudkit/ckacceptsharesoperation/1640442-acceptsharescompletionblock": {
      "title": "acceptSharesCompletionBlock",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/cloudkit/ckacceptsharesoperation/1640442-acceptsharescompletionblock",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/cloudkit/ckacceptsharesoperation/1640442-acceptsharescompletionblock",
      "abstract": [
        {
          "type": "text",
          "text": "The block to execute when the operation finishes."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/cloudkit/ckacceptsharesoperation#3737945": {
      "title": "Listing 1",
      "type": "section",
      "identifier": "doc://com.apple.documentation/documentation/cloudkit/ckacceptsharesoperation#3737945",
      "kind": "article",
      "role": "codeListing",
      "url": "/documentation/cloudkit/ckacceptsharesoperation#3737945"
    },
    "doc://com.apple.documentation/documentation/cloudkit/ckoperation": {
      "title": "CKOperation",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/cloudkit/ckoperation",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/cloudkit/ckoperation"
    },
    "doc://com.apple.documentation/documentation/cloudkit/ckacceptsharesoperation/1640506-init": {
      "title": "init",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/cloudkit/ckacceptsharesoperation/1640506-init",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/cloudkit/ckacceptsharesoperation/1640506-init",
      "abstract": [
        {
          "type": "text",
          "text": "Creates an operation for accepting shares."
        }
      ],
      "fragments": [
        {
          "kind": "text",
          "text": "- "
        },
        {
          "kind": "identifier",
          "text": "init"
        }
      ]
    },
    "doc://com.apple.documentation/documentation/cloudkit/ckacceptsharesoperation/1823506-initwithsharemetadatas": {
      "title": "initWithShareMetadatas:",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/cloudkit/ckacceptsharesoperation/1823506-initwithsharemetadatas",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/cloudkit/ckacceptsharesoperation/1823506-initwithsharemetadatas",
      "abstract": [
        {
          "type": "text",
          "text": "Creates an operation for accepting the specified shares."
        }
      ],
      "fragments": [
        {
          "kind": "text",
          "text": "- "
        },
        {
          "kind": "identifier",
          "text": "initWithShareMetadatas:"
        }
      ]
    },
    "doc://com.apple.documentation/documentation/cloudkit/ckacceptsharesoperation/1823508-sharemetadatas": {
      "title": "shareMetadatas",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/cloudkit/ckacceptsharesoperation/1823508-sharemetadatas",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/cloudkit/ckacceptsharesoperation/1823508-sharemetadatas",
      "abstract": [
        {
          "type": "text",
          "text": "The share metadatas to process."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/cloudkit/ckacceptsharesoperation": {
      "title": "CKAcceptSharesOperation",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/cloudkit/ckacceptsharesoperation",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/cloudkit/ckacceptsharesoperation",
      "abstract": [
        {
          "type": "text",
          "text": "An operation that confirms a user’s participation in a share."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/technologies": {
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/technologies",
      "url": "/documentation/technologies",
      "kind": "technologies",
      "title": "Technologies"
    }
  },
  "relationshipsSections": [
    {
      "kind": "relationships",
      "title": "Inherits From",
      "type": "inheritsFrom",
      "identifiers": [
        "doc://com.apple.documentation/documentation/cloudkit/ckoperation"
      ]
    }
  ],
  "topicSections": [
    {
      "kind": "taskGroup",
      "title": "Creating a Share Accept Operation",
      "identifiers": [
        "doc://com.apple.documentation/documentation/cloudkit/ckacceptsharesoperation/1640506-init",
        "doc://com.apple.documentation/documentation/cloudkit/ckacceptsharesoperation/1823506-initwithsharemetadatas"
      ],
      "anchor": "2359196"
    },
    {
      "kind": "taskGroup",
      "title": "Processing the Share Accept Results",
      "identifiers": [
        "doc://com.apple.documentation/documentation/cloudkit/ckacceptsharesoperation/1823508-sharemetadatas",
        "doc://com.apple.documentation/documentation/cloudkit/ckacceptsharesoperation/1640426-persharecompletionblock",
        "doc://com.apple.documentation/documentation/cloudkit/ckacceptsharesoperation/1640442-acceptsharescompletionblock"
      ],
      "anchor": "2359195"
    }
  ],
  "seeAlsoSections": [
    {
      "identifiers": [
        "doc://com.apple.documentation/documentation/cloudkit/ckfetchsharemetadataoperation",
        "doc://com.apple.documentation/documentation/cloudkit/cksharemetadata"
      ],
      "title": "Share Requests",
      "generated": true
    }
  ],
  "primaryContentSections": [
    {
      "kind": "declarations",
      "declarations": [
        {
          "languages": [
            "occ"
          ],
          "tokens": [
            {
              "kind": "keyword",
              "text": "@interface"
            },
            {
              "kind": "text",
              "text": " "
            },
            {
              "kind": "identifier",
              "text": "CKAcceptSharesOperation"
            },
            {
              "kind": "text",
              "text": " : "
            },
            {
              "kind": "typeIdentifier",
              "preciseIdentifier": "c:objc(cs)CKOperation",
              "identifier": "doc://com.apple.documentation/documentation/cloudkit/ckoperation",
              "text": "CKOperation"
            }
          ],
          "platforms": [
            "iOS",
            "iPadOS",
            "macOS",
            "Mac Catalyst",
            "tvOS",
            "watchOS"
          ]
        }
      ]
    },
    {
      "kind": "content",
      "content": [
        {
          "anchor": "overview",
          "level": 2,
          "text": "Overview",
          "type": "heading"
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "Use this operation to accept participation in one or more shares. You create the operation with an array of share metadatas, which CloudKit provides to your app when the user taps or clicks a share’s "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/cloudkit/ckshare/1640465-url"
            },
            {
              "type": "text",
              "text": ". The method CloudKit calls varies by platform and app configuration. For more information, see "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/cloudkit/cksharemetadata"
            },
            {
              "type": "text",
              "text": ". You can also fetch a share’s metadata using "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/cloudkit/ckfetchsharemetadataoperation"
            },
            {
              "type": "text",
              "text": "."
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "If there are several metadatas, group them by their "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/cloudkit/cksharemetadata/1640400-containeridentifier"
            },
            {
              "type": "text",
              "text": " and create an operation for each container. Then add the operation to each container’s operation queue to run it. The operation executes its callbacks on a private serial queue."
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "The operation calls "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/cloudkit/ckacceptsharesoperation/1640426-persharecompletionblock"
            },
            {
              "type": "text",
              "text": " once for each metadata you provide. CloudKit returns the metadata and its related share, or an error if it can’t accept the share. CloudKit also batches per-metadata errors. If the operation completes with errors, it returns a "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/cloudkit/ckerror/2325226-partialfailure"
            },
            {
              "type": "text",
              "text": " error. The error stores individual errors in its "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/foundation/nserror/1411580-userinfo"
            },
            {
              "type": "text",
              "text": " dictionary. Use the "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/cloudkit/ckpartialerrorsbyitemidkey"
            },
            {
              "type": "text",
              "text": " key to extract them."
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "After CloudKit applies all record changes, the operation calls "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/cloudkit/ckacceptsharesoperation/1640442-acceptsharescompletionblock"
            },
            {
              "type": "text",
              "text": ". When the closure executes, the server may continue processing residual tasks of the operation, such as creating the record zone in the user’s private database."
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "The following example demonstrates how to accept a share that CloudKit provides to your window scene delegate. It shows how to create the operation, configure it, and execute it in the correct container:"
            }
          ]
        },
        {
          "type": "codeListing",
          "code": [
            "func windowScene(_ windowScene: UIWindowScene, ",
            "    userDidAcceptCloudKitShareWith cloudKitShareMetadata: CKShare.Metadata) {",
            "    ",
            "    // Accept the share. If successful, schedule a fetch of the ",
            "    // share's root record.",
            "    acceptShare(metadata: cloudKitShareMetadata) { [weak self] result in",
            "        switch result {",
            "        case .success(let recordID):",
            "            self?.fetchRootRecordAndNotifyObservers(recordID)",
            "        case .failure(let error):",
            "            // Handle the error...",
            "        }",
            "    }",
            "}",
            "    ",
            "func acceptShare(metadata: CKShare.Metadata, ",
            "    completion: @escaping (Result<CKRecord.ID, Error>) -> Void) {",
            "    ",
            "    // Create a reference to the share's container so the operation",
            "    // executes in the correct context. ",
            "    let container = CKContainer(identifier: metadata.containerIdentifier)",
            "    ",
            "    // Create the operation using the metadata the caller provides.",
            "    let operation = CKAcceptSharesOperation(shareMetadatas: [metadata])",
            "        ",
            "    var rootRecordID: CKRecord.ID!",
            "    // If CloudKit accepts the share, cache the root record's ID. ",
            "    // The completion closure handles any errors.",
            "    operation.perShareCompletionBlock = { metadata, share, error in",
            "        if let _ = share, error == nil {",
            "            rootRecordID = hierarchicalRootRecordID ",
            "        }",
            "    }",
            "",
            "    // If the operation fails, return the error to the caller.",
            "    // Otherwise, return the record ID of the share's root record.",
            "    operation.acceptSharesCompletionBlock = { error in",
            "        if let error = error {",
            "            completion(.failure(error))",
            "        } else {",
            "            completion(.success(rootRecordID))",
            "        }",
            "    }",
            "",
            "    // Set an appropriate QoS and add the operation to the",
            "    // container's queue to execute it.",
            "    operation.qualityOfService = .utility",
            "    container.add(operation)",
            "}"
          ],
          "syntax": "swift",
          "metadata": {
            "anchor": "3737945",
            "title": "Listing 1"
          }
        },
        {
          "type": "paragraph",
          "inlineContent": []
        }
      ]
    }
  ],
  "legalNotices": {
    "copyright": "Copyright &copy; 2021 Apple Inc. All rights reserved.",
    "termsOfUse": "https://www.apple.com/legal/internet-services/terms/site.html",
    "privacyPolicy": "https://www.apple.com/privacy/privacy-policy"
  }
}