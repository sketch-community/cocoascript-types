{
  "abstract": [
    {
      "type": "text",
      "text": "Get location updates in the most power-efficient way, but less frequently than with other services. "
    }
  ],
  "documentVersion": 0,
  "hierarchy": {
    "paths": [
      [
        "doc://com.apple.documentation/documentation/technologies",
        "doc://com.apple.documentation/documentation/corelocation",
        "doc://com.apple.documentation/documentation/corelocation/getting_the_user_s_location"
      ]
    ]
  },
  "identifier": {
    "url": "doc://com.apple.documentation/documentation/corelocation/getting_the_user_s_location/using_the_visits_location_service",
    "interfaceLanguage": "occ"
  },
  "legacy_identifier": 2854944,
  "kind": "article",
  "metadata": {
    "title": "Using the Visits Location Service",
    "role": "article",
    "roleHeading": "Article",
    "modules": [
      {
        "name": "Core Location"
      }
    ]
  },
  "schemaVersion": {
    "major": 1,
    "minor": 0,
    "patch": 0
  },
  "sections": [],
  "variants": [
    {
      "traits": [
        {
          "interfaceLanguage": "occ"
        }
      ],
      "paths": [
        "documentation/corelocation/getting_the_user_s_location/using_the_visits_location_service"
      ]
    },
    {
      "traits": [
        {
          "interfaceLanguage": "swift"
        }
      ],
      "paths": [
        "documentation/corelocation/getting_the_user_s_location/using_the_visits_location_service"
      ]
    }
  ],
  "references": {
    "doc://com.apple.documentation/documentation/corelocation": {
      "title": "Core Location",
      "identifier": "doc://com.apple.documentation/documentation/corelocation",
      "url": "/documentation/corelocation",
      "type": "topic",
      "kind": "symbol",
      "role": "collection"
    },
    "doc://com.apple.documentation/documentation/corelocation/getting_the_user_s_location": {
      "title": "Getting the User's Location",
      "identifier": "doc://com.apple.documentation/documentation/corelocation/getting_the_user_s_location",
      "url": "/documentation/corelocation/getting_the_user_s_location",
      "type": "topic",
      "kind": "article",
      "role": "article"
    },
    "doc://com.apple.documentation/documentation/corelocation/cllocationmanagerdelegate/1621529-locationmanager": {
      "title": "locationManager:didVisit:",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/corelocation/cllocationmanagerdelegate/1621529-locationmanager",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/corelocation/cllocationmanagerdelegate/1621529-locationmanager",
      "fragments": [
        {
          "kind": "text",
          "text": "- "
        },
        {
          "kind": "identifier",
          "text": "locationManager:didVisit:"
        }
      ]
    },
    "doc://com.apple.documentation/documentation/corelocation/getting_the_user_s_location/using_the_visits_location_service#2854965": {
      "title": "Listing 1",
      "type": "section",
      "identifier": "doc://com.apple.documentation/documentation/corelocation/getting_the_user_s_location/using_the_visits_location_service#2854965",
      "kind": "article",
      "role": "codeListing",
      "url": "/documentation/corelocation/getting_the_user_s_location/using_the_visits_location_service#2854965",
      "abstract": [
        {
          "type": "text",
          "text": "Receiving visit updates"
        }
      ]
    },
    "doc://com.apple.documentation/documentation/corelocation/cllocationmanagerdelegate/1423786-locationmanager": {
      "title": "locationManager:didFailWithError:",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/corelocation/cllocationmanagerdelegate/1423786-locationmanager",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/corelocation/cllocationmanagerdelegate/1423786-locationmanager",
      "fragments": [
        {
          "kind": "text",
          "text": "- "
        },
        {
          "kind": "identifier",
          "text": "locationManager:didFailWithError:"
        }
      ]
    },
    "doc://com.apple.documentation/documentation/corelocation/getting_the_user_s_location/using_the_visits_location_service#2854962": {
      "title": "Listing 2",
      "type": "section",
      "identifier": "doc://com.apple.documentation/documentation/corelocation/getting_the_user_s_location/using_the_visits_location_service#2854962",
      "kind": "article",
      "role": "codeListing",
      "url": "/documentation/corelocation/getting_the_user_s_location/using_the_visits_location_service#2854962",
      "abstract": [
        {
          "type": "text",
          "text": "Stopping location services when authorization is denied"
        }
      ]
    },
    "doc://com.apple.documentation/documentation/corelocation/requesting_authorization_for_location_services": {
      "title": "Requesting Authorization for Location Services",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/corelocation/requesting_authorization_for_location_services",
      "kind": "article",
      "role": "article",
      "url": "/documentation/corelocation/requesting_authorization_for_location_services"
    },
    "doc://com.apple.documentation/documentation/corelocation/cllocationmanager/1618692-startmonitoringvisits": {
      "title": "startMonitoringVisits",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/corelocation/cllocationmanager/1618692-startmonitoringvisits",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/corelocation/cllocationmanager/1618692-startmonitoringvisits",
      "fragments": [
        {
          "kind": "text",
          "text": "- "
        },
        {
          "kind": "identifier",
          "text": "startMonitoringVisits"
        }
      ]
    },
    "doc://com.apple.documentation/documentation/corelocation/cllocationmanager/1423500-distancefilter": {
      "title": "distanceFilter",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/corelocation/cllocationmanager/1423500-distancefilter",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/corelocation/cllocationmanager/1423500-distancefilter"
    },
    "doc://com.apple.documentation/documentation/corelocation/cllocationmanager/1423836-desiredaccuracy": {
      "title": "desiredAccuracy",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/corelocation/cllocationmanager/1423836-desiredaccuracy",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/corelocation/cllocationmanager/1423836-desiredaccuracy"
    },
    "doc://com.apple.documentation/documentation/corelocation/cllocationmanager/1620553-pauseslocationupdatesautomatical": {
      "title": "pausesLocationUpdatesAutomatically",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/corelocation/cllocationmanager/1620553-pauseslocationupdatesautomatical",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/corelocation/cllocationmanager/1620553-pauseslocationupdatesautomatical"
    },
    "doc://com.apple.documentation/documentation/objectivec/yes": {
      "title": "YES",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/objectivec/yes",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/objectivec/yes"
    },
    "doc://com.apple.documentation/documentation/corelocation/cllocationmanager/1620567-activitytype": {
      "title": "activityType",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/corelocation/cllocationmanager/1620567-activitytype",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/corelocation/cllocationmanager/1620567-activitytype"
    },
    "doc://com.apple.documentation/documentation/corelocation/cllocationmanager/1618693-stopmonitoringvisits": {
      "title": "stopMonitoringVisits",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/corelocation/cllocationmanager/1618693-stopmonitoringvisits",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/corelocation/cllocationmanager/1618693-stopmonitoringvisits",
      "fragments": [
        {
          "kind": "text",
          "text": "- "
        },
        {
          "kind": "identifier",
          "text": "stopMonitoringVisits"
        }
      ]
    },
    "doc://com.apple.documentation/documentation/corelocation/getting_the_user_s_location/using_the_visits_location_service": {
      "title": "Using the Visits Location Service",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/corelocation/getting_the_user_s_location/using_the_visits_location_service",
      "kind": "article",
      "role": "article",
      "url": "/documentation/corelocation/getting_the_user_s_location/using_the_visits_location_service",
      "abstract": [
        {
          "type": "text",
          "text": "Get location updates in the most power-efficient way, but less frequently than with other services. "
        }
      ]
    },
    "doc://com.apple.documentation/documentation/corelocation/getting_the_user_s_location/using_the_significant-change_location_service": {
      "title": "Using the Significant-Change Location Service",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/corelocation/getting_the_user_s_location/using_the_significant-change_location_service",
      "kind": "article",
      "role": "article",
      "url": "/documentation/corelocation/getting_the_user_s_location/using_the_significant-change_location_service",
      "abstract": [
        {
          "type": "text",
          "text": "Get location updates in a power-friendly way, but less frequently than with the standard location service."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/corelocation/getting_the_user_s_location/using_the_standard_location_service": {
      "title": "Using the Standard Location Service",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/corelocation/getting_the_user_s_location/using_the_standard_location_service",
      "kind": "article",
      "role": "article",
      "url": "/documentation/corelocation/getting_the_user_s_location/using_the_standard_location_service",
      "abstract": [
        {
          "type": "text",
          "text": "Get regular location updates based on the parameters you specify."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/corelocation/getting_the_user_s_location/handling_location_events_in_the_background": {
      "title": "Handling Location Events in the Background",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/corelocation/getting_the_user_s_location/handling_location_events_in_the_background",
      "kind": "article",
      "role": "article",
      "url": "/documentation/corelocation/getting_the_user_s_location/handling_location_events_in_the_background",
      "abstract": [
        {
          "type": "text",
          "text": "Take advantage of background execution modes to respond to location-related events at any time."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/corelocation/converting_between_coordinates_and_user-friendly_place_names": {
      "title": "Converting Between Coordinates and User-Friendly Place Names",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/corelocation/converting_between_coordinates_and_user-friendly_place_names",
      "kind": "article",
      "role": "article",
      "url": "/documentation/corelocation/converting_between_coordinates_and_user-friendly_place_names",
      "abstract": [
        {
          "type": "text",
          "text": "Convert between a latitude/longitude pair and a more user-friendly description of that location."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/mapkit/mkmapview/converting_a_user_s_location_to_a_descriptive_placemark": {
      "title": "Converting a User's Location to a Descriptive Placemark",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/mapkit/mkmapview/converting_a_user_s_location_to_a_descriptive_placemark",
      "kind": "article",
      "role": "article",
      "url": "/documentation/mapkit/mkmapview/converting_a_user_s_location_to_a_descriptive_placemark",
      "abstract": [
        {
          "type": "text",
          "text": "Transform the user’s location displayed on a map into an informative description."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/technologies": {
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/technologies",
      "url": "/documentation/technologies",
      "kind": "technologies",
      "title": "Technologies"
    }
  },
  "seeAlsoSections": [
    {
      "identifiers": [
        "doc://com.apple.documentation/documentation/corelocation/getting_the_user_s_location/using_the_significant-change_location_service",
        "doc://com.apple.documentation/documentation/corelocation/getting_the_user_s_location/using_the_standard_location_service",
        "doc://com.apple.documentation/documentation/corelocation/getting_the_user_s_location/handling_location_events_in_the_background",
        "doc://com.apple.documentation/documentation/corelocation/converting_between_coordinates_and_user-friendly_place_names",
        "doc://com.apple.documentation/documentation/mapkit/mkmapview/converting_a_user_s_location_to_a_descriptive_placemark"
      ],
      "title": "Related Topics",
      "generated": true
    }
  ],
  "primaryContentSections": [
    {
      "kind": "content",
      "content": [
        {
          "anchor": "overview",
          "level": 2,
          "text": "Overview",
          "type": "heading"
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "The visits service is the most power-efficient way of gathering location data. With this service, the system delivers location updates only when the user’s movements are noteworthy. Each update includes both the location and the amount of time spent at that location. This service isn’t intended for navigation or other real-time activities, but you can use to identify patterns in the user’s behavior and apply that knowledge to other parts of your app. For example, a music app might prepare a gym playlist if a user arrives at the gym at their normal workout time."
            }
          ]
        },
        {
          "type": "aside",
          "content": [
            {
              "type": "paragraph",
              "inlineContent": [
                {
                  "type": "text",
                  "text": "The visits location service requires authorization. For information about how to request authorization, see "
                },
                {
                  "type": "reference",
                  "isActive": true,
                  "identifier": "doc://com.apple.documentation/documentation/corelocation/requesting_authorization_for_location_services"
                },
                {
                  "type": "text",
                  "text": "."
                }
              ]
            }
          ],
          "style": "note",
          "name": "Note"
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "To start the visits location service, call the "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/corelocation/cllocationmanager/1618692-startmonitoringvisits"
            },
            {
              "type": "text",
              "text": " method of your location manager. With this service, the location manager ignores the values in its "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/corelocation/cllocationmanager/1423500-distancefilter"
            },
            {
              "type": "text",
              "text": " and "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/corelocation/cllocationmanager/1423836-desiredaccuracy"
            },
            {
              "type": "text",
              "text": " properties, so you don’t need to configure them. The location manager delivers updates to the "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/corelocation/cllocationmanagerdelegate/1621529-locationmanager"
            },
            {
              "type": "text",
              "text": " method of its delegate. "
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "Another way to save power is to set the "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/corelocation/cllocationmanager/1620553-pauseslocationupdatesautomatical"
            },
            {
              "type": "text",
              "text": " property of your location manager object to "
            },
            {
              "type": "reference",
              "isActive": false,
              "identifier": "doc://com.apple.documentation/documentation/objectivec/yes"
            },
            {
              "type": "text",
              "text": ". Enabling this property lets the system reduce power consumption by disabling location hardware when the user is unlikely to be moving. Pausing updates doesn’t diminish the quality of those updates, but can improve battery life significantly. To help the system determine when to pause updates, you must also assign an appropriate value to the "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/corelocation/cllocationmanager/1620567-activitytype"
            },
            {
              "type": "text",
              "text": " property of your location manager. "
            }
          ]
        },
        {
          "type": "aside",
          "content": [
            {
              "type": "paragraph",
              "inlineContent": [
                {
                  "type": "text",
                  "text": "When you no longer need location data, always call your location manager object’s "
                },
                {
                  "type": "reference",
                  "isActive": true,
                  "identifier": "doc://com.apple.documentation/documentation/corelocation/cllocationmanager/1618693-stopmonitoringvisits"
                },
                {
                  "type": "text",
                  "text": " method. If you don’t stop location updates, the system continues delivering location data to your app, which could drain the battery of the user’s device."
                }
              ]
            }
          ],
          "style": "note",
          "name": "Note"
        },
        {
          "level": 3,
          "type": "heading",
          "text": "Receiving Visit Updates",
          "anchor": "2854963"
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "When you start the visits location service, a recently cached value may be reported to your delegate immediately. As new visit data is obtained, the location manager calls your delegate’s "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/corelocation/cllocationmanagerdelegate/1621529-locationmanager"
            },
            {
              "type": "text",
              "text": " method with the updated value."
            }
          ]
        },
        {
          "type": "codeListing",
          "code": [
            "func locationManager(_ manager: CLLocationManager, didVisit visit: CLVisit) {",
            "    // Do something with the visit. ",
            "}"
          ],
          "syntax": "swift",
          "metadata": {
            "anchor": "2854965",
            "title": "Listing 1",
            "abstract": [
              {
                "type": "text",
                "text": "Receiving visit updates"
              }
            ]
          }
        },
        {
          "level": 3,
          "type": "heading",
          "text": "Handling Location-Related Errors",
          "anchor": "2854964"
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "When the location manager is unable to deliver location updates, it calls the "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/corelocation/cllocationmanagerdelegate/1423786-locationmanager"
            },
            {
              "type": "text",
              "text": " method of its delegate object. You should always implement this delegate method to handle any errors that might occur. For example, this method is called when the user denies authorization for your app to use location services. In such a scenario, you might want to disable location-related features and notify the user which features are unavailable. You should also stop whatever service you previously started, as demonstrated in "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/corelocation/getting_the_user_s_location/using_the_visits_location_service#2854962"
            },
            {
              "type": "text",
              "text": "."
            }
          ]
        },
        {
          "type": "codeListing",
          "code": [
            "func locationManager(_ manager: CLLocationManager,  didFailWithError error: Error) {",
            "   if error.code == .denied {",
            "      // Location updates are not authorized.",
            "      locationManager.stopMonitoringVisits()",
            "      return",
            "   }",
            "   // Notify the user of any errors.",
            "}"
          ],
          "syntax": "swift",
          "metadata": {
            "anchor": "2854962",
            "title": "Listing 2",
            "abstract": [
              {
                "type": "text",
                "text": "Stopping location services when authorization is denied"
              }
            ]
          }
        }
      ]
    }
  ],
  "legalNotices": {
    "copyright": "Copyright &copy; 2020 Apple Inc. All rights reserved.",
    "termsOfUse": "https://www.apple.com/legal/internet-services/terms/site.html",
    "privacyPolicy": "https://www.apple.com/privacy/privacy-policy"
  }
}