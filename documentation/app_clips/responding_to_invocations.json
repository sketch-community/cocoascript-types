{
  "abstract": [
    {
      "type": "text",
      "text": "Add code to respond quickly and seamlessly when a user launches your App Clip."
    }
  ],
  "documentVersion": 0,
  "hierarchy": {
    "paths": [
      [
        "doc://com.apple.documentation/documentation/technologies",
        "doc://com.apple.documentation/documentation/app_clips"
      ]
    ]
  },
  "identifier": {
    "url": "doc://com.apple.documentation/documentation/app_clips/responding_to_invocations",
    "interfaceLanguage": "occ"
  },
  "legacy_identifier": 3586896,
  "kind": "article",
  "metadata": {
    "title": "Responding to Invocations",
    "role": "article",
    "roleHeading": "Article"
  },
  "schemaVersion": {
    "major": 1,
    "minor": 0,
    "patch": 0
  },
  "sections": [],
  "variants": [
    {
      "traits": [
        {
          "interfaceLanguage": "occ"
        }
      ],
      "paths": [
        "documentation/app_clips/responding_to_invocations"
      ]
    },
    {
      "traits": [
        {
          "interfaceLanguage": "swift"
        }
      ],
      "paths": [
        "documentation/app_clips/responding_to_invocations"
      ]
    }
  ],
  "references": {
    "doc://com.apple.documentation/documentation/app_clips": {
      "title": "App Clips",
      "identifier": "doc://com.apple.documentation/documentation/app_clips",
      "url": "/documentation/app_clips",
      "type": "topic",
      "kind": "symbol",
      "role": "collection"
    },
    "doc://com.apple.documentation/documentation/bundleresources/entitlements/com_apple_developer_associated-domains": {
      "title": "Associated Domains Entitlement",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/bundleresources/entitlements/com_apple_developer_associated-domains",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/bundleresources/entitlements/com_apple_developer_associated-domains"
    },
    "doc://com.apple.documentation/documentation/foundation/nsuseractivity": {
      "title": "NSUserActivity",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/foundation/nsuseractivity",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/foundation/nsuseractivity"
    },
    "doc://com.apple.documentation/documentation/swiftui/view/oncontinueuseractivity(_:perform:)": {
      "title": "onContinueUserActivity(_:perform:)",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/swiftui/view/oncontinueuseractivity(_:perform:)",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/swiftui/view/oncontinueuseractivity(_:perform:)"
    },
    "doc://com.apple.documentation/documentation/uikit/uiscenedelegate": {
      "title": "UISceneDelegate",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/uikit/uiscenedelegate",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/uikit/uiscenedelegate"
    },
    "doc://com.apple.documentation/documentation/uikit/uiscenedelegate/3238056-scene": {
      "title": "scene:continueUserActivity:",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/uikit/uiscenedelegate/3238056-scene",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/uikit/uiscenedelegate/3238056-scene",
      "fragments": [
        {
          "kind": "text",
          "text": "- "
        },
        {
          "kind": "identifier",
          "text": "scene:continueUserActivity:"
        }
      ]
    },
    "doc://com.apple.documentation/documentation/uikit/uiapplicationdelegate": {
      "title": "UIApplicationDelegate",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/uikit/uiapplicationdelegate",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/uikit/uiapplicationdelegate"
    },
    "doc://com.apple.documentation/documentation/uikit/uiapplicationdelegate/1623072-application": {
      "title": "application:continueUserActivity:restorationHandler:",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/uikit/uiapplicationdelegate/1623072-application",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/uikit/uiapplicationdelegate/1623072-application",
      "fragments": [
        {
          "kind": "text",
          "text": "- "
        },
        {
          "kind": "identifier",
          "text": "application:continueUserActivity:restorationHandler:"
        }
      ]
    },
    "doc://com.apple.documentation/documentation/uikit/uiapplicationdelegate/1622921-application": {
      "title": "application:didFinishLaunchingWithOptions:",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/uikit/uiapplicationdelegate/1622921-application",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/uikit/uiapplicationdelegate/1622921-application",
      "fragments": [
        {
          "kind": "text",
          "text": "- "
        },
        {
          "kind": "identifier",
          "text": "application:didFinishLaunchingWithOptions:"
        }
      ]
    },
    "doc://com.apple.documentation/documentation/foundation/nsuseractivitytypebrowsingweb": {
      "title": "NSUserActivityTypeBrowsingWeb",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/foundation/nsuseractivitytypebrowsingweb",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/foundation/nsuseractivitytypebrowsingweb"
    },
    "doc://com.apple.documentation/documentation/app_clips/responding_to_invocations#3604123": {
      "title": "Listing 1",
      "type": "section",
      "identifier": "doc://com.apple.documentation/documentation/app_clips/responding_to_invocations#3604123",
      "kind": "article",
      "role": "codeListing",
      "url": "/documentation/app_clips/responding_to_invocations#3604123"
    },
    "doc://com.apple.documentation/documentation/uikit/app_and_environment/managing_your_app_s_life_cycle": {
      "title": "Managing Your App's Life Cycle",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/uikit/app_and_environment/managing_your_app_s_life_cycle",
      "kind": "article",
      "role": "article",
      "url": "/documentation/uikit/app_and_environment/managing_your_app_s_life_cycle"
    },
    "doc://com.apple.documentation/documentation/app_clips/responding_to_invocations": {
      "title": "Responding to Invocations",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/app_clips/responding_to_invocations",
      "kind": "article",
      "role": "article",
      "url": "/documentation/app_clips/responding_to_invocations",
      "abstract": [
        {
          "type": "text",
          "text": "Add code to respond quickly and seamlessly when a user launches your App Clip."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/app_clips/confirming_the_user_s_physical_location": {
      "title": "Confirming the User’s Physical Location",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/app_clips/confirming_the_user_s_physical_location",
      "kind": "article",
      "role": "article",
      "url": "/documentation/app_clips/confirming_the_user_s_physical_location",
      "abstract": [
        {
          "type": "text",
          "text": "Add code to quickly confirm the user’s physical location while respecting their privacy."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/app_clips/apactivationpayload": {
      "title": "APActivationPayload",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/app_clips/apactivationpayload",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/app_clips/apactivationpayload",
      "abstract": [
        {
          "type": "text",
          "text": "Information that’s passed to an App Clip on launch."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/bundleresources/information_property_list/nsappclip": {
      "title": "NSAppClip",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/bundleresources/information_property_list/nsappclip",
      "kind": "symbol",
      "role": "dictionarySymbol",
      "url": "/documentation/bundleresources/information_property_list/nsappclip",
      "abstract": [
        {
          "type": "text",
          "text": "A collection of keys that an App Clip uses to get additional capabilities."
        }
      ],
      "titleStyle": "symbol",
      "name": "NSAppClip",
      "ideTitle": "App Clip",
      "fragments": [
        {
          "kind": "label",
          "text": "property list key "
        },
        {
          "kind": "identifier",
          "text": "NSAppClip"
        }
      ]
    },
    "doc://com.apple.documentation/documentation/technologies": {
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/technologies",
      "url": "/documentation/technologies",
      "kind": "technologies",
      "title": "Technologies"
    }
  },
  "seeAlsoSections": [
    {
      "identifiers": [
        "doc://com.apple.documentation/documentation/app_clips/confirming_the_user_s_physical_location",
        "doc://com.apple.documentation/documentation/app_clips/apactivationpayload",
        "doc://com.apple.documentation/documentation/bundleresources/information_property_list/nsappclip"
      ],
      "title": "Launch",
      "generated": true
    }
  ],
  "primaryContentSections": [
    {
      "kind": "content",
      "content": [
        {
          "anchor": "overview",
          "level": 2,
          "text": "Overview",
          "type": "heading"
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "A great launch experience is key to the user’s experience with your App Clip. When a user invokes your App Clip, the operating system verifies it. Then, when the user launches the App Clip, the system makes the "
            },
            {
              "type": "emphasis",
              "inlineContent": [
                {
                  "type": "text",
                  "text": "invocation URL"
                }
              ]
            },
            {
              "type": "text",
              "text": " available to the App Clip. In your code, access the invocation URL upon launch and take the user to the part of the App Clip that best fits their current context."
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "Because the full app replaces the App Clip when users install it, users expect the full app to offer at least the same functionality as the App Clip, and they expect a familiar launch experience. Leverage the invocation URL in your full app to offer a focused user experience that reduces the number of steps in a task when using the full app and ensure that the user experiences a seamless upgrade."
            }
          ]
        },
        {
          "level": 3,
          "type": "heading",
          "text": "Leveraging the Invocation URL",
          "anchor": "3629997"
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "Both the App Clip and the full app need to respond to the invocation URL and update the user interface to provide a smooth launch. For example, consider an App Clip for a business with multiple physical locations. You can configure the business domain "
            },
            {
              "type": "codeVoice",
              "code": "https://example.com"
            },
            {
              "type": "text",
              "text": " to launch the App Clip and ask the user to select a physical location from a list. However, this results in an extra step that slows down the user. You can avoid the extra step by configuring the invocation URL and passing additional URL parameters with the invocation."
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "For both your App Clip and your full app:"
            }
          ]
        },
        {
          "type": "orderedList",
          "items": [
            {
              "content": [
                {
                  "type": "paragraph",
                  "inlineContent": [
                    {
                      "type": "text",
                      "text": "Add entries for each domain that launches the App Clip to the "
                    },
                    {
                      "type": "reference",
                      "isActive": true,
                      "identifier": "doc://com.apple.documentation/documentation/bundleresources/entitlements/com_apple_developer_associated-domains"
                    },
                    {
                      "type": "text",
                      "text": " entitlement. For the example described above, you’d add "
                    },
                    {
                      "type": "codeVoice",
                      "code": "myexample.com"
                    },
                    {
                      "type": "text",
                      "text": ". You typically do this when you add an App Clip target to your Xcode project."
                    }
                  ]
                }
              ]
            },
            {
              "content": [
                {
                  "type": "paragraph",
                  "inlineContent": [
                    {
                      "type": "text",
                      "text": "Use invocation URLs that contain additional parameters; for example "
                    },
                    {
                      "type": "codeVoice",
                      "code": "https://example.com/location1"
                    },
                    {
                      "type": "text",
                      "text": ", "
                    },
                    {
                      "type": "codeVoice",
                      "code": "https://example.com/location2"
                    },
                    {
                      "type": "text",
                      "text": ", and so on."
                    }
                  ]
                }
              ]
            },
            {
              "content": [
                {
                  "type": "paragraph",
                  "inlineContent": [
                    {
                      "type": "text",
                      "text": "On launch, respond to the URLs by persisting any unsaved data in case the user switches from one location to another and update the user interface to match the new location."
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "Invocations from the Maps app and location-based suggestions from Siri Suggestions use the URL you register for an App Clip experience as the invocation URL. When users launch your App Clip from a shared link in the messages app or your website, the site’s URL is the App Clip’s invocation URL. "
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "If you configure a generic URL both your App Clip and your full app must always be able to handle the URL, even if you intend to only use it as a prefix for your actual invocation URLs. For example, you might register "
            },
            {
              "type": "codeVoice",
              "code": "https://example.com/"
            },
            {
              "type": "text",
              "text": " as part of an advanced App Store experience. For invocations, you might use a URL like "
            },
            {
              "type": "codeVoice",
              "code": "https://example.com/menu/lunch/item/1234"
            },
            {
              "type": "text",
              "text": " or "
            },
            {
              "type": "codeVoice",
              "code": "https://example.com/menu/lunch/item/5678"
            },
            {
              "type": "text",
              "text": ". However, your App Clip and full app must also be able to handle "
            },
            {
              "type": "codeVoice",
              "code": "https://example.com"
            },
            {
              "type": "text",
              "text": "."
            }
          ]
        },
        {
          "level": 3,
          "type": "heading",
          "text": "Access the Invocation URL",
          "anchor": "3599725"
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "When users launch an App Clip, it receives an "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/foundation/nsuseractivity"
            },
            {
              "type": "text",
              "text": " object you can use to respond to the invocation. "
            }
          ]
        },
        {
          "type": "aside",
          "content": [
            {
              "type": "paragraph",
              "inlineContent": [
                {
                  "type": "text",
                  "text": "When users install an App Clip’s corresponding app, the full app replaces the App Clip. Every invocation from that point on launches the full app instead of the App Clip. Therefore, your full app must also handle all invocations and include the App Clip’s functionality."
                }
              ]
            }
          ],
          "style": "important"
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "To persist any state and data, and to access the "
            },
            {
              "type": "codeVoice",
              "code": "NSUserActivity"
            },
            {
              "type": "text",
              "text": " object on launch:"
            }
          ]
        },
        {
          "type": "unorderedList",
          "items": [
            {
              "content": [
                {
                  "type": "paragraph",
                  "inlineContent": [
                    {
                      "type": "text",
                      "text": "For a SwiftUI-based App Clip and full app, implement SwiftUI’s life-cycle callbacks; for example, use the "
                    },
                    {
                      "type": "reference",
                      "isActive": true,
                      "identifier": "doc://com.apple.documentation/documentation/swiftui/view/oncontinueuseractivity(_:perform:)"
                    },
                    {
                      "type": "text",
                      "text": " modifier."
                    }
                  ]
                }
              ]
            },
            {
              "content": [
                {
                  "type": "paragraph",
                  "inlineContent": [
                    {
                      "type": "text",
                      "text": "For a UIKit-based App Clip and full app that support scene-based app life-cycle events, implement the callbacks defined in "
                    },
                    {
                      "type": "reference",
                      "isActive": true,
                      "identifier": "doc://com.apple.documentation/documentation/uikit/uiscenedelegate"
                    },
                    {
                      "type": "text",
                      "text": ". For example, implement "
                    },
                    {
                      "type": "reference",
                      "isActive": true,
                      "identifier": "doc://com.apple.documentation/documentation/uikit/uiscenedelegate/3238056-scene"
                    },
                    {
                      "type": "text",
                      "text": " callback to access the user activity object."
                    }
                  ]
                }
              ]
            },
            {
              "content": [
                {
                  "type": "paragraph",
                  "inlineContent": [
                    {
                      "type": "text",
                      "text": "For a UIKit-based App Clip and full app that respond to app-based life-cycle events, implement the callbacks defined in "
                    },
                    {
                      "type": "reference",
                      "isActive": true,
                      "identifier": "doc://com.apple.documentation/documentation/uikit/uiapplicationdelegate"
                    },
                    {
                      "type": "text",
                      "text": ". Be sure to implement the "
                    },
                    {
                      "type": "reference",
                      "isActive": true,
                      "identifier": "doc://com.apple.documentation/documentation/uikit/uiapplicationdelegate/1623072-application"
                    },
                    {
                      "type": "text",
                      "text": " callback, because you don’t have access to the "
                    },
                    {
                      "type": "reference",
                      "isActive": true,
                      "identifier": "doc://com.apple.documentation/documentation/foundation/nsuseractivity"
                    },
                    {
                      "type": "text",
                      "text": " object in "
                    },
                    {
                      "type": "reference",
                      "isActive": true,
                      "identifier": "doc://com.apple.documentation/documentation/uikit/uiapplicationdelegate/1622921-application"
                    },
                    {
                      "type": "text",
                      "text": "."
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "On launch, make sure that the invocation is of type "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/foundation/nsuseractivitytypebrowsingweb"
            },
            {
              "type": "text",
              "text": ", then access the URL that launched the App Clip. The following code shows a function that extracts components from the invocation URL:"
            }
          ]
        },
        {
          "type": "codeListing",
          "code": [
            "func respondTo(_ activity: NSUserActivity?) {",
            "        ",
            "    // Guard against faulty data.",
            "    guard activity != nil else { return }",
            "    guard activity!.activityType == NSUserActivityTypeBrowsingWeb else { return }",
            "    guard let incomingURL = activity?.webpageURL else { return }",
            "    guard let components = NSURLComponents(url: incomingURL, resolvingAgainstBaseURL: true) else { return }",
            "",
            "    // Update the user interface based on URL components passed to the App Clip or full app.",
            "}"
          ],
          "syntax": "swift",
          "metadata": {
            "anchor": "3604123",
            "title": "Listing 1"
          }
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "For more information about responding to life-cycle events, see "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/uikit/app_and_environment/managing_your_app_s_life_cycle"
            },
            {
              "type": "text",
              "text": "."
            }
          ]
        }
      ]
    }
  ],
  "legalNotices": {
    "copyright": "Copyright &copy; 2020 Apple Inc. All rights reserved.",
    "termsOfUse": "https://www.apple.com/legal/internet-services/terms/site.html",
    "privacyPolicy": "https://www.apple.com/privacy/privacy-policy"
  }
}