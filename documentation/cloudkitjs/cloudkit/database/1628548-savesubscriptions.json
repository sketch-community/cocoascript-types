{
  "abstract": [
    {
      "type": "text",
      "text": "Saves one or more subscriptions to record changes."
    }
  ],
  "documentVersion": 0,
  "hierarchy": {
    "paths": [
      [
        "doc://com.apple.documentation/documentation/technologies",
        "doc://com.apple.documentation/documentation/cloudkitjs",
        "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/database"
      ],
      [
        "doc://com.apple.documentation/documentation/technologies",
        "doc://com.apple.documentation/documentation/cloudkitjs",
        "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit",
        "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/database"
      ]
    ]
  },
  "identifier": {
    "url": "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/database/1628548-savesubscriptions",
    "interfaceLanguage": "data"
  },
  "legacy_identifier": 1628548,
  "kind": "symbol",
  "metadata": {
    "title": "saveSubscriptions",
    "role": "symbol",
    "roleHeading": "Instance Method",
    "modules": [
      {
        "name": "CloudKit JS"
      }
    ],
    "platforms": [
      {
        "name": "CloudKit JS",
        "introducedAt": "1.1",
        "current": "2.0.1"
      }
    ],
    "externalID": "instm/CloudKit.Database/saveSubscriptions",
    "parent": {
      "title": "CloudKit.Database"
    },
    "symbolKind": "instm"
  },
  "schemaVersion": {
    "major": 0,
    "minor": 1,
    "patch": 0
  },
  "sections": [],
  "variants": [
    {
      "traits": [
        {
          "interfaceLanguage": "data"
        }
      ],
      "paths": [
        "documentation/cloudkitjs/cloudkit/database/1628548-savesubscriptions"
      ]
    }
  ],
  "references": {
    "doc://com.apple.documentation/documentation/cloudkitjs": {
      "title": "CloudKit JS",
      "identifier": "doc://com.apple.documentation/documentation/cloudkitjs",
      "url": "/documentation/cloudkitjs",
      "type": "topic",
      "kind": "symbol",
      "role": "collection"
    },
    "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/database": {
      "title": "CloudKit.Database",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/database",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/cloudkitjs/cloudkit/database"
    },
    "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit": {
      "title": "CloudKit",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/cloudkitjs/cloudkit"
    },
    "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/subscriptionsresponse": {
      "title": "CloudKit.SubscriptionsResponse",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/subscriptionsresponse",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/cloudkitjs/cloudkit/subscriptionsresponse"
    },
    "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/ckerror": {
      "title": "CloudKit.CKError",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/ckerror",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/cloudkitjs/cloudkit/ckerror"
    },
    "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/database/1628548-savesubscriptions#2556261": {
      "title": "Table 1",
      "type": "section",
      "identifier": "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/database/1628548-savesubscriptions#2556261",
      "kind": "article",
      "role": "table",
      "url": "/documentation/cloudkitjs/cloudkit/database/1628548-savesubscriptions#2556261"
    },
    "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/subscription": {
      "title": "CloudKit.Subscription",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/subscription",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/cloudkitjs/cloudkit/subscription"
    },
    "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/database/1628548-savesubscriptions#2556263": {
      "title": "Listing 1",
      "type": "section",
      "identifier": "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/database/1628548-savesubscriptions#2556263",
      "kind": "article",
      "role": "codeListing",
      "url": "/documentation/cloudkitjs/cloudkit/database/1628548-savesubscriptions#2556263"
    },
    "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/database/1628548-savesubscriptions": {
      "title": "saveSubscriptions",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/database/1628548-savesubscriptions",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/cloudkitjs/cloudkit/database/1628548-savesubscriptions",
      "abstract": [
        {
          "type": "text",
          "text": "Saves one or more subscriptions to record changes."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/database/1628548-savesubscriptions#2556265": {
      "title": "Listing 2",
      "type": "section",
      "identifier": "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/database/1628548-savesubscriptions#2556265",
      "kind": "article",
      "role": "codeListing",
      "url": "/documentation/cloudkitjs/cloudkit/database/1628548-savesubscriptions#2556265"
    },
    "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/subscriptionsresponse/1628522-subscriptions": {
      "title": "subscriptions",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/subscriptionsresponse/1628522-subscriptions",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/cloudkitjs/cloudkit/subscriptionsresponse/1628522-subscriptions"
    },
    "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/database/1628548-savesubscriptions#2556267": {
      "title": "Listing 3",
      "type": "section",
      "identifier": "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/database/1628548-savesubscriptions#2556267",
      "kind": "article",
      "role": "codeListing",
      "url": "/documentation/cloudkitjs/cloudkit/database/1628548-savesubscriptions#2556267"
    },
    "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/database/1628548-savesubscriptions#2556268": {
      "title": "Listing 4",
      "type": "section",
      "identifier": "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/database/1628548-savesubscriptions#2556268",
      "kind": "article",
      "role": "codeListing",
      "url": "/documentation/cloudkitjs/cloudkit/database/1628548-savesubscriptions#2556268"
    },
    "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/database/1628548-savesubscriptions#2556270": {
      "title": "Listing 5",
      "type": "section",
      "identifier": "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/database/1628548-savesubscriptions#2556270",
      "kind": "article",
      "role": "codeListing",
      "url": "/documentation/cloudkitjs/cloudkit/database/1628548-savesubscriptions#2556270"
    },
    "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/container/1628612-addnotificationlistener": {
      "title": "addNotificationListener",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/container/1628612-addnotificationlistener",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/cloudkitjs/cloudkit/container/1628612-addnotificationlistener"
    },
    "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/container": {
      "title": "CloudKit.Container",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/container",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/cloudkitjs/cloudkit/container"
    },
    "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/database/1628548-savesubscriptions#2556272": {
      "title": "Listing 6",
      "type": "section",
      "identifier": "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/database/1628548-savesubscriptions#2556272",
      "kind": "article",
      "role": "codeListing",
      "url": "/documentation/cloudkitjs/cloudkit/database/1628548-savesubscriptions#2556272"
    },
    "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/notification": {
      "title": "CloudKit.Notification",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/notification",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/cloudkitjs/cloudkit/notification"
    },
    "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/container/1628672-registerfornotifications": {
      "title": "registerForNotifications",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/container/1628672-registerfornotifications",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/cloudkitjs/cloudkit/container/1628672-registerfornotifications"
    },
    "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/database/1628548-savesubscriptions#2556274": {
      "title": "Listing 7",
      "type": "section",
      "identifier": "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/database/1628548-savesubscriptions#2556274",
      "kind": "article",
      "role": "codeListing",
      "url": "/documentation/cloudkitjs/cloudkit/database/1628548-savesubscriptions#2556274"
    },
    "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/database/1628609-fetchsubscriptions": {
      "title": "fetchSubscriptions",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/database/1628609-fetchsubscriptions",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/cloudkitjs/cloudkit/database/1628609-fetchsubscriptions",
      "abstract": [
        {
          "type": "text",
          "text": "Fetches one or more subscriptions."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/database/1628551-fetchallsubscriptions": {
      "title": "fetchAllSubscriptions",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/database/1628551-fetchallsubscriptions",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/cloudkitjs/cloudkit/database/1628551-fetchallsubscriptions",
      "abstract": [
        {
          "type": "text",
          "text": "Fetches all subscriptions in the schema."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/database/1628653-deletesubscriptions": {
      "title": "deleteSubscriptions",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/database/1628653-deletesubscriptions",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/cloudkitjs/cloudkit/database/1628653-deletesubscriptions",
      "abstract": [
        {
          "type": "text",
          "text": "Deletes one or more subscriptions."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/technologies": {
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/technologies",
      "url": "/documentation/technologies",
      "kind": "technologies",
      "title": "Technologies"
    }
  },
  "seeAlsoSections": [
    {
      "identifiers": [
        "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/database/1628609-fetchsubscriptions",
        "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/database/1628551-fetchallsubscriptions",
        "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/database/1628653-deletesubscriptions"
      ],
      "title": "Subscribing to Changes",
      "generated": true
    }
  ],
  "primaryContentSections": [
    {
      "kind": "declarations",
      "declarations": [
        {
          "languages": [
            "data"
          ],
          "tokens": [
            {
              "kind": "keyword",
              "text": "Promise"
            },
            {
              "kind": "text",
              "text": "<"
            },
            {
              "kind": "typeIdentifier",
              "preciseIdentifier": "cl/CloudKit",
              "identifier": "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit",
              "text": "CloudKit"
            },
            {
              "kind": "text",
              "text": "."
            },
            {
              "kind": "typeIdentifier",
              "text": "SubscriptionsResponse"
            },
            {
              "kind": "text",
              "text": ", "
            },
            {
              "kind": "typeIdentifier",
              "preciseIdentifier": "cl/CloudKit",
              "identifier": "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit",
              "text": "CloudKit"
            },
            {
              "kind": "text",
              "text": "."
            },
            {
              "kind": "typeIdentifier",
              "text": "CKError"
            },
            {
              "kind": "text",
              "text": ">"
            },
            {
              "kind": "text",
              "text": " "
            },
            {
              "kind": "identifier",
              "text": "saveSubscriptions"
            },
            {
              "kind": "text",
              "text": "("
            },
            {
              "kind": "typeIdentifier",
              "preciseIdentifier": "cl/CloudKit",
              "identifier": "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit",
              "text": "CloudKit"
            },
            {
              "kind": "text",
              "text": "."
            },
            {
              "kind": "typeIdentifier",
              "text": "Subscription"
            },
            {
              "kind": "text",
              "text": "|"
            },
            {
              "kind": "typeIdentifier",
              "preciseIdentifier": "cl/CloudKit",
              "identifier": "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit",
              "text": "CloudKit"
            },
            {
              "kind": "text",
              "text": "."
            },
            {
              "kind": "typeIdentifier",
              "text": "Subscription"
            },
            {
              "kind": "text",
              "text": "[]"
            },
            {
              "kind": "text",
              "text": " "
            },
            {
              "kind": "internalParam",
              "text": "subscriptions"
            },
            {
              "kind": "text",
              "text": ");"
            }
          ],
          "platforms": [
            "CloudKit JS"
          ]
        }
      ]
    },
    {
      "kind": "parameters",
      "languages": [
        "data"
      ],
      "parameters": [
        {
          "name": "subscriptions",
          "content": [
            {
              "type": "paragraph",
              "inlineContent": [
                {
                  "type": "text",
                  "text": "Possible values are:"
                }
              ]
            },
            {
              "type": "table",
              "header": "row",
              "rows": [
                [
                  [
                    {
                      "type": "paragraph",
                      "inlineContent": [
                        {
                          "type": "text",
                          "text": "Type"
                        }
                      ]
                    }
                  ],
                  [
                    {
                      "type": "paragraph",
                      "inlineContent": [
                        {
                          "type": "text",
                          "text": "Description"
                        }
                      ]
                    }
                  ]
                ],
                [
                  [
                    {
                      "type": "paragraph",
                      "inlineContent": [
                        {
                          "type": "reference",
                          "isActive": true,
                          "identifier": "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/subscription"
                        }
                      ]
                    }
                  ],
                  [
                    {
                      "type": "paragraph",
                      "inlineContent": [
                        {
                          "type": "text",
                          "text": "A subscription in the database to save."
                        }
                      ]
                    }
                  ]
                ],
                [
                  [
                    {
                      "type": "paragraph",
                      "inlineContent": [
                        {
                          "type": "codeVoice",
                          "code": "CloudKit.Subscription[]"
                        }
                      ]
                    }
                  ],
                  [
                    {
                      "type": "paragraph",
                      "inlineContent": [
                        {
                          "type": "text",
                          "text": "An array of subscriptions to save."
                        }
                      ]
                    }
                  ]
                ]
              ],
              "metadata": {
                "anchor": "2556261",
                "title": "Table 1"
              }
            }
          ]
        }
      ]
    },
    {
      "kind": "content",
      "content": [
        {
          "anchor": "return_value",
          "level": 2,
          "text": "Return Value",
          "type": "heading"
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "A "
            },
            {
              "type": "codeVoice",
              "code": "Promise"
            },
            {
              "type": "text",
              "text": " object that resolves to a "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/subscriptionsresponse"
            },
            {
              "type": "text",
              "text": " object if the operation succeeds; otherwise, a "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/ckerror"
            },
            {
              "type": "text",
              "text": " object."
            }
          ]
        }
      ]
    },
    {
      "kind": "content",
      "content": [
        {
          "anchor": "discussion",
          "level": 2,
          "text": "Discussion",
          "type": "heading"
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "Instead of fetching records, you can subscribe to changes, and let the server run the query in the background. You subscribe to changes by creating a subscription, represented by a "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/subscription"
            },
            {
              "type": "text",
              "text": " dictionary, and saving it to a database. Then you register for push notifications and handle them when they arrive."
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "inlineHead",
              "inlineContent": [
                {
                  "type": "text",
                  "text": "Subscribing to Zone Changes"
                }
              ]
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "To subscribe to all changes in a zone, set the "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/subscription"
            },
            {
              "type": "text",
              "text": " dictionary’s "
            },
            {
              "type": "codeVoice",
              "code": "subscriptionType"
            },
            {
              "type": "text",
              "text": " key to "
            },
            {
              "type": "codeVoice",
              "code": "zone"
            },
            {
              "type": "text",
              "text": " and set the "
            },
            {
              "type": "codeVoice",
              "code": "zoneID"
            },
            {
              "type": "text",
              "text": " key to the name of the zone you want to observe. "
            }
          ]
        },
        {
          "type": "codeListing",
          "code": [
            "var zoneSubscription = {",
            "    subscriptionType: 'zone',",
            "    subscriptionID: 'changedArtwork',",
            "    zoneID: { zoneName: 'publicArtwork' }",
            "};"
          ],
          "syntax": "javascript",
          "metadata": {
            "anchor": "2556263",
            "title": "Listing 1"
          }
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "Save the subscription using the "
            },
            {
              "type": "reference",
              "isActive": false,
              "identifier": "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/database/1628548-savesubscriptions"
            },
            {
              "type": "text",
              "text": " method. "
            }
          ]
        },
        {
          "type": "codeListing",
          "code": [
            "database.saveSubscriptions(zoneSubscription).then(function(response) {",
            "    if (response.hasErrors) {",
            "        // Insert error handling",
            "        throw response.errors[0];",
            "    } else {",
            "        // Successfully saved subscription",
            "    }",
            "});"
          ],
          "syntax": "javascript",
          "metadata": {
            "anchor": "2556265",
            "title": "Listing 2"
          }
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "To get the saved subscription, use the "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/subscriptionsresponse/1628522-subscriptions"
            },
            {
              "type": "text",
              "text": " property in the "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/subscriptionsresponse"
            },
            {
              "type": "text",
              "text": " class."
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "inlineHead",
              "inlineContent": [
                {
                  "type": "text",
                  "text": "Subscribing to Record Changes Using a Query"
                }
              ]
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "Create a query subscription object (a "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/subscription"
            },
            {
              "type": "text",
              "text": " dictionary with the "
            },
            {
              "type": "codeVoice",
              "code": "subscriptionType"
            },
            {
              "type": "text",
              "text": " key set to "
            },
            {
              "type": "codeVoice",
              "code": "query"
            },
            {
              "type": "text",
              "text": ") specifying the record type, matching criteria, and types of changes you want to be notified about. Then save the query subscription object to the database."
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "For example, subscribe to receive new artwork from an artist where the "
            },
            {
              "type": "codeVoice",
              "code": "artist"
            },
            {
              "type": "text",
              "text": " field in the "
            },
            {
              "type": "codeVoice",
              "code": "Artwork"
            },
            {
              "type": "text",
              "text": " record type is a "
            },
            {
              "type": "codeVoice",
              "code": "Reference"
            },
            {
              "type": "text",
              "text": " type. First create a reference to the "
            },
            {
              "type": "codeVoice",
              "code": "Artist"
            },
            {
              "type": "text",
              "text": " record to use in the query."
            }
          ]
        },
        {
          "type": "codeListing",
          "code": [
            "var artistReference = {",
            "    action: 'NONE',",
            "    recordName: 'Mei Chen'",
            "}"
          ],
          "syntax": "javascript",
          "metadata": {
            "anchor": "2556267",
            "title": "Listing 3"
          }
        },
        {
          "type": "aside",
          "content": [
            {
              "type": "paragraph",
              "inlineContent": [
                {
                  "type": "text",
                  "text": "Because the record name is a unique identifier, you can create the "
                },
                {
                  "type": "codeVoice",
                  "code": "Reference"
                },
                {
                  "type": "text",
                  "text": " object containing just the "
                },
                {
                  "type": "codeVoice",
                  "code": "recordName"
                },
                {
                  "type": "text",
                  "text": " and "
                },
                {
                  "type": "codeVoice",
                  "code": "action"
                },
                {
                  "type": "text",
                  "text": " key. A query subscription with a "
                },
                {
                  "type": "codeVoice",
                  "code": "Reference"
                },
                {
                  "type": "text",
                  "text": " field requires an "
                },
                {
                  "type": "codeVoice",
                  "code": "action"
                },
                {
                  "type": "text",
                  "text": " key."
                }
              ]
            }
          ],
          "style": "note",
          "name": "Note"
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "Create a query subscription object specifying "
            },
            {
              "type": "codeVoice",
              "code": "Artwork"
            },
            {
              "type": "text",
              "text": " records whose "
            },
            {
              "type": "codeVoice",
              "code": "artist"
            },
            {
              "type": "text",
              "text": " field matches the "
            },
            {
              "type": "codeVoice",
              "code": "Reference"
            },
            {
              "type": "text",
              "text": " object. Use the "
            },
            {
              "type": "codeVoice",
              "code": "firesOn"
            },
            {
              "type": "text",
              "text": " key to specify the types of operations that fire this subscription."
            }
          ]
        },
        {
          "type": "codeListing",
          "code": [
            "var querySubscription = {",
            "    subscriptionType: 'query',",
            "    firesOn: ['create', 'update', 'delete'],",
            "    query: {",
            "        recordType: 'Artwork',",
            "        filterBy: [{",
            "           fieldName: 'artist',",
            "           comparator: 'EQUALS',",
            "           fieldValue: { value: artistReference }",
            "        }]",
            "    }",
            "};"
          ],
          "syntax": "javascript",
          "metadata": {
            "anchor": "2556268",
            "title": "Listing 4"
          }
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "Save the subscription using the "
            },
            {
              "type": "reference",
              "isActive": false,
              "identifier": "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/database/1628548-savesubscriptions"
            },
            {
              "type": "text",
              "text": " method and get the saved subscription using the "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/subscriptionsresponse/1628522-subscriptions"
            },
            {
              "type": "text",
              "text": " property in the "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/subscriptionsresponse"
            },
            {
              "type": "text",
              "text": " class."
            }
          ]
        },
        {
          "type": "codeListing",
          "code": [
            "database.saveSubscriptions(querySubscription).then(function(response) {",
            "    if (response.hasErrors) {",
            "        // Insert error handling",
            "        throw response.errors[0];",
            "    } else {",
            "        // Successfully saved subscription",
            "    }",
            "});"
          ],
          "syntax": "javascript",
          "metadata": {
            "anchor": "2556270",
            "title": "Listing 5"
          }
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "inlineHead",
              "inlineContent": [
                {
                  "type": "text",
                  "text": "Handling Subscription Push Notifications"
                }
              ]
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "Add a notification listener to the app’s container using the "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/container/1628612-addnotificationlistener"
            },
            {
              "type": "text",
              "text": " method in the "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/container"
            },
            {
              "type": "text",
              "text": " class and implement the listener to handle the push notifications."
            }
          ]
        },
        {
          "type": "codeListing",
          "code": [
            "myContainer.addNotificationListener(function(notification) {",
            "    console.log(notification);",
            "});"
          ],
          "syntax": "javascript",
          "metadata": {
            "anchor": "2556272",
            "title": "Listing 6"
          }
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "For details on the "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/notification"
            },
            {
              "type": "text",
              "text": " object passed to the listener, read "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/notification"
            },
            {
              "type": "text",
              "text": "."
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "inlineHead",
              "inlineContent": [
                {
                  "type": "text",
                  "text": "Registering for Subscription Push Notifications"
                }
              ]
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "Saving subscriptions to the database doesn’t automatically configure your web app to receive notifications when a subscription fires. CloudKit uses the Apple Push Notification service (APNs) to send notifications, so your web app needs to register for push notifications to receive them."
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "To receive push notifications when a subscription fires, use the "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/container/1628672-registerfornotifications"
            },
            {
              "type": "text",
              "text": " method in the "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/cloudkitjs/cloudkit/container"
            },
            {
              "type": "text",
              "text": " class."
            }
          ]
        },
        {
          "type": "codeListing",
          "code": [
            "var myContainer = CloudKit.getDefaultContainer();",
            "myContainer.registerForNotifications();"
          ],
          "syntax": "javascript",
          "metadata": {
            "anchor": "2556274",
            "title": "Listing 7"
          }
        }
      ]
    }
  ],
  "legalNotices": {
    "copyright": "Copyright &copy; 2021 Apple Inc. All rights reserved.",
    "termsOfUse": "https://www.apple.com/legal/internet-services/terms/site.html",
    "privacyPolicy": "https://www.apple.com/privacy/privacy-policy"
  }
}