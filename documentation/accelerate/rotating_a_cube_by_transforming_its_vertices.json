{
  "abstract": [
    {
      "type": "text",
      "text": "Rotate a cube through a series of keyframes using quaternion interpolation to transition between them."
    }
  ],
  "documentVersion": 0,
  "hierarchy": {
    "paths": [
      [
        "doc://com.apple.documentation/documentation/technologies",
        "doc://com.apple.documentation/documentation/accelerate"
      ],
      [
        "doc://com.apple.documentation/documentation/technologies",
        "doc://com.apple.documentation/documentation/accelerate",
        "doc://com.apple.documentation/documentation/accelerate/simd"
      ]
    ]
  },
  "identifier": {
    "url": "doc://com.apple.documentation/documentation/accelerate/rotating_a_cube_by_transforming_its_vertices",
    "interfaceLanguage": "occ"
  },
  "legacy_identifier": 2983561,
  "kind": "article",
  "metadata": {
    "title": "Rotating a Cube by Transforming Its Vertices",
    "role": "sampleCode",
    "roleHeading": "Sample Code",
    "modules": [
      {
        "name": "Accelerate"
      }
    ],
    "platforms": [
      {
        "name": "iOS",
        "introducedAt": "11.3",
        "current": "14.3"
      },
      {
        "name": "Xcode",
        "introducedAt": "11.0",
        "current": "12.3"
      }
    ]
  },
  "schemaVersion": {
    "major": 1,
    "minor": 0,
    "patch": 0
  },
  "sections": [],
  "variants": [
    {
      "traits": [
        {
          "interfaceLanguage": "occ"
        }
      ],
      "paths": [
        "documentation/accelerate/rotating_a_cube_by_transforming_its_vertices",
        "documentation/accelerate/simd/rotating_a_cube_by_transforming_its_vertices"
      ]
    },
    {
      "traits": [
        {
          "interfaceLanguage": "swift"
        }
      ],
      "paths": [
        "documentation/accelerate/rotating_a_cube_by_transforming_its_vertices",
        "documentation/accelerate/simd/rotating_a_cube_by_transforming_its_vertices"
      ]
    }
  ],
  "references": {
    "doc://com.apple.documentation/documentation/accelerate": {
      "title": "Accelerate",
      "identifier": "doc://com.apple.documentation/documentation/accelerate",
      "url": "/documentation/accelerate",
      "type": "topic",
      "kind": "symbol",
      "role": "collection"
    },
    "doc://com.apple.documentation/documentation/accelerate/simd": {
      "title": "simd",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/accelerate/simd",
      "kind": "article",
      "role": "collectionGroup",
      "url": "/documentation/accelerate/simd",
      "abstract": [
        {
          "type": "text",
          "text": "Perform computations on small vectors and matrices."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/simd/simd_float3": {
      "title": "simd_float3",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/simd/simd_float3",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/simd/simd_float3"
    },
    "doc://com.apple.documentation/documentation/accelerate/rotating_a_cube_by_transforming_its_vertices#3282766": {
      "title": "Listing 1",
      "type": "section",
      "identifier": "doc://com.apple.documentation/documentation/accelerate/rotating_a_cube_by_transforming_its_vertices#3282766",
      "kind": "article",
      "role": "codeListing",
      "url": "/documentation/accelerate/rotating_a_cube_by_transforming_its_vertices#3282766"
    },
    "doc://com.apple.documentation/documentation/accelerate/rotating_a_cube_by_transforming_its_vertices#3282767": {
      "title": "Listing 2",
      "type": "section",
      "identifier": "doc://com.apple.documentation/documentation/accelerate/rotating_a_cube_by_transforming_its_vertices#3282767",
      "kind": "article",
      "role": "codeListing",
      "url": "/documentation/accelerate/rotating_a_cube_by_transforming_its_vertices#3282767"
    },
    "link-3009146": {
      "title": "SceneKit",
      "type": "topic",
      "identifier": "link-3009146",
      "kind": "article",
      "role": "link",
      "url": "https://developer.apple.com/scenekit/"
    },
    "link-3009147": {
      "title": "Metal",
      "type": "topic",
      "identifier": "link-3009147",
      "kind": "article",
      "role": "link",
      "url": "https://developer.apple.com/metal/"
    },
    "link-media-3282765": {
      "identifier": "link-media-3282765",
      "type": "link",
      "title": "Figure 1",
      "url": "/documentation/accelerate/rotating_a_cube_by_transforming_its_vertices#3282765"
    },
    "media-3282765": {
      "identifier": "media-3282765",
      "type": "image",
      "variants": [
        {
          "traits": [
            "2x"
          ],
          "size": {
            "width": 268,
            "height": 250
          },
          "url": "https://docs-assets.developer.apple.com/published/c6b83ff3b2/bffe61dc-842d-4aa5-8555-8a1917da6fb2.png"
        }
      ],
      "alt": "Image of cube.",
      "title": "Figure 1"
    },
    "doc://com.apple.documentation/documentation/accelerate/working_with_quaternions": {
      "title": "Working with Quaternions",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/accelerate/working_with_quaternions",
      "kind": "article",
      "role": "article",
      "url": "/documentation/accelerate/working_with_quaternions",
      "abstract": [
        {
          "type": "text",
          "text": "Rotate points around the surface of a sphere, and interpolate between them."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/accelerate/rotating_a_cube_by_transforming_its_vertices#3282769": {
      "title": "Listing 3",
      "type": "section",
      "identifier": "doc://com.apple.documentation/documentation/accelerate/rotating_a_cube_by_transforming_its_vertices#3282769",
      "kind": "article",
      "role": "codeListing",
      "url": "/documentation/accelerate/rotating_a_cube_by_transforming_its_vertices#3282769"
    },
    "doc://com.apple.documentation/documentation/quartzcore/cadisplaylink": {
      "title": "CADisplayLink",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/quartzcore/cadisplaylink",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/quartzcore/cadisplaylink"
    },
    "doc://com.apple.documentation/documentation/accelerate/rotating_a_cube_by_transforming_its_vertices#3282772": {
      "title": "Listing 4",
      "type": "section",
      "identifier": "doc://com.apple.documentation/documentation/accelerate/rotating_a_cube_by_transforming_its_vertices#3282772",
      "kind": "article",
      "role": "codeListing",
      "url": "/documentation/accelerate/rotating_a_cube_by_transforming_its_vertices#3282772"
    },
    "doc://com.apple.documentation/documentation/accelerate/rotating_a_cube_by_transforming_its_vertices#3282773": {
      "title": "Listing 5",
      "type": "section",
      "identifier": "doc://com.apple.documentation/documentation/accelerate/rotating_a_cube_by_transforming_its_vertices#3282773",
      "kind": "article",
      "role": "codeListing",
      "url": "/documentation/accelerate/rotating_a_cube_by_transforming_its_vertices#3282773"
    },
    "doc://com.apple.documentation/documentation/accelerate/rotating_a_cube_by_transforming_its_vertices#3282774": {
      "title": "Listing 6",
      "type": "section",
      "identifier": "doc://com.apple.documentation/documentation/accelerate/rotating_a_cube_by_transforming_its_vertices#3282774",
      "kind": "article",
      "role": "codeListing",
      "url": "/documentation/accelerate/rotating_a_cube_by_transforming_its_vertices#3282774"
    },
    "doc://com.apple.documentation/documentation/accelerate/rotating_a_cube_by_transforming_its_vertices#3282775": {
      "title": "Listing 7",
      "type": "section",
      "identifier": "doc://com.apple.documentation/documentation/accelerate/rotating_a_cube_by_transforming_its_vertices#3282775",
      "kind": "article",
      "role": "codeListing",
      "url": "/documentation/accelerate/rotating_a_cube_by_transforming_its_vertices#3282775"
    },
    "doc://com.apple.documentation/documentation/accelerate/rotating_a_cube_by_transforming_its_vertices#3282776": {
      "title": "Listing 8",
      "type": "section",
      "identifier": "doc://com.apple.documentation/documentation/accelerate/rotating_a_cube_by_transforming_its_vertices#3282776",
      "kind": "article",
      "role": "codeListing",
      "url": "/documentation/accelerate/rotating_a_cube_by_transforming_its_vertices#3282776"
    },
    "doc://com.apple.documentation/documentation/accelerate/rotating_a_cube_by_transforming_its_vertices#3282777": {
      "title": "Listing 9",
      "type": "section",
      "identifier": "doc://com.apple.documentation/documentation/accelerate/rotating_a_cube_by_transforming_its_vertices#3282777",
      "kind": "article",
      "role": "codeListing",
      "url": "/documentation/accelerate/rotating_a_cube_by_transforming_its_vertices#3282777"
    },
    "link-media-3282771": {
      "identifier": "link-media-3282771",
      "type": "link",
      "title": "Figure 2",
      "url": "/documentation/accelerate/rotating_a_cube_by_transforming_its_vertices#3282771"
    },
    "media-3282771": {
      "identifier": "media-3282771",
      "type": "image",
      "variants": [
        {
          "traits": [
            "2x"
          ],
          "size": {
            "width": 365,
            "height": 266
          },
          "url": "https://docs-assets.developer.apple.com/published/b686bac7c2/ddf3d8fd-3e8b-4e7f-a77c-0047de76dc58.png"
        }
      ],
      "alt": "Image of cube with the path of one of its vertices rendered as a line after a series of spherical interpolated rotations.",
      "title": "Figure 2"
    },
    "doc://com.apple.documentation/documentation/accelerate/rotating_a_cube_by_transforming_its_vertices#3282780": {
      "title": "Listing 10",
      "type": "section",
      "identifier": "doc://com.apple.documentation/documentation/accelerate/rotating_a_cube_by_transforming_its_vertices#3282780",
      "kind": "article",
      "role": "codeListing",
      "url": "/documentation/accelerate/rotating_a_cube_by_transforming_its_vertices#3282780"
    },
    "link-media-3282779": {
      "identifier": "link-media-3282779",
      "type": "link",
      "title": "Figure 3",
      "url": "/documentation/accelerate/rotating_a_cube_by_transforming_its_vertices#3282779"
    },
    "media-3282779": {
      "identifier": "media-3282779",
      "type": "image",
      "variants": [
        {
          "traits": [
            "2x"
          ],
          "size": {
            "width": 367,
            "height": 271
          },
          "url": "https://docs-assets.developer.apple.com/published/955d74894d/410705f6-5331-4da8-8d98-6e89d880d40b.png"
        }
      ],
      "alt": "Image of cube with the path of one of its vertices rendered as a line after a series of spline interpolated rotations.",
      "title": "Figure 3"
    },
    "doc://com.apple.documentation/documentation/simd/2867359-simd_slerp": {
      "title": "simd_slerp",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/simd/2867359-simd_slerp",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/simd/2867359-simd_slerp"
    },
    "doc://com.apple.documentation/documentation/simd/2867378-simd_spline": {
      "title": "simd_spline",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/simd/2867378-simd_spline",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/simd/2867378-simd_spline"
    },
    "doc://com.apple.documentation/documentation/accelerate/working_with_vectors": {
      "title": "Working with Vectors",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/accelerate/working_with_vectors",
      "kind": "article",
      "role": "article",
      "url": "/documentation/accelerate/working_with_vectors",
      "abstract": [
        {
          "type": "text",
          "text": "Use vectors to calculate geometric values, calculate dot products and cross products, and interpolate between values. "
        }
      ]
    },
    "doc://com.apple.documentation/documentation/accelerate/working_with_matrices": {
      "title": "Working with Matrices",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/accelerate/working_with_matrices",
      "kind": "article",
      "role": "article",
      "url": "/documentation/accelerate/working_with_matrices",
      "abstract": [
        {
          "type": "text",
          "text": "Solve simultaneous equations and transform points in space.  "
        }
      ]
    },
    "doc://com.apple.documentation/documentation/accelerate/rotating_a_cube_by_transforming_its_vertices": {
      "title": "Rotating a Cube by Transforming Its Vertices",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/accelerate/rotating_a_cube_by_transforming_its_vertices",
      "kind": "article",
      "role": "sampleCode",
      "url": "/documentation/accelerate/rotating_a_cube_by_transforming_its_vertices",
      "abstract": [
        {
          "type": "text",
          "text": "Rotate a cube through a series of keyframes using quaternion interpolation to transition between them."
        }
      ]
    },
    "https://docs-assets.developer.apple.com/published/8f5dcf7bbd/RotatingACubeByTransformingItsVertices.zip": {
      "type": "download",
      "identifier": "https://docs-assets.developer.apple.com/published/8f5dcf7bbd/RotatingACubeByTransformingItsVertices.zip",
      "checksum": "23bf52bbc44684fb428b8efd4e0fac3fc8631b6a566be44909d9ce7ea0e833b4ed6e47066393e8115bfeb6e6f4c3bb82ec066f2732fe7ffe5ec6e203194c9b57",
      "url": "https://docs-assets.developer.apple.com/published/8f5dcf7bbd/RotatingACubeByTransformingItsVertices.zip"
    },
    "doc://com.apple.documentation/documentation/technologies": {
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/technologies",
      "url": "/documentation/technologies",
      "kind": "technologies",
      "title": "Technologies"
    }
  },
  "sampleCodeDownload": {
    "action": {
      "overridingTitle": "Download",
      "type": "reference",
      "isActive": true,
      "identifier": "https://docs-assets.developer.apple.com/published/8f5dcf7bbd/RotatingACubeByTransformingItsVertices.zip"
    }
  },
  "seeAlsoSections": [
    {
      "identifiers": [
        "doc://com.apple.documentation/documentation/accelerate/working_with_vectors",
        "doc://com.apple.documentation/documentation/accelerate/working_with_matrices",
        "doc://com.apple.documentation/documentation/accelerate/working_with_quaternions",
        "doc://com.apple.documentation/documentation/accelerate/simd"
      ],
      "title": "Vectors, Matrices, and Quaternions",
      "generated": true
    }
  ],
  "primaryContentSections": [
    {
      "kind": "content",
      "content": [
        {
          "anchor": "overview",
          "level": 2,
          "text": "Overview",
          "type": "heading"
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "Quaternions are fundamental to 3D drawing and animation. You can rotate a 3D object in space by applying unit quaternion actions to each of its vertices. You can interpolate between a series of rotational keyframes—defined by unit quaternions—with either the "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/simd/2867359-simd_slerp"
            },
            {
              "type": "text",
              "text": " or the "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/simd/2867378-simd_spline"
            },
            {
              "type": "text",
              "text": " functions."
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "This sample shows how you can define a cube using eight vertices and transform it through a series of rotations. It shows how transitioning between the keyframes with a series of discrete spherical interpolations (that is, a series of separate arcs between each keyframe) yields a different result than transitioning with a continuous spline (that is, a single, smooth path between each keyframe)."
            }
          ]
        },
        {
          "level": 3,
          "type": "heading",
          "text": "Define a Cube by Its Vertices",
          "anchor": "3282783"
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "Define a cube with eight "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/simd/simd_float3"
            },
            {
              "type": "text",
              "text": " structures: one for each corner:"
            }
          ]
        },
        {
          "type": "codeListing",
          "code": [
            "let cubeVertexOrigins: [simd_float3] = [",
            "    simd_float3(x: -0.5, y: -0.5, z: 0.5),",
            "    simd_float3(x: 0.5, y: -0.5, z: 0.5),",
            "    simd_float3(x: -0.5, y: -0.5, z: -0.5),",
            "    simd_float3(x: 0.5, y: -0.5, z: -0.5),",
            "    simd_float3(x: -0.5, y: 0.5, z: 0.5),",
            "    simd_float3(x: 0.5, y: 0.5, z: 0.5),",
            "    simd_float3(x: -0.5, y: 0.5, z: -0.5),",
            "    simd_float3(x: 0.5, y: 0.5, z: -0.5)",
            "    ]"
          ],
          "syntax": "swift",
          "metadata": {
            "anchor": "3282766",
            "title": "Listing 1"
          }
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "The quaternions will act upon the vertex origins, mutating "
            },
            {
              "type": "codeVoice",
              "code": "cubeVertices"
            },
            {
              "type": "text",
              "text": " to rotate the cube:"
            }
          ]
        },
        {
          "type": "codeListing",
          "code": [
            "lazy var cubeVertices = cubeVertexOrigins"
          ],
          "syntax": "swift",
          "metadata": {
            "anchor": "3282767",
            "title": "Listing 2"
          }
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "This sample uses "
            },
            {
              "type": "link",
              "title": "SceneKit",
              "destination": "https://developer.apple.com/scenekit/"
            },
            {
              "type": "text",
              "text": " to render the cube defined by the vertices in the "
            },
            {
              "type": "codeVoice",
              "code": "cubeVertices"
            },
            {
              "type": "text",
              "text": " array, but you can use the technique discussed to rotate geometry in other technologies like "
            },
            {
              "type": "link",
              "title": "Metal",
              "destination": "https://developer.apple.com/metal/"
            },
            {
              "type": "text",
              "text": ". The following image shows the cube, defined by the vertices above, rendered in SceneKit:"
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "image",
              "identifier": "media-3282765",
              "metadata": {
                "anchor": "3282765",
                "title": "Figure 1"
              }
            }
          ]
        },
        {
          "level": 3,
          "type": "heading",
          "text": "Define the Quaternion Rotation Keyframes",
          "anchor": "3282784"
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "As discussed in "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/accelerate/working_with_quaternions"
            },
            {
              "type": "text",
              "text": ", spline interpolation requires a quaternion before the current value and a quaternion after the next value to compute the interpolated value. To support this, define the series of rotations with additional values at the beginning and end. In this sample, the first and last elements are duplicated:"
            }
          ]
        },
        {
          "type": "codeListing",
          "code": [
            "let vertexRotations: [simd_quatf] = [",
            "    simd_quatf(angle: 0,",
            "               axis: simd_normalize(simd_float3(x: 0, y: 0, z: 1))),",
            "    simd_quatf(angle: 0,",
            "               axis: simd_normalize(simd_float3(x: 0, y: 0, z: 1))),",
            "    simd_quatf(angle: .pi * 0.05,",
            "               axis: simd_normalize(simd_float3(x: 0, y: 1, z: 0))),",
            "    simd_quatf(angle: .pi * 0.1,",
            "               axis: simd_normalize(simd_float3(x: 1, y: 0, z: -1))),",
            "    simd_quatf(angle: .pi * 0.15,",
            "               axis: simd_normalize(simd_float3(x: 0, y: 1, z: 0))),",
            "    simd_quatf(angle: .pi * 0.2,",
            "               axis: simd_normalize(simd_float3(x: -1, y: 0, z: 1))),",
            "    simd_quatf(angle: .pi * 0.15,",
            "               axis: simd_normalize(simd_float3(x: 0, y: -1, z: 0))),",
            "    simd_quatf(angle: .pi * 0.1,",
            "               axis: simd_normalize(simd_float3(x: 1, y: 0, z: -1))),",
            "    simd_quatf(angle: .pi * 0.05,",
            "               axis: simd_normalize(simd_float3(x: 0, y: 1, z: 0))),",
            "    simd_quatf(angle: 0,",
            "               axis: simd_normalize(simd_float3(x: 0, y: 0, z: 1))),",
            "    simd_quatf(angle: 0,",
            "               axis: simd_normalize(simd_float3(x: 0, y: 0, z: 1)))",
            "]"
          ],
          "syntax": "swift",
          "metadata": {
            "anchor": "3282769",
            "title": "Listing 3"
          }
        },
        {
          "level": 3,
          "type": "heading",
          "text": "Animate Between Keyframes with Spherical Interpolation",
          "anchor": "3282785"
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "This sample uses a "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/quartzcore/cadisplaylink"
            },
            {
              "type": "text",
              "text": " instance to schedule updates to the cube’s vertices, calling the  "
            },
            {
              "type": "codeVoice",
              "code": "vertexRotationStep"
            },
            {
              "type": "text",
              "text": " function every frame:"
            }
          ]
        },
        {
          "type": "codeListing",
          "code": [
            "displaylink = CADisplayLink(target: self,",
            "                            selector: #selector(vertexRotationStep))",
            "",
            "displaylink?.add(to: .current,",
            "                 forMode: .default)"
          ],
          "syntax": "swift",
          "metadata": {
            "anchor": "3282772",
            "title": "Listing 4"
          }
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "The following variables define the current index in "
            },
            {
              "type": "codeVoice",
              "code": "vertexRotations"
            },
            {
              "type": "text",
              "text": " and the time, between zero and one, for the current interpolation:"
            }
          ]
        },
        {
          "type": "codeListing",
          "code": [
            "var vertexRotationIndex = 0",
            "var vertexRotationTime: Float = 0"
          ],
          "syntax": "swift",
          "metadata": {
            "anchor": "3282773",
            "title": "Listing 5"
          }
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "With each display link notification, inside the "
            },
            {
              "type": "codeVoice",
              "code": "vertexRotationStep"
            },
            {
              "type": "text",
              "text": " function, the vertex rotation time variable is incremented by a small amount. Changing the value of increment controls the speed of the animation:"
            }
          ]
        },
        {
          "type": "codeListing",
          "code": [
            "let increment: Float = 0.02",
            "vertexRotationTime += increment"
          ],
          "syntax": "swift",
          "metadata": {
            "anchor": "3282774",
            "title": "Listing 6"
          }
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "The "
            },
            {
              "type": "codeVoice",
              "code": "simd_slerp"
            },
            {
              "type": "text",
              "text": " function returns a quaternion that is spherically interpolated between the current and next quaternion keyframe at the specified time:"
            }
          ]
        },
        {
          "type": "codeListing",
          "code": [
            "q = simd_slerp(vertexRotations[vertexRotationIndex],",
            "               vertexRotations[vertexRotationIndex + 1],",
            "               vertexRotationTime)"
          ],
          "syntax": "swift",
          "metadata": {
            "anchor": "3282775",
            "title": "Listing 7"
          }
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "The quaternion acts upon each of the cube’s original vertices, rotating the cube around its center:"
            }
          ]
        },
        {
          "type": "codeListing",
          "code": [
            "cubeVertices = cubeVertexOrigins.map {",
            "    return q.act($0)",
            "}"
          ],
          "syntax": "swift",
          "metadata": {
            "anchor": "3282776",
            "title": "Listing 8"
          }
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "If the vertex rotation time is greater than or equal to one, you need to progress to the next keyframe: Increment the index to the rotations array and reset the rotation time to zero. Furthermore, when the code has reached the last usable quaternion in the array of rotations, end the animation by invalidating the display link:"
            }
          ]
        },
        {
          "type": "codeListing",
          "code": [
            "if vertexRotationTime >= 1 {",
            "    vertexRotationIndex += 1",
            "    vertexRotationTime = 0",
            "",
            "    if vertexRotationIndex > vertexRotations.count - 3 {",
            "        displaylink.invalidate()",
            "        isRunning = false",
            "    }",
            "}"
          ],
          "syntax": "swift",
          "metadata": {
            "anchor": "3282777",
            "title": "Listing 9"
          }
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "Over time, the cube animates through the series of keyframes. By tracing the path (shown as a thin line) of one of the vertices (marked by the dot), you can see the sharp change in direction as the cube rotates between the keyframes:"
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "image",
              "identifier": "media-3282771",
              "metadata": {
                "anchor": "3282771",
                "title": "Figure 2"
              }
            }
          ]
        },
        {
          "level": 3,
          "type": "heading",
          "text": "Animate Between Keyframes with Spline Interpolation",
          "anchor": "3282786"
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "Use the identical code to the spherical interpolation sample for spline interpolation, apart from one change: Rather than generating the quaternion that acts upon the vertices with "
            },
            {
              "type": "codeVoice",
              "code": "simd_slerp"
            },
            {
              "type": "text",
              "text": ", use "
            },
            {
              "type": "codeVoice",
              "code": "simd_spline"
            },
            {
              "type": "text",
              "text": ":"
            }
          ]
        },
        {
          "type": "codeListing",
          "code": [
            "q = simd_spline(vertexRotations[vertexRotationIndex - 1],",
            "                vertexRotations[vertexRotationIndex],",
            "                vertexRotations[vertexRotationIndex + 1],",
            "                vertexRotations[vertexRotationIndex + 2],",
            "                vertexRotationTime)"
          ],
          "syntax": "swift",
          "metadata": {
            "anchor": "3282780",
            "title": "Listing 10"
          }
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "With spline interpolation, the transition between the quaternion keyframes is far smoother as shown in the image below:"
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "image",
              "identifier": "media-3282779",
              "metadata": {
                "anchor": "3282779",
                "title": "Figure 3"
              }
            }
          ]
        }
      ]
    }
  ],
  "legalNotices": {
    "copyright": "Copyright &copy; 2020 Apple Inc. All rights reserved.",
    "termsOfUse": "https://www.apple.com/legal/internet-services/terms/site.html",
    "privacyPolicy": "https://www.apple.com/privacy/privacy-policy"
  }
}