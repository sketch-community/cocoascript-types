{
  "abstract": [
    {
      "type": "text",
      "text": "Applies a piecewise rational expression to  an image in PlanarF format. "
    }
  ],
  "documentVersion": 0,
  "hierarchy": {
    "paths": [
      [
        "doc://com.apple.documentation/documentation/technologies",
        "doc://com.apple.documentation/documentation/accelerate",
        "doc://com.apple.documentation/documentation/accelerate/transform"
      ],
      [
        "doc://com.apple.documentation/documentation/technologies",
        "doc://com.apple.documentation/documentation/accelerate",
        "doc://com.apple.documentation/documentation/accelerate/vimage",
        "doc://com.apple.documentation/documentation/accelerate/vimage/vimage_operations",
        "doc://com.apple.documentation/documentation/accelerate/transform"
      ]
    ]
  },
  "identifier": {
    "url": "doc://com.apple.documentation/documentation/accelerate/1545831-vimagepiecewiserational_planarf",
    "interfaceLanguage": "occ"
  },
  "legacy_identifier": 1545831,
  "kind": "symbol",
  "metadata": {
    "title": "vImagePiecewiseRational_PlanarF",
    "role": "symbol",
    "roleHeading": "Function",
    "modules": [
      {
        "name": "Accelerate"
      }
    ],
    "platforms": [
      {
        "name": "iOS",
        "introducedAt": "5.0",
        "current": "15.2"
      },
      {
        "name": "iPadOS",
        "introducedAt": "5.0",
        "current": "15.2"
      },
      {
        "name": "macOS",
        "introducedAt": "10.4",
        "current": "12.1"
      },
      {
        "name": "Mac Catalyst",
        "introducedAt": "13.0",
        "current": "15.2"
      },
      {
        "name": "tvOS",
        "introducedAt": "9.0",
        "current": "15.2"
      },
      {
        "name": "watchOS",
        "introducedAt": "2.0",
        "current": "8.3"
      }
    ],
    "externalID": "c:@F@vImagePiecewiseRational_PlanarF",
    "symbolKind": "func"
  },
  "schemaVersion": {
    "major": 0,
    "minor": 1,
    "patch": 0
  },
  "sections": [],
  "variants": [
    {
      "traits": [
        {
          "interfaceLanguage": "occ"
        }
      ],
      "paths": [
        "documentation/accelerate/1545831-vimagepiecewiserational_planarf"
      ]
    },
    {
      "traits": [
        {
          "interfaceLanguage": "swift"
        }
      ],
      "paths": [
        "documentation/accelerate/1545831-vimagepiecewiserational_planarf"
      ]
    }
  ],
  "references": {
    "doc://com.apple.documentation/documentation/accelerate": {
      "title": "Accelerate",
      "identifier": "doc://com.apple.documentation/documentation/accelerate",
      "url": "/documentation/accelerate",
      "type": "topic",
      "kind": "symbol",
      "role": "collection"
    },
    "doc://com.apple.documentation/documentation/accelerate/transform": {
      "title": "Transform",
      "identifier": "doc://com.apple.documentation/documentation/accelerate/transform",
      "url": "/documentation/accelerate/transform",
      "type": "topic",
      "kind": "article",
      "role": "collectionGroup"
    },
    "doc://com.apple.documentation/documentation/accelerate/vimage": {
      "title": "vImage",
      "identifier": "doc://com.apple.documentation/documentation/accelerate/vimage",
      "url": "/documentation/accelerate/vimage",
      "type": "topic",
      "kind": "article",
      "role": "collectionGroup"
    },
    "doc://com.apple.documentation/documentation/accelerate/vimage/vimage_operations": {
      "title": "vImage Operations",
      "identifier": "doc://com.apple.documentation/documentation/accelerate/vimage/vimage_operations",
      "url": "/documentation/accelerate/vimage/vimage_operations",
      "type": "topic",
      "kind": "article",
      "role": "collectionGroup"
    },
    "doc://com.apple.documentation/documentation/accelerate/1578972-error_codes/kvimagenoerror": {
      "title": "kvImageNoError",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/accelerate/1578972-error_codes/kvimagenoerror",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/accelerate/1578972-error_codes/kvimagenoerror"
    },
    "doc://com.apple.documentation/documentation/accelerate/vimage/data_types_and_constants": {
      "title": "Data Types and Constants",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/accelerate/vimage/data_types_and_constants",
      "kind": "article",
      "role": "collectionGroup",
      "url": "/documentation/accelerate/vimage/data_types_and_constants"
    },
    "doc://com.apple.documentation/documentation/accelerate/1546813-vimagepiecewisepolynomial_planar": {
      "title": "vImagePiecewisePolynomial_PlanarF",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/accelerate/1546813-vimagepiecewisepolynomial_planar",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/accelerate/1546813-vimagepiecewisepolynomial_planar",
      "abstract": [
        {
          "type": "text",
          "text": "Applies a set of piecewise polynomials to an image in PlanarF format."
        }
      ]
    },
    "link-media-2557547": {
      "identifier": "link-media-2557547",
      "type": "link",
      "title": "Figure 1",
      "url": "/documentation/accelerate/1545831-vimagepiecewiserational_planarf#2557547"
    },
    "media-2557547": {
      "identifier": "media-2557547",
      "type": "image",
      "variants": [
        {
          "traits": [
            "1x"
          ],
          "size": {
            "width": 342,
            "height": 49
          },
          "url": "https://docs-assets.developer.apple.com/published/933f5957c2/piecewise_rational_e274b8c6-7579-4c2f-9536-b4e97ec3cd94.jpg"
        }
      ],
      "alt": "A rational equation.",
      "title": "Figure 1"
    },
    "doc://com.apple.documentation/documentation/accelerate/1545831-vimagepiecewiserational_planarf#2557541": {
      "title": "Listing 1",
      "type": "section",
      "identifier": "doc://com.apple.documentation/documentation/accelerate/1545831-vimagepiecewiserational_planarf#2557541",
      "kind": "article",
      "role": "codeListing",
      "url": "/documentation/accelerate/1545831-vimagepiecewiserational_planarf#2557541"
    },
    "doc://com.apple.documentation/documentation/accelerate/1578976-processing_flags/kvimagedonottile": {
      "title": "kvImageDoNotTile",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/accelerate/1578976-processing_flags/kvimagedonottile",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/accelerate/1578976-processing_flags/kvimagedonottile"
    },
    "doc://com.apple.documentation/documentation/accelerate/vimage_error": {
      "title": "vImage_Error",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/accelerate/vimage_error",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/accelerate/vimage_error"
    },
    "doc://com.apple.documentation/documentation/accelerate/vimage_buffer": {
      "title": "vImage_Buffer",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/accelerate/vimage_buffer",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/accelerate/vimage_buffer"
    },
    "doc://com.apple.documentation/documentation/accelerate/vimage_flags": {
      "title": "vImage_Flags",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/accelerate/vimage_flags",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/accelerate/vimage_flags"
    },
    "doc://com.apple.documentation/documentation/accelerate/applying_tone_curve_adjustments_to_images": {
      "title": "Applying Tone Curve Adjustments to Images",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/accelerate/applying_tone_curve_adjustments_to_images",
      "kind": "article",
      "role": "sampleCode",
      "url": "/documentation/accelerate/applying_tone_curve_adjustments_to_images",
      "abstract": [
        {
          "type": "text",
          "text": "Use the vImage libraryâ€™s polynomial transform to apply tone curve adjustments to images."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/accelerate/1546252-vimagepiecewisepolynomial_planar": {
      "title": "vImagePiecewisePolynomial_Planar8toPlanarF",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/accelerate/1546252-vimagepiecewisepolynomial_planar",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/accelerate/1546252-vimagepiecewisepolynomial_planar",
      "abstract": [
        {
          "type": "text",
          "text": "Applies a set of piecewise polynomials to transform an image in Planar8 format to an image in PlanarF format. "
        }
      ]
    },
    "doc://com.apple.documentation/documentation/accelerate/1546201-vimagepiecewisepolynomial_planar": {
      "title": "vImagePiecewisePolynomial_PlanarFtoPlanar8",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/accelerate/1546201-vimagepiecewisepolynomial_planar",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/accelerate/1546201-vimagepiecewisepolynomial_planar",
      "abstract": [
        {
          "type": "text",
          "text": "Applies a set of piecewise polynomials to transform an image in PlanarF format to an image in Planar8 format."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/accelerate/1545831-vimagepiecewiserational_planarf": {
      "title": "vImagePiecewiseRational_PlanarF",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/accelerate/1545831-vimagepiecewiserational_planarf",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/accelerate/1545831-vimagepiecewiserational_planarf",
      "abstract": [
        {
          "type": "text",
          "text": "Applies a piecewise rational expression to  an image in PlanarF format. "
        }
      ]
    },
    "doc://com.apple.documentation/documentation/accelerate/1544253-vimagesymmetricpiecewisepolynomi": {
      "title": "vImageSymmetricPiecewisePolynomial_PlanarF",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/accelerate/1544253-vimagesymmetricpiecewisepolynomi",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/accelerate/1544253-vimagesymmetricpiecewisepolynomi",
      "abstract": [
        {
          "type": "text",
          "text": "Applies a set of symmetric piecewise polynomials to an image in PlanarF format."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/technologies": {
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/technologies",
      "url": "/documentation/technologies",
      "kind": "technologies",
      "title": "Technologies"
    }
  },
  "seeAlsoSections": [
    {
      "identifiers": [
        "doc://com.apple.documentation/documentation/accelerate/applying_tone_curve_adjustments_to_images",
        "doc://com.apple.documentation/documentation/accelerate/1546813-vimagepiecewisepolynomial_planar",
        "doc://com.apple.documentation/documentation/accelerate/1546252-vimagepiecewisepolynomial_planar",
        "doc://com.apple.documentation/documentation/accelerate/1546201-vimagepiecewisepolynomial_planar",
        "doc://com.apple.documentation/documentation/accelerate/1544253-vimagesymmetricpiecewisepolynomi"
      ],
      "title": "Applying a Polynomial",
      "generated": true
    }
  ],
  "primaryContentSections": [
    {
      "kind": "declarations",
      "declarations": [
        {
          "languages": [
            "occ"
          ],
          "tokens": [
            {
              "kind": "typeIdentifier",
              "preciseIdentifier": "c:@T@vImage_Error",
              "identifier": "doc://com.apple.documentation/documentation/accelerate/vimage_error",
              "text": "vImage_Error"
            },
            {
              "kind": "text",
              "text": " "
            },
            {
              "kind": "identifier",
              "text": "vImagePiecewiseRational_PlanarF"
            },
            {
              "kind": "text",
              "text": "("
            },
            {
              "kind": "keyword",
              "text": "const"
            },
            {
              "kind": "text",
              "text": " "
            },
            {
              "kind": "typeIdentifier",
              "preciseIdentifier": "c:@T@vImage_Buffer",
              "identifier": "doc://com.apple.documentation/documentation/accelerate/vimage_buffer",
              "text": "vImage_Buffer"
            },
            {
              "kind": "text",
              "text": " *src, "
            },
            {
              "kind": "keyword",
              "text": "const"
            },
            {
              "kind": "text",
              "text": " "
            },
            {
              "kind": "typeIdentifier",
              "preciseIdentifier": "c:@T@vImage_Buffer",
              "identifier": "doc://com.apple.documentation/documentation/accelerate/vimage_buffer",
              "text": "vImage_Buffer"
            },
            {
              "kind": "text",
              "text": " *dest, "
            },
            {
              "kind": "keyword",
              "text": "const"
            },
            {
              "kind": "text",
              "text": " "
            },
            {
              "kind": "keyword",
              "text": "float"
            },
            {
              "kind": "text",
              "text": " **topCoefficients, "
            },
            {
              "kind": "keyword",
              "text": "const"
            },
            {
              "kind": "text",
              "text": " "
            },
            {
              "kind": "keyword",
              "text": "float"
            },
            {
              "kind": "text",
              "text": " **bottomCoefficients, "
            },
            {
              "kind": "keyword",
              "text": "const"
            },
            {
              "kind": "text",
              "text": " "
            },
            {
              "kind": "keyword",
              "text": "float"
            },
            {
              "kind": "text",
              "text": " *boundaries, "
            },
            {
              "kind": "keyword",
              "text": "uint32_t"
            },
            {
              "kind": "text",
              "text": " topOrder, "
            },
            {
              "kind": "keyword",
              "text": "uint32_t"
            },
            {
              "kind": "text",
              "text": " bottomOrder, "
            },
            {
              "kind": "keyword",
              "text": "uint32_t"
            },
            {
              "kind": "text",
              "text": " log2segments, "
            },
            {
              "kind": "typeIdentifier",
              "preciseIdentifier": "c:@T@vImage_Flags",
              "identifier": "doc://com.apple.documentation/documentation/accelerate/vimage_flags",
              "text": "vImage_Flags"
            },
            {
              "kind": "text",
              "text": " flags);"
            }
          ],
          "platforms": [
            "iOS",
            "iPadOS",
            "macOS",
            "Mac Catalyst",
            "tvOS",
            "watchOS"
          ]
        }
      ]
    },
    {
      "kind": "parameters",
      "languages": [
        "occ"
      ],
      "parameters": [
        {
          "name": "src",
          "content": [
            {
              "type": "paragraph",
              "inlineContent": [
                {
                  "type": "text",
                  "text": "A pointer to a vImage buffer structure that contains the source image."
                }
              ]
            }
          ]
        },
        {
          "name": "dest",
          "content": [
            {
              "type": "paragraph",
              "inlineContent": [
                {
                  "type": "text",
                  "text": "A pointer to a vImage buffer data structure. You're responsible for filling out the "
                },
                {
                  "type": "codeVoice",
                  "code": "height"
                },
                {
                  "type": "text",
                  "text": ", "
                },
                {
                  "type": "codeVoice",
                  "code": "width"
                },
                {
                  "type": "text",
                  "text": ", and "
                },
                {
                  "type": "codeVoice",
                  "code": "rowBytes"
                },
                {
                  "type": "text",
                  "text": " fields of this structure, and for allocating a data buffer of the appropriate size. On return, the data buffer this structure points to contains the destination image data. When you no longer need the data buffer, you must deallocate the memory"
                }
              ]
            }
          ]
        },
        {
          "name": "topCoefficients",
          "content": [
            {
              "type": "paragraph",
              "inlineContent": [
                {
                  "type": "text",
                  "text": "An array of pointers to polynomial coefficient arrays  The array of pointers has length 2"
                },
                {
                  "type": "superscript",
                  "inlineContent": [
                    {
                      "type": "text",
                      "text": "log2segments"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ". Each array pointed to has length "
                },
                {
                  "type": "codeVoice",
                  "code": "topOrder"
                },
                {
                  "type": "text",
                  "text": "+1."
                }
              ]
            },
            {
              "type": "paragraph",
              "inlineContent": [
                {
                  "type": "text",
                  "text": "Each polynomial coefficient array contains the coefficients for one polynomial. Note that a polynomial of order R has R+1 coefficients. All the polynomial coefficient arrays must be the same size, R+1, and in each array the coefficients must be ordered from the 0th-order term to the highest-order term."
                }
              ]
            }
          ]
        },
        {
          "name": "bottomCoefficients",
          "content": [
            {
              "type": "paragraph",
              "inlineContent": [
                {
                  "type": "text",
                  "text": "An array of pointers to polynomial coefficient arrays  The array of pointers has length 2"
                },
                {
                  "type": "superscript",
                  "inlineContent": [
                    {
                      "type": "text",
                      "text": "log2segments"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ". Each array pointed to has length"
                },
                {
                  "type": "codeVoice",
                  "code": " bottomOrder"
                },
                {
                  "type": "text",
                  "text": "+1."
                }
              ]
            },
            {
              "type": "paragraph",
              "inlineContent": [
                {
                  "type": "text",
                  "text": "Each polynomial coefficient array contains the coefficients for one polynomial. Note that a polynomial of order R has R+1 coefficients. All the polynomial coefficient arrays must be the same size, R+1, and in each array the coefficients must be ordered from the 0th-order term to the highest-order term. These do not need to be the same order as the top polynomials."
                }
              ]
            }
          ]
        },
        {
          "name": "boundaries",
          "content": [
            {
              "type": "paragraph",
              "inlineContent": [
                {
                  "type": "text",
                  "text": "An array of floating-point values with size  (2"
                },
                {
                  "type": "superscript",
                  "inlineContent": [
                    {
                      "type": "text",
                      "text": "log2segments"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ")+1, in increasing order, for separating adjacent ranges of pixel values. The first boundary value is the lowest in the range; input values lower than this are clipped to this value. The last boundary value is the highest in the range; input values higher than this are clipped to this value. The boundary values between the first and last separate the subranges from each other. The boundaries must be the same for both the top and bottom polynomials."
                }
              ]
            }
          ]
        },
        {
          "name": "topOrder",
          "content": [
            {
              "type": "paragraph",
              "inlineContent": [
                {
                  "type": "text",
                  "text": "The order of the top polynomial. Make sure you pass the "
                },
                {
                  "type": "emphasis",
                  "inlineContent": [
                    {
                      "type": "text",
                      "text": "order"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " (that is, the highest power of x), not the number of coefiicients."
                }
              ]
            }
          ]
        },
        {
          "name": "bottomOrder",
          "content": [
            {
              "type": "paragraph",
              "inlineContent": [
                {
                  "type": "text",
                  "text": "The order of the bottom polynomial. Make sure you pass the "
                },
                {
                  "type": "emphasis",
                  "inlineContent": [
                    {
                      "type": "text",
                      "text": "order"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " (that is, the highest power of x), not the number of coefiicients."
                }
              ]
            }
          ]
        },
        {
          "name": "log2segments",
          "content": [
            {
              "type": "paragraph",
              "inlineContent": [
                {
                  "type": "text",
                  "text": "The number of rationals represented as a  base-2 logarithm. If you pass a non-integer power-of-two number of rational (for example, 5), you must round up to the next integer power of 2 (for the example of 5, that would be 8), and simply repeat the last rational the appropriate number of times."
                }
              ]
            }
          ]
        },
        {
          "name": "flags",
          "content": [
            {
              "type": "paragraph",
              "inlineContent": [
                {
                  "type": "text",
                  "text": "The options to use when performing the operation. If your code implements its own tiling or its own multithreading, pass "
                },
                {
                  "type": "reference",
                  "isActive": true,
                  "identifier": "doc://com.apple.documentation/documentation/accelerate/1578976-processing_flags/kvimagedonottile"
                },
                {
                  "type": "text",
                  "text": "."
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "kind": "content",
      "content": [
        {
          "anchor": "return_value",
          "level": 2,
          "text": "Return Value",
          "type": "heading"
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/accelerate/1578972-error_codes/kvimagenoerror"
            },
            {
              "type": "text",
              "text": "; otherwise, one of the error codes described in "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/accelerate/vimage/data_types_and_constants"
            },
            {
              "type": "text",
              "text": "."
            }
          ]
        }
      ]
    },
    {
      "kind": "content",
      "content": [
        {
          "anchor": "discussion",
          "level": 2,
          "text": "Discussion",
          "type": "heading"
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "This function is similar to "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/accelerate/1546813-vimagepiecewisepolynomial_planar"
            },
            {
              "type": "text",
              "text": " except that it evaluates a piecewise rational expression in the form of: "
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "image",
              "identifier": "media-2557547",
              "metadata": {
                "anchor": "2557547",
                "title": "Figure 1"
              }
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "Each polynomial has its own set of coefficients and its own polynomial order. The two polynomials share the same set of segment boundaries. If the polynomials are split then all the top polynomials must be of the same order, and all the bottom polynomials must be of the same order. However, regardless of whether the polynomial is split or not, the top polynomials do not need to be the same order as the bottom polynomials."
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "This function does not deliver IEEE-754 correct division. The divide does not round per the IEEE-754 current rounding mode. It incurs up to 2 ULPs (Units in the Last Place) of error. Edge cases involving denormals, infinities, NaNs and division by zero return undefined results. (They will not  crash, but NaN is a likely result in such cases.) Denormals can be rescued on AltiVec enabled machines by turning off the Non-Java bit in the VSCR, at the expense of taking a many-thousand cycle kernel exception every time a denormal number is encountered. Since you can predict ahead of time whether a given set of bounded polynomials is going to encounter these conditions,  this problem should be avoidable by wise choice of polynomials. Developers who require IEEE-754  correct results should call the polynomial evaluator above twice and do the division themselves. "
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "The approximate cost of evaluating a rational (in the same units as polynomial above) is:"
            }
          ]
        },
        {
          "type": "codeListing",
          "code": [
            "time = (base cost to touch all the data) + top polynomial order",
            "      + bottom polynomial order + 4 + 4 * log2segments"
          ],
          "syntax": "other",
          "metadata": {
            "anchor": "2557541",
            "title": "Listing 1"
          }
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": " With data not in cache, the time may be significantly different. For sufficiently small polynomials, the  cost may be a fixed cost, dependent only on how much data is touched, and not on polynomial order."
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "This performance behavior is provided to help you evaluate speed tradeoffs. It is not a guaranteed.  It is subject to change in future operating system revisions, and may be different on different hardware within the same or different operating system revisions."
            }
          ]
        }
      ]
    }
  ],
  "legalNotices": {
    "copyright": "Copyright &copy; 2021 Apple Inc. All rights reserved.",
    "termsOfUse": "https://www.apple.com/legal/internet-services/terms/site.html",
    "privacyPolicy": "https://www.apple.com/privacy/privacy-policy"
  }
}