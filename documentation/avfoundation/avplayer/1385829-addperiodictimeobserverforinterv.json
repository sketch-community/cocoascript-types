{
  "abstract": [
    {
      "type": "text",
      "text": "Requests the periodic invocation of a given block during playback to report changing time."
    }
  ],
  "documentVersion": 0,
  "hierarchy": {
    "paths": [
      [
        "doc://com.apple.documentation/documentation/technologies",
        "doc://com.apple.documentation/documentation/avfoundation",
        "doc://com.apple.documentation/documentation/avfoundation/media_playback_and_selection",
        "doc://com.apple.documentation/documentation/avfoundation/avplayer"
      ]
    ]
  },
  "identifier": {
    "url": "doc://com.apple.documentation/documentation/avfoundation/avplayer/1385829-addperiodictimeobserverforinterv",
    "interfaceLanguage": "occ"
  },
  "legacy_identifier": 1385829,
  "kind": "symbol",
  "metadata": {
    "title": "addPeriodicTimeObserverForInterval:queue:usingBlock:",
    "role": "symbol",
    "roleHeading": "Instance Method",
    "modules": [
      {
        "name": "AVFoundation"
      }
    ],
    "platforms": [
      {
        "name": "iOS",
        "introducedAt": "4.0",
        "current": "15.2"
      },
      {
        "name": "iPadOS",
        "introducedAt": "4.0",
        "current": "15.2"
      },
      {
        "name": "macOS",
        "introducedAt": "10.7",
        "current": "12.1"
      },
      {
        "name": "Mac Catalyst",
        "introducedAt": "13.0",
        "current": "15.2"
      },
      {
        "name": "tvOS",
        "introducedAt": "9.0",
        "current": "15.2"
      },
      {
        "name": "watchOS",
        "introducedAt": "7.0",
        "current": "8.3"
      }
    ],
    "externalID": "c:objc(cs)AVPlayer(im)addPeriodicTimeObserverForInterval:queue:usingBlock:",
    "parent": {
      "title": "AVPlayer"
    },
    "symbolKind": "instm"
  },
  "schemaVersion": {
    "major": 0,
    "minor": 1,
    "patch": 0
  },
  "sections": [],
  "variants": [
    {
      "traits": [
        {
          "interfaceLanguage": "occ"
        }
      ],
      "paths": [
        "documentation/avfoundation/avplayer/1385829-addperiodictimeobserverforinterv"
      ]
    },
    {
      "traits": [
        {
          "interfaceLanguage": "swift"
        }
      ],
      "paths": [
        "documentation/avfoundation/avplayer/1385829-addperiodictimeobserver"
      ]
    }
  ],
  "references": {
    "doc://com.apple.documentation/documentation/avfoundation": {
      "title": "AVFoundation",
      "identifier": "doc://com.apple.documentation/documentation/avfoundation",
      "url": "/documentation/avfoundation",
      "type": "topic",
      "kind": "symbol",
      "role": "collection"
    },
    "doc://com.apple.documentation/documentation/avfoundation/media_playback_and_selection": {
      "title": "Media Playback and Selection",
      "identifier": "doc://com.apple.documentation/documentation/avfoundation/media_playback_and_selection",
      "url": "/documentation/avfoundation/media_playback_and_selection",
      "type": "topic",
      "kind": "article",
      "role": "collectionGroup"
    },
    "doc://com.apple.documentation/documentation/avfoundation/avplayer": {
      "title": "AVPlayer",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/avfoundation/avplayer",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/avfoundation/avplayer",
      "abstract": [
        {
          "type": "text",
          "text": "An object that provides the interface to control the player’s transport behavior."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/avfoundation/avplayer/1387552-removetimeobserver": {
      "title": "removeTimeObserver:",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/avfoundation/avplayer/1387552-removetimeobserver",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/avfoundation/avplayer/1387552-removetimeobserver",
      "abstract": [
        {
          "type": "text",
          "text": "Cancels a previously registered periodic or boundary time observer."
        }
      ],
      "fragments": [
        {
          "kind": "text",
          "text": "- "
        },
        {
          "kind": "identifier",
          "text": "removeTimeObserver:"
        }
      ]
    },
    "doc://com.apple.documentation/documentation/avfoundation/avplayer/1385829-addperiodictimeobserverforinterv#2556044": {
      "title": "Listing 1",
      "type": "section",
      "identifier": "doc://com.apple.documentation/documentation/avfoundation/avplayer/1385829-addperiodictimeobserverforinterv#2556044",
      "kind": "article",
      "role": "codeListing",
      "url": "/documentation/avfoundation/avplayer/1385829-addperiodictimeobserverforinterv#2556044"
    },
    "doc://com.apple.documentation/documentation/coremedia/cmtime": {
      "title": "CMTime",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/coremedia/cmtime",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/coremedia/cmtime"
    },
    "doc://com.apple.documentation/documentation/dispatch/dispatch_queue_t": {
      "title": "dispatch_queue_t",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/dispatch/dispatch_queue_t",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/dispatch/dispatch_queue_t"
    },
    "doc://com.apple.documentation/documentation/avfoundation/avplayer/1390404-currenttime": {
      "title": "currentTime",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/avfoundation/avplayer/1390404-currenttime",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/avfoundation/avplayer/1390404-currenttime",
      "abstract": [
        {
          "type": "text",
          "text": "Returns the current time of the current player item."
        }
      ],
      "fragments": [
        {
          "kind": "text",
          "text": "- "
        },
        {
          "kind": "identifier",
          "text": "currentTime"
        }
      ]
    },
    "doc://com.apple.documentation/documentation/avfoundation/avplayer/1385829-addperiodictimeobserverforinterv": {
      "title": "addPeriodicTimeObserverForInterval:queue:usingBlock:",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/avfoundation/avplayer/1385829-addperiodictimeobserverforinterv",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/avfoundation/avplayer/1385829-addperiodictimeobserverforinterv",
      "abstract": [
        {
          "type": "text",
          "text": "Requests the periodic invocation of a given block during playback to report changing time."
        }
      ],
      "fragments": [
        {
          "kind": "text",
          "text": "- "
        },
        {
          "kind": "identifier",
          "text": "addPeriodicTimeObserverForInterval:queue:usingBlock:"
        }
      ]
    },
    "doc://com.apple.documentation/documentation/avfoundation/avplayer/1388027-addboundarytimeobserverfortimes": {
      "title": "addBoundaryTimeObserverForTimes:queue:usingBlock:",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/avfoundation/avplayer/1388027-addboundarytimeobserverfortimes",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/avfoundation/avplayer/1388027-addboundarytimeobserverfortimes",
      "abstract": [
        {
          "type": "text",
          "text": "Requests the invocation of a block when specified times are traversed during normal playback."
        }
      ],
      "fragments": [
        {
          "kind": "text",
          "text": "- "
        },
        {
          "kind": "identifier",
          "text": "addBoundaryTimeObserverForTimes:queue:usingBlock:"
        }
      ]
    },
    "doc://com.apple.documentation/documentation/technologies": {
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/technologies",
      "url": "/documentation/technologies",
      "kind": "technologies",
      "title": "Technologies"
    }
  },
  "seeAlsoSections": [
    {
      "identifiers": [
        "doc://com.apple.documentation/documentation/avfoundation/avplayer/1390404-currenttime",
        "doc://com.apple.documentation/documentation/avfoundation/avplayer/1388027-addboundarytimeobserverfortimes",
        "doc://com.apple.documentation/documentation/avfoundation/avplayer/1387552-removetimeobserver"
      ],
      "title": "Observing Player Time",
      "generated": true
    }
  ],
  "primaryContentSections": [
    {
      "kind": "declarations",
      "declarations": [
        {
          "languages": [
            "occ"
          ],
          "tokens": [
            {
              "kind": "text",
              "text": "- ("
            },
            {
              "kind": "keyword",
              "text": "id"
            },
            {
              "kind": "text",
              "text": ")"
            },
            {
              "kind": "identifier",
              "text": "addPeriodicTimeObserverForInterval:"
            },
            {
              "kind": "text",
              "text": "("
            },
            {
              "kind": "typeIdentifier",
              "preciseIdentifier": "c:@T@CMTime",
              "identifier": "doc://com.apple.documentation/documentation/coremedia/cmtime",
              "text": "CMTime"
            },
            {
              "kind": "text",
              "text": ")"
            },
            {
              "kind": "internalParam",
              "text": "interval"
            },
            {
              "kind": "text",
              "text": " "
            },
            {
              "kind": "identifier",
              "text": "queue:"
            },
            {
              "kind": "text",
              "text": "("
            },
            {
              "kind": "typeIdentifier",
              "preciseIdentifier": "c:@T@dispatch_queue_t",
              "identifier": "doc://com.apple.documentation/documentation/dispatch/dispatch_queue_t",
              "text": "dispatch_queue_t"
            },
            {
              "kind": "text",
              "text": ")"
            },
            {
              "kind": "internalParam",
              "text": "queue"
            },
            {
              "kind": "text",
              "text": " "
            },
            {
              "kind": "identifier",
              "text": "usingBlock:"
            },
            {
              "kind": "text",
              "text": "("
            },
            {
              "kind": "keyword",
              "text": "void"
            },
            {
              "kind": "text",
              "text": " (^)("
            },
            {
              "kind": "typeIdentifier",
              "preciseIdentifier": "c:@T@CMTime",
              "identifier": "doc://com.apple.documentation/documentation/coremedia/cmtime",
              "text": "CMTime"
            },
            {
              "kind": "text",
              "text": " time)"
            },
            {
              "kind": "text",
              "text": ")"
            },
            {
              "kind": "internalParam",
              "text": "block"
            },
            {
              "kind": "text",
              "text": ";"
            }
          ],
          "platforms": [
            "iOS",
            "iPadOS",
            "macOS",
            "Mac Catalyst",
            "tvOS",
            "watchOS"
          ]
        }
      ]
    },
    {
      "kind": "parameters",
      "languages": [
        "occ"
      ],
      "parameters": [
        {
          "name": "interval",
          "content": [
            {
              "type": "paragraph",
              "inlineContent": [
                {
                  "type": "text",
                  "text": "The time interval at which the system invokes the block during normal playback, according to progress of the player’s current time."
                }
              ]
            }
          ]
        },
        {
          "name": "queue",
          "content": [
            {
              "type": "paragraph",
              "inlineContent": [
                {
                  "type": "text",
                  "text": "The dispatch queue on which the system calls the block. Passing a concurrent queue isn’t supported and results in undefined behavior."
                }
              ]
            },
            {
              "type": "paragraph",
              "inlineContent": [
                {
                  "type": "text",
                  "text": "If you pass "
                },
                {
                  "type": "codeVoice",
                  "code": "NULL"
                },
                {
                  "type": "text",
                  "text": ", the system uses the main queue."
                }
              ]
            }
          ]
        },
        {
          "name": "block",
          "content": [
            {
              "type": "paragraph",
              "inlineContent": [
                {
                  "type": "text",
                  "text": "The block that the system periodically invokes."
                }
              ]
            },
            {
              "type": "paragraph",
              "inlineContent": [
                {
                  "type": "text",
                  "text": "The block takes a single parameter:"
                }
              ]
            },
            {
              "type": "termList",
              "items": [
                {
                  "term": {
                    "inlineContent": [
                      {
                        "type": "text",
                        "text": "time"
                      }
                    ]
                  },
                  "definition": {
                    "content": [
                      {
                        "type": "paragraph",
                        "inlineContent": [
                          {
                            "type": "text",
                            "text": "The time at which the system invokes the block."
                          }
                        ]
                      }
                    ]
                  }
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "kind": "content",
      "content": [
        {
          "anchor": "return_value",
          "level": 2,
          "text": "Return Value",
          "type": "heading"
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "An opaque object that you pass as the argument to "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/avfoundation/avplayer/1387552-removetimeobserver"
            },
            {
              "type": "text",
              "text": " to cancel observation. "
            }
          ]
        }
      ]
    },
    {
      "kind": "content",
      "content": [
        {
          "anchor": "discussion",
          "level": 2,
          "text": "Discussion",
          "type": "heading"
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "You must maintain a strong reference to the returned value as long as you want the time observer to be invoked by the player. You must pair each invocation of this method with a corresponding call to "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/avfoundation/avplayer/1387552-removetimeobserver"
            },
            {
              "type": "text",
              "text": ". Releasing the observer object without invoking "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/avfoundation/avplayer/1387552-removetimeobserver"
            },
            {
              "type": "text",
              "text": " results in undefined behavior."
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "The system invokes the block periodically at the interval specified, interpreted according to the timeline of the current item. It also invokes the block whenever time jumps or playback starts or stops. If the interval corresponds to a very short interval in real time, the player may invoke the block less frequently than your app requested. Even so, the player will invoke the block sufficiently often for the client to update indications of the current time appropriately in its end-user interface."
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "The following example illustrates how you set up a callback the system invokes every half second during normal playback."
            }
          ]
        },
        {
          "type": "codeListing",
          "code": [
            "- (void)addPeriodicTimeObserver {",
            "    // Invoke callback every half second",
            "    CMTime interval = CMTimeMakeWithSeconds(0.5, NSEC_PER_SEC);",
            "    // Queue on which to invoke the callback",
            "    dispatch_queue_t mainQueue = dispatch_get_main_queue();",
            "    // Add time observer",
            "    self.timeObserverToken =",
            "        [self.player addPeriodicTimeObserverForInterval:interval",
            "                                                  queue:mainQueue",
            "                                             usingBlock:^(CMTime time) {",
            "            // Use weak reference to self",
            "            // Update player transport UI",
            "        }];",
            "}"
          ],
          "syntax": "occ",
          "metadata": {
            "anchor": "2556044",
            "title": "Listing 1"
          }
        },
        {
          "type": "aside",
          "content": [
            {
              "type": "paragraph",
              "inlineContent": [
                {
                  "type": "text",
                  "text": "Use a "
                },
                {
                  "type": "codeVoice",
                  "code": "weak"
                },
                {
                  "type": "text",
                  "text": " reference to "
                },
                {
                  "type": "codeVoice",
                  "code": "self"
                },
                {
                  "type": "text",
                  "text": " in the callback block to prevent creating a retain cycle."
                }
              ]
            }
          ],
          "style": "important"
        }
      ]
    }
  ],
  "legalNotices": {
    "copyright": "Copyright &copy; 2021 Apple Inc. All rights reserved.",
    "termsOfUse": "https://www.apple.com/legal/internet-services/terms/site.html",
    "privacyPolicy": "https://www.apple.com/privacy/privacy-policy"
  }
}