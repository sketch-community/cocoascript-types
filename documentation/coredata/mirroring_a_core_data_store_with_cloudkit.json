{
  "abstract": [
    {
      "type": "text",
      "text": "Back user interfaces with a local replica of a CloudKit private database."
    }
  ],
  "documentVersion": 0,
  "hierarchy": {
    "paths": [
      [
        "doc://com.apple.documentation/documentation/technologies",
        "doc://com.apple.documentation/documentation/coredata"
      ]
    ]
  },
  "identifier": {
    "url": "doc://com.apple.documentation/documentation/coredata/mirroring_a_core_data_store_with_cloudkit",
    "interfaceLanguage": "occ"
  },
  "legacy_identifier": 3178615,
  "kind": "article",
  "metadata": {
    "title": "Mirroring a Core Data Store with CloudKit",
    "role": "article",
    "roleHeading": "Article",
    "modules": [
      {
        "name": "Core Data"
      }
    ]
  },
  "schemaVersion": {
    "major": 0,
    "minor": 1,
    "patch": 0
  },
  "sections": [],
  "variants": [
    {
      "traits": [
        {
          "interfaceLanguage": "occ"
        }
      ],
      "paths": [
        "documentation/coredata/mirroring_a_core_data_store_with_cloudkit"
      ]
    },
    {
      "traits": [
        {
          "interfaceLanguage": "swift"
        }
      ],
      "paths": [
        "documentation/coredata/mirroring_a_core_data_store_with_cloudkit"
      ]
    }
  ],
  "references": {
    "doc://com.apple.documentation/documentation/coredata": {
      "title": "Core Data",
      "identifier": "doc://com.apple.documentation/documentation/coredata",
      "url": "/documentation/coredata",
      "type": "topic",
      "kind": "symbol",
      "role": "collection"
    },
    "doc://com.apple.documentation/documentation/coredata/nssqlitestoretype": {
      "title": "NSSQLiteStoreType",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/coredata/nssqlitestoretype",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/coredata/nssqlitestoretype"
    },
    "doc://com.apple.documentation/documentation/coredata/mirroring_a_core_data_store_with_cloudkit/setting_up_core_data_with_cloudkit#3193724": {
      "title": "Manage Multiple Stores",
      "type": "section",
      "identifier": "doc://com.apple.documentation/documentation/coredata/mirroring_a_core_data_store_with_cloudkit/setting_up_core_data_with_cloudkit#3193724",
      "kind": "article",
      "role": "subsection",
      "url": "/documentation/coredata/mirroring_a_core_data_store_with_cloudkit/setting_up_core_data_with_cloudkit#3193724"
    },
    "doc://com.apple.documentation/documentation/coredata/mirroring_a_core_data_store_with_cloudkit/creating_a_core_data_model_for_cloudkit#3191035": {
      "title": "Create a Data Model",
      "type": "section",
      "identifier": "doc://com.apple.documentation/documentation/coredata/mirroring_a_core_data_store_with_cloudkit/creating_a_core_data_model_for_cloudkit#3191035",
      "kind": "article",
      "role": "subsection",
      "url": "/documentation/coredata/mirroring_a_core_data_store_with_cloudkit/creating_a_core_data_model_for_cloudkit#3191035"
    },
    "doc://com.apple.documentation/documentation/coredata/mirroring_a_core_data_store_with_cloudkit/setting_up_core_data_with_cloudkit": {
      "title": "Setting Up Core Data with CloudKit",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/coredata/mirroring_a_core_data_store_with_cloudkit/setting_up_core_data_with_cloudkit",
      "kind": "article",
      "role": "article",
      "url": "/documentation/coredata/mirroring_a_core_data_store_with_cloudkit/setting_up_core_data_with_cloudkit",
      "abstract": [
        {
          "type": "text",
          "text": "Set up the classes and capabilities that sync your store to CloudKit."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/coredata/mirroring_a_core_data_store_with_cloudkit/creating_a_core_data_model_for_cloudkit": {
      "title": "Creating a Core Data Model for CloudKit",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/coredata/mirroring_a_core_data_store_with_cloudkit/creating_a_core_data_model_for_cloudkit",
      "kind": "article",
      "role": "article",
      "url": "/documentation/coredata/mirroring_a_core_data_store_with_cloudkit/creating_a_core_data_model_for_cloudkit",
      "abstract": [
        {
          "type": "text",
          "text": "Design a CloudKit-compatible data model and initialize your CloudKit schema."
        }
      ]
    },
    "link-3222356": {
      "title": "Apple Developer Program",
      "type": "topic",
      "identifier": "link-3222356",
      "kind": "article",
      "role": "link",
      "url": "https://developer.apple.com/programs/"
    },
    "devLink-1756019": {
      "identifier": "devLink-1756019",
      "type": "link",
      "title": "Create an iCloud Account for Development",
      "url": "https://developer.apple.com/library/archive/documentation/DataManagement/Conceptual/CloudKitQuickStart/EnablingiCloudandConfiguringCloudKit/EnablingiCloudandConfiguringCloudKit.html#//apple_ref/doc/uid/TP40014987-CH2-SW7"
    },
    "doc://com.apple.documentation/documentation/coredata/nspersistentcloudkitcontainer": {
      "title": "NSPersistentCloudKitContainer",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/coredata/nspersistentcloudkitcontainer",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/coredata/nspersistentcloudkitcontainer",
      "abstract": [
        {
          "type": "text",
          "text": "A container that encapsulates the Core Data stack in your app, and mirrors select persistent stores to a CloudKit private database."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/coredata/mirroring_a_core_data_store_with_cloudkit/syncing_a_core_data_store_with_cloudkit": {
      "title": "Syncing a Core Data Store with CloudKit",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/coredata/mirroring_a_core_data_store_with_cloudkit/syncing_a_core_data_store_with_cloudkit",
      "kind": "article",
      "role": "article",
      "url": "/documentation/coredata/mirroring_a_core_data_store_with_cloudkit/syncing_a_core_data_store_with_cloudkit",
      "abstract": [
        {
          "type": "text",
          "text": "Synchronize objects between devices, and handle store changes in the user interface."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/coredata/mirroring_a_core_data_store_with_cloudkit/reading_cloudkit_records_for_core_data": {
      "title": "Reading CloudKit Records for Core Data",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/coredata/mirroring_a_core_data_store_with_cloudkit/reading_cloudkit_records_for_core_data",
      "kind": "article",
      "role": "article",
      "url": "/documentation/coredata/mirroring_a_core_data_store_with_cloudkit/reading_cloudkit_records_for_core_data",
      "abstract": [
        {
          "type": "text",
          "text": "Access CloudKit records created from Core Data managed objects."
        }
      ]
    },
    "link-media-3226649": {
      "identifier": "link-media-3226649",
      "type": "link",
      "title": "Figure 1",
      "url": "/documentation/coredata/mirroring_a_core_data_store_with_cloudkit#3226649"
    },
    "media-3226649": {
      "identifier": "media-3226649",
      "type": "image",
      "variants": [
        {
          "traits": [
            "2x"
          ],
          "size": {
            "width": 407,
            "height": 335
          },
          "url": "https://docs-assets.developer.apple.com/published/7737ec129e/cd-cloudkit-overview@2x.png"
        },
        {
          "traits": [
            "dark",
            "2x"
          ],
          "size": {
            "width": 407,
            "height": 335
          },
          "url": "https://docs-assets.developer.apple.com/published/125e997f72/cd-cloudkit-overview~dark@2x.png"
        }
      ],
      "alt": "Flow diagram showing a record syncing between CloudKit and three devices: a laptop, an iPad, and an iPhone.",
      "title": "Figure 1"
    },
    "doc://com.apple.documentation/documentation/coredata/mirroring_a_core_data_store_with_cloudkit": {
      "title": "Mirroring a Core Data Store with CloudKit",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/coredata/mirroring_a_core_data_store_with_cloudkit",
      "kind": "article",
      "role": "article",
      "url": "/documentation/coredata/mirroring_a_core_data_store_with_cloudkit",
      "abstract": [
        {
          "type": "text",
          "text": "Back user interfaces with a local replica of a CloudKit private database."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/coredata/synchronizing_a_local_store_to_the_cloud": {
      "title": "Synchronizing a Local Store to the Cloud",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/coredata/synchronizing_a_local_store_to_the_cloud",
      "kind": "article",
      "role": "sampleCode",
      "url": "/documentation/coredata/synchronizing_a_local_store_to_the_cloud",
      "abstract": [
        {
          "type": "text",
          "text": "Share data between a user’s devices and other iCloud users."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/coredata/nspersistentcloudkitcontaineroptions": {
      "title": "NSPersistentCloudKitContainerOptions",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/coredata/nspersistentcloudkitcontaineroptions",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/coredata/nspersistentcloudkitcontaineroptions",
      "abstract": [
        {
          "type": "text",
          "text": "An object that customizes how a store description aligns with a CloudKit database."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/technologies": {
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/technologies",
      "url": "/documentation/technologies",
      "kind": "technologies",
      "title": "Technologies"
    }
  },
  "topicSections": [
    {
      "kind": "taskGroup",
      "title": "Configuring CloudKit Mirroring",
      "identifiers": [
        "doc://com.apple.documentation/documentation/coredata/mirroring_a_core_data_store_with_cloudkit/setting_up_core_data_with_cloudkit",
        "doc://com.apple.documentation/documentation/coredata/mirroring_a_core_data_store_with_cloudkit/creating_a_core_data_model_for_cloudkit",
        "doc://com.apple.documentation/documentation/coredata/mirroring_a_core_data_store_with_cloudkit/syncing_a_core_data_store_with_cloudkit",
        "doc://com.apple.documentation/documentation/coredata/mirroring_a_core_data_store_with_cloudkit/reading_cloudkit_records_for_core_data"
      ],
      "anchor": "3191037"
    }
  ],
  "seeAlsoSections": [
    {
      "identifiers": [
        "doc://com.apple.documentation/documentation/coredata/synchronizing_a_local_store_to_the_cloud",
        "doc://com.apple.documentation/documentation/coredata/nspersistentcloudkitcontainer",
        "doc://com.apple.documentation/documentation/coredata/nspersistentcloudkitcontaineroptions"
      ],
      "title": "CloudKit Mirroring",
      "generated": true
    }
  ],
  "primaryContentSections": [
    {
      "kind": "content",
      "content": [
        {
          "anchor": "overview",
          "level": 2,
          "text": "Overview",
          "type": "heading"
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "Use Core Data with CloudKit to give users seamless access to the data in your app across all their devices."
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "Core Data with CloudKit combines the benefits of local persistence with cloud backup and distribution. Core Data provides powerful object graph management features for developing an app with structured data. CloudKit lets users access their data across every device on their iCloud account, while serving as an always-available backup service."
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "image",
              "identifier": "media-3226649",
              "metadata": {
                "anchor": "3226649",
                "title": "Figure 1"
              }
            }
          ]
        },
        {
          "level": 3,
          "type": "heading",
          "text": "Determine If Your App Is Eligible for Core Data with CloudKit",
          "anchor": "3222324"
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "Apps adopting Core Data can use Core Data with CloudKit as long as the persistent store is an "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/coredata/nssqlitestoretype"
            },
            {
              "type": "text",
              "text": " store, and the data model is compatible with CloudKit limitations. For example, CloudKit does not support unique constraints, undefined attributes, or required relationships."
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "Apps using CloudKit cannot use Core Data with CloudKit with existing CloudKit containers. To fully manage all aspects of data mirroring, Core Data owns the CloudKit schema created from the Core Data model. Existing CloudKit containers aren’t compatible with this schema. If your app already uses CloudKit, you can add Core Data with CloudKit when synchronizing a Core Data store with a new container. For more information about working with multiple stores, see "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/coredata/mirroring_a_core_data_store_with_cloudkit/setting_up_core_data_with_cloudkit#3193724"
            },
            {
              "type": "text",
              "text": "."
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "For more information about data model requirements, see "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/coredata/mirroring_a_core_data_store_with_cloudkit/creating_a_core_data_model_for_cloudkit#3191035"
            },
            {
              "type": "text",
              "text": "."
            }
          ]
        },
        {
          "level": 3,
          "type": "heading",
          "text": "Set Up Your Development Environment",
          "anchor": "3222044"
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "You need an "
            },
            {
              "type": "link",
              "title": "Apple Developer Program",
              "destination": "https://developer.apple.com/programs/"
            },
            {
              "type": "text",
              "text": " account to access the CloudKit service and your team’s CloudKit containers during development."
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "You also need an iCloud account to save records to a CloudKit container. Core Data with CloudKit uses a specific record zone in the CloudKit private database, which is accessible only to the current user."
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "You can run and test Core Data with CloudKit apps using Simulator. You may also test with multiple physical devices logged into the same iCloud account. Connect all devices to a stable wireless internet connection to avoid network problems that could hinder synchronization."
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "For more information, see "
            },
            {
              "type": "link",
              "title": "Create an iCloud Account for Development",
              "destination": "https://developer.apple.com/library/archive/documentation/DataManagement/Conceptual/CloudKitQuickStart/EnablingiCloudandConfiguringCloudKit/EnablingiCloudandConfiguringCloudKit.html#//apple_ref/doc/uid/TP40014987-CH2-SW7"
            },
            {
              "type": "text",
              "text": "."
            }
          ]
        },
        {
          "level": 3,
          "type": "heading",
          "text": "Configure Core Data with CloudKit",
          "anchor": "3178619"
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "Add Core Data with CloudKit to your project as follows:"
            }
          ]
        },
        {
          "type": "orderedList",
          "items": [
            {
              "content": [
                {
                  "type": "paragraph",
                  "inlineContent": [
                    {
                      "type": "text",
                      "text": "Set up your Xcode project’s capabilities to enable CloudKit, and modify your Core Data stack setup to use "
                    },
                    {
                      "type": "reference",
                      "isActive": true,
                      "identifier": "doc://com.apple.documentation/documentation/coredata/nspersistentcloudkitcontainer"
                    },
                    {
                      "type": "text",
                      "text": ". See "
                    },
                    {
                      "type": "reference",
                      "isActive": true,
                      "identifier": "doc://com.apple.documentation/documentation/coredata/mirroring_a_core_data_store_with_cloudkit/setting_up_core_data_with_cloudkit"
                    },
                    {
                      "type": "text",
                      "text": "."
                    }
                  ]
                }
              ]
            },
            {
              "content": [
                {
                  "type": "paragraph",
                  "inlineContent": [
                    {
                      "type": "text",
                      "text": "Design your Core Data model, and use it to initialize the CloudKit schema. See "
                    },
                    {
                      "type": "reference",
                      "isActive": true,
                      "identifier": "doc://com.apple.documentation/documentation/coredata/mirroring_a_core_data_store_with_cloudkit/creating_a_core_data_model_for_cloudkit"
                    },
                    {
                      "type": "text",
                      "text": "."
                    }
                  ]
                }
              ]
            },
            {
              "content": [
                {
                  "type": "paragraph",
                  "inlineContent": [
                    {
                      "type": "text",
                      "text": "Modify your views to incorporate remote store changes at appropriate times. See "
                    },
                    {
                      "type": "reference",
                      "isActive": true,
                      "identifier": "doc://com.apple.documentation/documentation/coredata/mirroring_a_core_data_store_with_cloudkit/syncing_a_core_data_store_with_cloudkit"
                    },
                    {
                      "type": "text",
                      "text": ". "
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "Finally, if you are building custom features or writing a web app, discover how to work with the generated CloudKit schema in "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/coredata/mirroring_a_core_data_store_with_cloudkit/reading_cloudkit_records_for_core_data"
            },
            {
              "type": "text",
              "text": "."
            }
          ]
        }
      ]
    }
  ],
  "legalNotices": {
    "copyright": "Copyright &copy; 2021 Apple Inc. All rights reserved.",
    "termsOfUse": "https://www.apple.com/legal/internet-services/terms/site.html",
    "privacyPolicy": "https://www.apple.com/privacy/privacy-policy"
  }
}