{
  "abstract": [
    {
      "type": "text",
      "text": "Performs static validation of static signed code and returns detailed error information in the case of failure. "
    }
  ],
  "documentVersion": 0,
  "hierarchy": {
    "paths": [
      [
        "doc://com.apple.documentation/documentation/technologies",
        "doc://com.apple.documentation/documentation/security",
        "doc://com.apple.documentation/documentation/security/code_signing_services"
      ]
    ]
  },
  "identifier": {
    "url": "doc://com.apple.documentation/documentation/security/1395252-secstaticcodecheckvaliditywither",
    "interfaceLanguage": "occ"
  },
  "legacy_identifier": 1395252,
  "kind": "symbol",
  "metadata": {
    "title": "SecStaticCodeCheckValidityWithErrors",
    "role": "symbol",
    "roleHeading": "Function",
    "modules": [
      {
        "name": "Security"
      }
    ],
    "platforms": [
      {
        "name": "macOS",
        "introducedAt": "10.6",
        "current": "11.1"
      }
    ],
    "externalID": "c:@F@SecStaticCodeCheckValidityWithErrors",
    "symbolKind": "func"
  },
  "schemaVersion": {
    "major": 1,
    "minor": 0,
    "patch": 0
  },
  "sections": [],
  "variants": [
    {
      "traits": [
        {
          "interfaceLanguage": "occ"
        }
      ],
      "paths": [
        "documentation/security/1395252-secstaticcodecheckvaliditywither"
      ]
    },
    {
      "traits": [
        {
          "interfaceLanguage": "swift"
        }
      ],
      "paths": [
        "documentation/security/1395252-secstaticcodecheckvaliditywither"
      ]
    }
  ],
  "references": {
    "doc://com.apple.documentation/documentation/security": {
      "title": "Security",
      "identifier": "doc://com.apple.documentation/documentation/security",
      "url": "/documentation/security",
      "type": "topic",
      "kind": "symbol",
      "role": "collection"
    },
    "doc://com.apple.documentation/documentation/security/code_signing_services": {
      "title": "Code Signing Services",
      "identifier": "doc://com.apple.documentation/documentation/security/code_signing_services",
      "url": "/documentation/security/code_signing_services",
      "type": "topic",
      "kind": "article",
      "role": "collectionGroup"
    },
    "doc://com.apple.documentation/documentation/security/1574088-code_signing_services_result_cod": {
      "title": "Code Signing Services Result Codes",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/security/1574088-code_signing_services_result_cod",
      "kind": "symbol",
      "role": "containerSymbol",
      "url": "/documentation/security/1574088-code_signing_services_result_cod"
    },
    "doc://com.apple.documentation/documentation/security/1543778-static_code_validation_flags": {
      "title": "Static Code Validation Flags",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/security/1543778-static_code_validation_flags",
      "kind": "symbol",
      "role": "containerSymbol",
      "url": "/documentation/security/1543778-static_code_validation_flags",
      "abstract": [
        {
          "type": "text",
          "text": "Use these supplemental flags to test the validity of a static code signature."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/security/1543778-static_code_validation_flags/kseccscheckallarchitectures": {
      "title": "kSecCSCheckAllArchitectures",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/security/1543778-static_code_validation_flags/kseccscheckallarchitectures",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/security/1543778-static_code_validation_flags/kseccscheckallarchitectures"
    },
    "doc://com.apple.documentation/documentation/security/1394522-secrequirementcreatewithstring": {
      "title": "SecRequirementCreateWithString",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/security/1394522-secrequirementcreatewithstring",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/security/1394522-secrequirementcreatewithstring"
    },
    "doc://com.apple.documentation/documentation/security/1401166-secrequirementcreatewithstringan": {
      "title": "SecRequirementCreateWithStringAndErrors",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/security/1401166-secrequirementcreatewithstringan",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/security/1401166-secrequirementcreatewithstringan"
    },
    "devLink-1734079": {
      "identifier": "devLink-1734079",
      "type": "link",
      "title": "Code Signing Guide",
      "url": "https://developer.apple.com/library/archive/documentation/Security/Conceptual/CodeSigningGuide/Introduction/Introduction.html#//apple_ref/doc/uid/TP40005929"
    },
    "doc://com.apple.documentation/documentation/corefoundation/1494648-cferrorcopyuserinfo": {
      "title": "CFErrorCopyUserInfo",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/corefoundation/1494648-cferrorcopyuserinfo",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/corefoundation/1494648-cferrorcopyuserinfo"
    },
    "doc://com.apple.documentation/documentation/security/code_signing_services/user_info_dictionary_error_keys": {
      "title": "User Info Dictionary Error Keys",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/security/code_signing_services/user_info_dictionary_error_keys",
      "kind": "article",
      "role": "collectionGroup",
      "url": "/documentation/security/code_signing_services/user_info_dictionary_error_keys"
    },
    "doc://com.apple.documentation/documentation/security/1394237-secstaticcodecreatewithpathandat": {
      "title": "SecStaticCodeCreateWithPathAndAttributes",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/security/1394237-secstaticcodecreatewithpathandat",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/security/1394237-secstaticcodecreatewithpathandat"
    },
    "doc://com.apple.documentation/documentation/security/kseccodeattributearchitecture": {
      "title": "kSecCodeAttributeArchitecture",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/security/kseccodeattributearchitecture",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/security/kseccodeattributearchitecture"
    },
    "doc://com.apple.documentation/documentation/security/kseccodeattributesubarchitecture": {
      "title": "kSecCodeAttributeSubarchitecture",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/security/kseccodeattributesubarchitecture",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/security/kseccodeattributesubarchitecture"
    },
    "doc://com.apple.documentation/documentation/security/kseccodeattributeuniversalfileoffset": {
      "title": "kSecCodeAttributeUniversalFileOffset",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/security/kseccodeattributeuniversalfileoffset",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/security/kseccodeattributeuniversalfileoffset"
    },
    "doc://com.apple.documentation/documentation/security/1395272-seccodecheckvaliditywitherrors": {
      "title": "SecCodeCheckValidityWithErrors",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/security/1395272-seccodecheckvaliditywitherrors",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/security/1395272-seccodecheckvaliditywitherrors",
      "abstract": [
        {
          "type": "text",
          "text": "Performs dynamic validation of signed code and returns detailed error information in the case of failure."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/security/1395784-secstaticcodecheckvalidity": {
      "title": "SecStaticCodeCheckValidity",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/security/1395784-secstaticcodecheckvalidity",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/security/1395784-secstaticcodecheckvalidity",
      "abstract": [
        {
          "type": "text",
          "text": "Validates a static code object. "
        }
      ]
    },
    "doc://com.apple.documentation/documentation/security/secstaticcoderef": {
      "title": "SecStaticCodeRef",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/security/secstaticcoderef",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/security/secstaticcoderef"
    },
    "doc://com.apple.documentation/documentation/security/seccsflags": {
      "title": "SecCSFlags",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/security/seccsflags",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/security/seccsflags"
    },
    "doc://com.apple.documentation/documentation/security/secrequirementref": {
      "title": "SecRequirementRef",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/security/secrequirementref",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/security/secrequirementref"
    },
    "doc://com.apple.documentation/documentation/corefoundation/cferrorref": {
      "title": "CFErrorRef",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/corefoundation/cferrorref",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/corefoundation/cferrorref"
    },
    "doc://com.apple.documentation/documentation/security/1396726-seccodecheckvalidity": {
      "title": "SecCodeCheckValidity",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/security/1396726-seccodecheckvalidity",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/security/1396726-seccodecheckvalidity",
      "abstract": [
        {
          "type": "text",
          "text": "Performs dynamic validation of signed code."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/security/1395252-secstaticcodecheckvaliditywither": {
      "title": "SecStaticCodeCheckValidityWithErrors",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/security/1395252-secstaticcodecheckvaliditywither",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/security/1395252-secstaticcodecheckvaliditywither",
      "abstract": [
        {
          "type": "text",
          "text": "Performs static validation of static signed code and returns detailed error information in the case of failure. "
        }
      ]
    },
    "doc://com.apple.documentation/documentation/technologies": {
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/technologies",
      "url": "/documentation/technologies",
      "kind": "technologies",
      "title": "Technologies"
    }
  },
  "seeAlsoSections": [
    {
      "identifiers": [
        "doc://com.apple.documentation/documentation/security/1396726-seccodecheckvalidity",
        "doc://com.apple.documentation/documentation/security/1395272-seccodecheckvaliditywitherrors",
        "doc://com.apple.documentation/documentation/security/1395784-secstaticcodecheckvalidity",
        "doc://com.apple.documentation/documentation/security/1543778-static_code_validation_flags"
      ],
      "title": "Code Signature Validity",
      "generated": true
    }
  ],
  "primaryContentSections": [
    {
      "kind": "declarations",
      "declarations": [
        {
          "languages": [
            "occ"
          ],
          "tokens": [
            {
              "kind": "typeIdentifier",
              "preciseIdentifier": "c:@T@OSStatus",
              "identifier": "symbol-1480124",
              "text": "OSStatus"
            },
            {
              "kind": "text",
              "text": " "
            },
            {
              "kind": "identifier",
              "text": "SecStaticCodeCheckValidityWithErrors"
            },
            {
              "kind": "text",
              "text": "("
            },
            {
              "kind": "typeIdentifier",
              "preciseIdentifier": "c:@T@SecStaticCodeRef",
              "identifier": "doc://com.apple.documentation/documentation/security/secstaticcoderef",
              "text": "SecStaticCodeRef"
            },
            {
              "kind": "text",
              "text": " staticCode, "
            },
            {
              "kind": "typeIdentifier",
              "preciseIdentifier": "c:@T@SecCSFlags",
              "identifier": "doc://com.apple.documentation/documentation/security/seccsflags",
              "text": "SecCSFlags"
            },
            {
              "kind": "text",
              "text": " flags, "
            },
            {
              "kind": "typeIdentifier",
              "preciseIdentifier": "c:@T@SecRequirementRef",
              "identifier": "doc://com.apple.documentation/documentation/security/secrequirementref",
              "text": "SecRequirementRef"
            },
            {
              "kind": "text",
              "text": " requirement, "
            },
            {
              "kind": "typeIdentifier",
              "preciseIdentifier": "c:@T@CFErrorRef",
              "identifier": "doc://com.apple.documentation/documentation/corefoundation/cferrorref",
              "text": "CFErrorRef"
            },
            {
              "kind": "text",
              "text": "  "
            },
            {
              "kind": "keyword",
              "text": "_Nullable"
            },
            {
              "kind": "text",
              "text": " *errors);"
            }
          ],
          "platforms": [
            "macOS"
          ]
        }
      ]
    },
    {
      "kind": "parameters",
      "languages": [
        "occ"
      ],
      "parameters": [
        {
          "name": "staticCode",
          "content": [
            {
              "type": "paragraph",
              "inlineContent": [
                {
                  "type": "text",
                  "text": "The code object to be validated."
                }
              ]
            }
          ]
        },
        {
          "name": "flags",
          "content": [
            {
              "type": "paragraph",
              "inlineContent": [
                {
                  "type": "text",
                  "text": "Optional flags; see "
                },
                {
                  "type": "reference",
                  "isActive": true,
                  "identifier": "doc://com.apple.documentation/documentation/security/1543778-static_code_validation_flags"
                },
                {
                  "type": "text",
                  "text": " for possible values. Use "
                },
                {
                  "type": "reference",
                  "isActive": true,
                  "identifier": "doc://com.apple.documentation/documentation/security/1543778-static_code_validation_flags/kseccscheckallarchitectures"
                },
                {
                  "type": "text",
                  "text": " to validate all slices of a universal binary."
                }
              ]
            }
          ]
        },
        {
          "name": "requirement",
          "content": [
            {
              "type": "paragraph",
              "inlineContent": [
                {
                  "type": "text",
                  "text": "A code requirement specifying additional conditions the code must satisfy to be considered valid. Specify "
                },
                {
                  "type": "codeVoice",
                  "code": "NULL"
                },
                {
                  "type": "text",
                  "text": " if you don’t want to impose any additional requirements. Use the "
                },
                {
                  "type": "reference",
                  "isActive": true,
                  "identifier": "doc://com.apple.documentation/documentation/security/1394522-secrequirementcreatewithstring"
                },
                {
                  "type": "text",
                  "text": " or "
                },
                {
                  "type": "reference",
                  "isActive": true,
                  "identifier": "doc://com.apple.documentation/documentation/security/1401166-secrequirementcreatewithstringan"
                },
                {
                  "type": "text",
                  "text": " function to create a code requirement object. See "
                },
                {
                  "type": "link",
                  "title": "Code Signing Guide",
                  "destination": "https://developer.apple.com/library/archive/documentation/Security/Conceptual/CodeSigningGuide/Introduction/Introduction.html#//apple_ref/doc/uid/TP40005929"
                },
                {
                  "type": "text",
                  "text": " for a discussion of code requirements."
                }
              ]
            }
          ]
        },
        {
          "name": "errors",
          "content": [
            {
              "type": "paragraph",
              "inlineContent": [
                {
                  "type": "text",
                  "text": "On return, if the function call fails and returns a result code other than "
                },
                {
                  "type": "codeVoice",
                  "code": "errSecSuccess"
                },
                {
                  "type": "text",
                  "text": ", points to an error object further describing the nature and circumstances of the failure. Use the "
                },
                {
                  "type": "reference",
                  "isActive": true,
                  "identifier": "doc://com.apple.documentation/documentation/corefoundation/1494648-cferrorcopyuserinfo"
                },
                {
                  "type": "text",
                  "text": " function to retrieve the user info dictionary from the error object. See "
                },
                {
                  "type": "reference",
                  "isActive": true,
                  "identifier": "doc://com.apple.documentation/documentation/security/code_signing_services/user_info_dictionary_error_keys"
                },
                {
                  "type": "text",
                  "text": " for possible values. Pass "
                },
                {
                  "type": "codeVoice",
                  "code": "NULL"
                },
                {
                  "type": "text",
                  "text": " if you do not want this information. Call the "
                },
                {
                  "type": "codeVoice",
                  "code": "CFRelease"
                },
                {
                  "type": "text",
                  "text": " function to release this object when you are finished with it."
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "kind": "content",
      "content": [
        {
          "anchor": "return_value",
          "level": 2,
          "text": "Return Value",
          "type": "heading"
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "A result code. See "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/security/1574088-code_signing_services_result_cod"
            },
            {
              "type": "text",
              "text": "."
            }
          ]
        }
      ]
    },
    {
      "kind": "content",
      "content": [
        {
          "anchor": "discussion",
          "level": 2,
          "text": "Discussion",
          "type": "heading"
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "This function obtains and verifies the signature on the code specified by the code object. It checks the validity of all sealed components, including resources (if any). It validates the code against a code requirement if one is specified. The call succeeds if all these conditions are satisfactory."
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "This call is only secure if the code is not subject to concurrent modification, and the outcome is only valid as long as the code remains unmodified. If the underlying file system has dynamic characteristics, such as a network file system, union mount, or FUSE, you must consider how secure the code is from modification after validation."
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "When checking a universal binary, include the "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/security/1543778-static_code_validation_flags/kseccscheckallarchitectures"
            },
            {
              "type": "text",
              "text": " flag. Otherwise the method verifies only one slice of the binary, potentially indicating success without testing all the slices. Be aware that the slices of a universal binary don’t have to be signed by the same signer for the test to pass. One slice might be ad hoc signed, for example. But the validity check doesn’t know which slice you are going to run. For example, the user might use the arch(1) command line utility to pick a 32-bit architecture even though a 64-bit architecture is available."
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "If you want to be sure to test a particular slice, create the static code object with the "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/security/1394237-secstaticcodecreatewithpathandat"
            },
            {
              "type": "text",
              "text": " method using the "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/security/kseccodeattributearchitecture"
            },
            {
              "type": "text",
              "text": " and "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/security/kseccodeattributesubarchitecture"
            },
            {
              "type": "text",
              "text": " attributes (if you know the architecture) or the "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/security/kseccodeattributeuniversalfileoffset"
            },
            {
              "type": "text",
              "text": " attribute (if you know the offset into the universal binary)."
            }
          ]
        }
      ]
    }
  ],
  "legalNotices": {
    "copyright": "Copyright &copy; 2020 Apple Inc. All rights reserved.",
    "termsOfUse": "https://www.apple.com/legal/internet-services/terms/site.html",
    "privacyPolicy": "https://www.apple.com/privacy/privacy-policy"
  }
}