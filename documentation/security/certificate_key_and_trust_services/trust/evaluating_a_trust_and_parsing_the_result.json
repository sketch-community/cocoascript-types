{
  "abstract": [
    {
      "type": "text",
      "text": "Learn what to expect when evaluating a trust object."
    }
  ],
  "documentVersion": 0,
  "hierarchy": {
    "paths": [
      [
        "doc://com.apple.documentation/documentation/technologies",
        "doc://com.apple.documentation/documentation/security",
        "doc://com.apple.documentation/documentation/security/certificate_key_and_trust_services",
        "doc://com.apple.documentation/documentation/security/certificate_key_and_trust_services/trust"
      ]
    ]
  },
  "identifier": {
    "url": "doc://com.apple.documentation/documentation/security/certificate_key_and_trust_services/trust/evaluating_a_trust_and_parsing_the_result",
    "interfaceLanguage": "occ"
  },
  "legacy_identifier": 2864445,
  "kind": "article",
  "metadata": {
    "title": "Evaluating a Trust and Parsing the Result",
    "role": "article",
    "roleHeading": "Article",
    "modules": [
      {
        "name": "Security"
      }
    ]
  },
  "schemaVersion": {
    "major": 0,
    "minor": 1,
    "patch": 0
  },
  "sections": [],
  "variants": [
    {
      "traits": [
        {
          "interfaceLanguage": "occ"
        }
      ],
      "paths": [
        "documentation/security/certificate_key_and_trust_services/trust/evaluating_a_trust_and_parsing_the_result"
      ]
    },
    {
      "traits": [
        {
          "interfaceLanguage": "swift"
        }
      ],
      "paths": [
        "documentation/security/certificate_key_and_trust_services/trust/evaluating_a_trust_and_parsing_the_result"
      ]
    }
  ],
  "references": {
    "doc://com.apple.documentation/documentation/security": {
      "title": "Security",
      "identifier": "doc://com.apple.documentation/documentation/security",
      "url": "/documentation/security",
      "type": "topic",
      "kind": "symbol",
      "role": "collection"
    },
    "doc://com.apple.documentation/documentation/security/certificate_key_and_trust_services": {
      "title": "Certificate, Key, and Trust Services",
      "identifier": "doc://com.apple.documentation/documentation/security/certificate_key_and_trust_services",
      "url": "/documentation/security/certificate_key_and_trust_services",
      "type": "topic",
      "kind": "article",
      "role": "collectionGroup"
    },
    "doc://com.apple.documentation/documentation/security/certificate_key_and_trust_services/trust": {
      "title": "Trust",
      "identifier": "doc://com.apple.documentation/documentation/security/certificate_key_and_trust_services/trust",
      "url": "/documentation/security/certificate_key_and_trust_services/trust",
      "type": "topic",
      "kind": "article",
      "role": "collectionGroup"
    },
    "doc://com.apple.documentation/documentation/security/certificate_key_and_trust_services/trust/creating_a_trust_object": {
      "title": "Creating a Trust Object",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/security/certificate_key_and_trust_services/trust/creating_a_trust_object",
      "kind": "article",
      "role": "article",
      "url": "/documentation/security/certificate_key_and_trust_services/trust/creating_a_trust_object"
    },
    "doc://com.apple.documentation/documentation/security/3235761-sectrustevaluateasyncwitherror": {
      "title": "SecTrustEvaluateAsyncWithError",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/security/3235761-sectrustevaluateasyncwitherror",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/security/3235761-sectrustevaluateasyncwitherror",
      "abstract": [
        {
          "type": "text",
          "text": "Evaluates a trust object asynchronously on the specified dispatch queue."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/security/certificate_key_and_trust_services/trust/evaluating_a_trust_and_parsing_the_result#2864449": {
      "title": "Listing 1",
      "type": "section",
      "identifier": "doc://com.apple.documentation/documentation/security/certificate_key_and_trust_services/trust/evaluating_a_trust_and_parsing_the_result#2864449",
      "kind": "article",
      "role": "codeListing",
      "url": "/documentation/security/certificate_key_and_trust_services/trust/evaluating_a_trust_and_parsing_the_result#2864449"
    },
    "doc://com.apple.documentation/documentation/security/1396135-sectrustcopypublickey": {
      "title": "SecTrustCopyPublicKey",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/security/1396135-sectrustcopypublickey",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/security/1396135-sectrustcopypublickey"
    },
    "doc://com.apple.documentation/documentation/security/certificate_key_and_trust_services/keys/getting_an_existing_key": {
      "title": "Getting an Existing Key",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/security/certificate_key_and_trust_services/keys/getting_an_existing_key",
      "kind": "article",
      "role": "article",
      "url": "/documentation/security/certificate_key_and_trust_services/keys/getting_an_existing_key"
    },
    "doc://com.apple.documentation/documentation/security/certificate_key_and_trust_services/trust/discovering_why_a_trust_evaluation_failed": {
      "title": "Discovering Why a Trust Evaluation Failed",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/security/certificate_key_and_trust_services/trust/discovering_why_a_trust_evaluation_failed",
      "kind": "article",
      "role": "article",
      "url": "/documentation/security/certificate_key_and_trust_services/trust/discovering_why_a_trust_evaluation_failed"
    },
    "doc://com.apple.documentation/documentation/security/certificate_key_and_trust_services/trust/evaluating_a_trust_and_parsing_the_result": {
      "title": "Evaluating a Trust and Parsing the Result",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/security/certificate_key_and_trust_services/trust/evaluating_a_trust_and_parsing_the_result",
      "kind": "article",
      "role": "article",
      "url": "/documentation/security/certificate_key_and_trust_services/trust/evaluating_a_trust_and_parsing_the_result",
      "abstract": [
        {
          "type": "text",
          "text": "Learn what to expect when evaluating a trust object."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/security/2980705-sectrustevaluatewitherror": {
      "title": "SecTrustEvaluateWithError",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/security/2980705-sectrustevaluatewitherror",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/security/2980705-sectrustevaluatewitherror",
      "abstract": [
        {
          "type": "text",
          "text": "Evaluates trust for the specified certificate and policies."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/security/sectrustwitherrorcallback": {
      "title": "SecTrustWithErrorCallback",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/security/sectrustwitherrorcallback",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/security/sectrustwitherrorcallback",
      "abstract": [
        {
          "type": "text",
          "text": "A block called with the results of an asynchronous trust evaluation."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/technologies": {
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/technologies",
      "url": "/documentation/technologies",
      "kind": "technologies",
      "title": "Technologies"
    }
  },
  "seeAlsoSections": [
    {
      "identifiers": [
        "doc://com.apple.documentation/documentation/security/2980705-sectrustevaluatewitherror",
        "doc://com.apple.documentation/documentation/security/3235761-sectrustevaluateasyncwitherror",
        "doc://com.apple.documentation/documentation/security/sectrustwitherrorcallback"
      ],
      "title": "Trust Evaluation",
      "generated": true
    }
  ],
  "primaryContentSections": [
    {
      "kind": "content",
      "content": [
        {
          "anchor": "overview",
          "level": 2,
          "text": "Overview",
          "type": "heading"
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "Using the trust object that you obtained in "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/security/certificate_key_and_trust_services/trust/creating_a_trust_object"
            },
            {
              "type": "text",
              "text": ", you evaluate it with the "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/security/3235761-sectrustevaluateasyncwitherror"
            },
            {
              "type": "text",
              "text": " method:"
            }
          ]
        },
        {
          "type": "codeListing",
          "code": [
            "dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{",
            "    SecTrustEvaluateAsyncWithError(",
            "        trust,",
            "        dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0),",
            "        ^(SecTrustRef evaluatedTrust, bool trustResult, CFErrorRef error) {",
            "            if (trustResult == YES) {",
            "                // Evaluation succeeded!",
            "                SecKeyRef publicKey = SecTrustCopyPublicKey(evaluatedTrust);",
            " ",
            "                // Use and release key . . .",
            " ",
            "            } else {",
            "                // Evaluation failed: Check the error",
            "            }",
            " ",
            "            // Finally, release the trust and error.",
            "            if (evaluatedTrust) { CFRelease(evaluatedTrust); }",
            "            if (error)          { CFRelease(error); }",
            "        }",
            "    );",
            "});"
          ],
          "syntax": "occ",
          "metadata": {
            "anchor": "2864449",
            "title": "Listing 1"
          }
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "If the trust object already has a result, the evaluation might invoke the callback synchronously, before the method returns. In other cases, like when the evaluation needs to fetch intermediate certificates or perform revocation checking, it might instead return immediately, perform the evaluation asynchronously, and call the closure later with a result. Either way, you must call the evaluation method on the same thread that you specify for the closure."
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "When the evaluation finishes and the method invokes the callback, examine the "
            },
            {
              "type": "codeVoice",
              "code": "result"
            },
            {
              "type": "text",
              "text": " parameter. If the trust result is "
            },
            {
              "type": "codeVoice",
              "code": "true"
            },
            {
              "type": "text",
              "text": ", the evaluation succeeded. At this point, you can get the public key from the leaf certificate with "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/security/1396135-sectrustcopypublickey"
            },
            {
              "type": "text",
              "text": ", as explained in "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/security/certificate_key_and_trust_services/keys/getting_an_existing_key"
            },
            {
              "type": "text",
              "text": ", and begin to use it. If the result is "
            },
            {
              "type": "codeVoice",
              "code": "false"
            },
            {
              "type": "text",
              "text": ", you might be able to recover from the failure, as described in "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/security/certificate_key_and_trust_services/trust/discovering_why_a_trust_evaluation_failed"
            },
            {
              "type": "text",
              "text": ". If you can’t recover—for example, because the certificate is revoked—handle the failure gracefully."
            }
          ]
        }
      ]
    }
  ],
  "legalNotices": {
    "copyright": "Copyright &copy; 2021 Apple Inc. All rights reserved.",
    "termsOfUse": "https://www.apple.com/legal/internet-services/terms/site.html",
    "privacyPolicy": "https://www.apple.com/privacy/privacy-policy"
  }
}