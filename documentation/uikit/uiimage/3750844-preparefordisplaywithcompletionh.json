{
  "abstract": [
    {
      "type": "text",
      "text": "Decodes an image asynchronously and provides a new one for display in views and animations."
    }
  ],
  "documentVersion": 0,
  "hierarchy": {
    "paths": [
      [
        "doc://com.apple.documentation/documentation/technologies",
        "doc://com.apple.documentation/documentation/uikit",
        "doc://com.apple.documentation/documentation/uikit/images_and_pdf",
        "doc://com.apple.documentation/documentation/uikit/uiimage"
      ]
    ]
  },
  "identifier": {
    "url": "doc://com.apple.documentation/documentation/uikit/uiimage/3750844-preparefordisplaywithcompletionh",
    "interfaceLanguage": "occ"
  },
  "legacy_identifier": 3750844,
  "kind": "symbol",
  "metadata": {
    "title": "prepareForDisplayWithCompletionHandler:",
    "role": "symbol",
    "roleHeading": "Instance Method",
    "modules": [
      {
        "name": "UIKit"
      }
    ],
    "platforms": [
      {
        "name": "iOS",
        "introducedAt": "15.0",
        "current": "15.2"
      },
      {
        "name": "iPadOS",
        "introducedAt": "15.0",
        "current": "15.2"
      },
      {
        "name": "Mac Catalyst",
        "introducedAt": "15.0",
        "current": "15.2"
      },
      {
        "name": "tvOS",
        "introducedAt": "15.0",
        "current": "15.2"
      }
    ],
    "externalID": "c:objc(cs)UIImage(im)prepareForDisplayWithCompletionHandler:",
    "parent": {
      "title": "UIImage"
    },
    "symbolKind": "instm"
  },
  "schemaVersion": {
    "major": 0,
    "minor": 1,
    "patch": 0
  },
  "sections": [],
  "variants": [
    {
      "traits": [
        {
          "interfaceLanguage": "occ"
        }
      ],
      "paths": [
        "documentation/uikit/uiimage/3750844-preparefordisplaywithcompletionh"
      ]
    },
    {
      "traits": [
        {
          "interfaceLanguage": "swift"
        }
      ],
      "paths": [
        "documentation/uikit/uiimage/3750844-preparefordisplay"
      ]
    }
  ],
  "references": {
    "doc://com.apple.documentation/documentation/uikit": {
      "title": "UIKit",
      "identifier": "doc://com.apple.documentation/documentation/uikit",
      "url": "/documentation/uikit",
      "type": "topic",
      "kind": "symbol",
      "role": "collection"
    },
    "doc://com.apple.documentation/documentation/uikit/images_and_pdf": {
      "title": "Images and PDF",
      "identifier": "doc://com.apple.documentation/documentation/uikit/images_and_pdf",
      "url": "/documentation/uikit/images_and_pdf",
      "type": "topic",
      "kind": "article",
      "role": "collectionGroup"
    },
    "doc://com.apple.documentation/documentation/uikit/uiimage": {
      "title": "UIImage",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/uikit/uiimage",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/uikit/uiimage"
    },
    "link-3807531": {
      "title": "instrument",
      "type": "topic",
      "identifier": "link-3807531",
      "kind": "article",
      "role": "link",
      "url": "https://help.apple.com/instruments/mac/current/"
    },
    "doc://com.apple.documentation/documentation/uikit/uilistcontentconfiguration/3601033-image": {
      "title": "image",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/uikit/uilistcontentconfiguration/3601033-image",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/uikit/uilistcontentconfiguration/3601033-image"
    },
    "doc://com.apple.documentation/documentation/uikit/uiimageview": {
      "title": "UIImageView",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/uikit/uiimageview",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/uikit/uiimageview"
    },
    "doc://com.apple.documentation/documentation/coreimage/ciimage": {
      "title": "CIImage",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/coreimage/ciimage",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/coreimage/ciimage"
    },
    "doc://com.apple.documentation/documentation/uikit/uiimage/3750844-preparefordisplaywithcompletionh#3782906": {
      "title": "Listing 1",
      "type": "section",
      "identifier": "doc://com.apple.documentation/documentation/uikit/uiimage/3750844-preparefordisplaywithcompletionh#3782906",
      "kind": "article",
      "role": "codeListing",
      "url": "/documentation/uikit/uiimage/3750844-preparefordisplaywithcompletionh#3782906"
    },
    "doc://com.apple.documentation/documentation/technologies": {
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/technologies",
      "url": "/documentation/technologies",
      "kind": "technologies",
      "title": "Technologies"
    }
  },
  "primaryContentSections": [
    {
      "kind": "declarations",
      "declarations": [
        {
          "languages": [
            "occ"
          ],
          "tokens": [
            {
              "kind": "text",
              "text": "- ("
            },
            {
              "kind": "keyword",
              "text": "void"
            },
            {
              "kind": "text",
              "text": ")"
            },
            {
              "kind": "identifier",
              "text": "prepareForDisplayWithCompletionHandler:"
            },
            {
              "kind": "text",
              "text": "("
            },
            {
              "kind": "keyword",
              "text": "void"
            },
            {
              "kind": "text",
              "text": " (^)("
            },
            {
              "kind": "typeIdentifier",
              "preciseIdentifier": "c:objc(cs)UIImage",
              "identifier": "doc://com.apple.documentation/documentation/uikit/uiimage",
              "text": "UIImage"
            },
            {
              "kind": "text",
              "text": " *)"
            },
            {
              "kind": "text",
              "text": ")"
            },
            {
              "kind": "internalParam",
              "text": "completionHandler"
            },
            {
              "kind": "text",
              "text": ";"
            }
          ],
          "platforms": [
            "iOS",
            "iPadOS",
            "Mac Catalyst",
            "tvOS"
          ]
        }
      ]
    },
    {
      "kind": "parameters",
      "languages": [
        "occ"
      ],
      "parameters": [
        {
          "name": "completionHandler",
          "content": [
            {
              "type": "paragraph",
              "inlineContent": [
                {
                  "type": "text",
                  "text": "The closure to call when the function finishes preparing the image."
                }
              ]
            },
            {
              "type": "paragraph",
              "inlineContent": [
                {
                  "type": "text",
                  "text": "This completion handler takes one parameter:"
                }
              ]
            },
            {
              "type": "termList",
              "items": [
                {
                  "term": {
                    "inlineContent": [
                      {
                        "type": "codeVoice",
                        "code": "image"
                      }
                    ]
                  },
                  "definition": {
                    "content": [
                      {
                        "type": "paragraph",
                        "inlineContent": [
                          {
                            "type": "text",
                            "text": "A new version of the image object for display. If the system can’t decode the image, the parameter value is "
                          },
                          {
                            "type": "codeVoice",
                            "code": "nil."
                          }
                        ]
                      }
                    ]
                  }
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "kind": "content",
      "content": [
        {
          "anchor": "discussion",
          "level": 2,
          "text": "Discussion",
          "type": "heading"
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "The Animation Hitches "
            },
            {
              "type": "link",
              "title": "instrument",
              "destination": "https://help.apple.com/instruments/mac/current/"
            },
            {
              "type": "text",
              "text": " measures system performance for multiple stages of preparing views for display. It can show you the exact cause of an animation hitch, which appears to the user as an interruption or jump in an animation that should be smooth. If Animation Hitches indicates that decoding an image takes too long and causes hitches, use this method to move the decoding work to the background."
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": " This method creates a new image object and passes it to the completion handler. The new image is ready for efficient display by an image view. Assign the image this method creates to the "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/uikit/uilistcontentconfiguration/3601033-image"
            },
            {
              "type": "text",
              "text": " property of an image view. If "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/uikit/uiimageview"
            },
            {
              "type": "text",
              "text": " can render the image without decoding, this method passes the completion handler a valid image without further processing. If the system can’t decode the image, such as an image created from a "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/coreimage/ciimage"
            },
            {
              "type": "text",
              "text": ", the method passes "
            },
            {
              "type": "codeVoice",
              "code": "nil"
            },
            {
              "type": "text",
              "text": " to the completion handler"
            },
            {
              "type": "codeVoice",
              "code": "."
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "UIKit doesn’t associate the prepared image with the original, or with any related variants from an asset catalog. If your app environment dynamically changes display traits, listen for changes in the trait environment and prepare new images when the environment changes."
            }
          ]
        },
        {
          "type": "codeListing",
          "code": [
            "func collectionView(_ collectionView: UICollectionView, prefetchItemsAt indexPaths: [IndexPath]) {",
            "    for path in indexPaths {",
            "        let item = models[path.item]",
            "        if preparedImageCache.object(forKey: item.id) == nil {",
            "            item.loadAsset()",
            "            item.image.prepareForDisplay { [weak preparedImageCache] preparedImage in",
            "                if let preparedImage = preparedImage {",
            "                    preparedImageCache?.setObject(preparedImage, forKey: item.id)",
            "                }",
            "            }",
            "        }",
            "    }",
            "}"
          ],
          "syntax": "swift",
          "metadata": {
            "anchor": "3782906",
            "title": "Listing 1"
          }
        },
        {
          "type": "paragraph",
          "inlineContent": []
        }
      ]
    }
  ],
  "legalNotices": {
    "copyright": "Copyright &copy; 2021 Apple Inc. All rights reserved.",
    "termsOfUse": "https://www.apple.com/legal/internet-services/terms/site.html",
    "privacyPolicy": "https://www.apple.com/privacy/privacy-policy"
  }
}