{
  "abstract": [
    {
      "type": "text",
      "text": "Insert, delete, and manipulate text by using a proxy to a text input view."
    }
  ],
  "documentVersion": 0,
  "hierarchy": {
    "paths": [
      [
        "doc://com.apple.documentation/documentation/technologies",
        "doc://com.apple.documentation/documentation/uikit",
        "doc://com.apple.documentation/documentation/uikit/keyboards_and_input",
        "doc://com.apple.documentation/documentation/uikit/keyboards_and_input/creating_a_custom_keyboard"
      ]
    ]
  },
  "identifier": {
    "url": "doc://com.apple.documentation/documentation/uikit/keyboards_and_input/creating_a_custom_keyboard/handling_text_interactions_in_custom_keyboards",
    "interfaceLanguage": "occ"
  },
  "legacy_identifier": 3570314,
  "kind": "article",
  "metadata": {
    "title": "Handling Text Interactions in Custom Keyboards",
    "role": "article",
    "roleHeading": "Article",
    "modules": [
      {
        "name": "UIKit"
      }
    ]
  },
  "schemaVersion": {
    "major": 0,
    "minor": 1,
    "patch": 0
  },
  "sections": [],
  "variants": [
    {
      "traits": [
        {
          "interfaceLanguage": "occ"
        }
      ],
      "paths": [
        "documentation/uikit/keyboards_and_input/creating_a_custom_keyboard/handling_text_interactions_in_custom_keyboards"
      ]
    },
    {
      "traits": [
        {
          "interfaceLanguage": "swift"
        }
      ],
      "paths": [
        "documentation/uikit/keyboards_and_input/creating_a_custom_keyboard/handling_text_interactions_in_custom_keyboards"
      ]
    }
  ],
  "references": {
    "doc://com.apple.documentation/documentation/uikit": {
      "title": "UIKit",
      "identifier": "doc://com.apple.documentation/documentation/uikit",
      "url": "/documentation/uikit",
      "type": "topic",
      "kind": "symbol",
      "role": "collection"
    },
    "doc://com.apple.documentation/documentation/uikit/keyboards_and_input": {
      "title": "Keyboards and Input",
      "identifier": "doc://com.apple.documentation/documentation/uikit/keyboards_and_input",
      "url": "/documentation/uikit/keyboards_and_input",
      "type": "topic",
      "kind": "article",
      "role": "collectionGroup"
    },
    "doc://com.apple.documentation/documentation/uikit/keyboards_and_input/creating_a_custom_keyboard": {
      "title": "Creating a Custom Keyboard",
      "identifier": "doc://com.apple.documentation/documentation/uikit/keyboards_and_input/creating_a_custom_keyboard",
      "url": "/documentation/uikit/keyboards_and_input/creating_a_custom_keyboard",
      "type": "topic",
      "kind": "article",
      "role": "article"
    },
    "doc://com.apple.documentation/documentation/uikit/uikeyinput": {
      "title": "UIKeyInput",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/uikit/uikeyinput",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/uikit/uikeyinput"
    },
    "doc://com.apple.documentation/documentation/uikit/keyboards_and_input/creating_a_custom_keyboard/handling_text_interactions_in_custom_keyboards#3570309": {
      "title": "Listing 1",
      "type": "section",
      "identifier": "doc://com.apple.documentation/documentation/uikit/keyboards_and_input/creating_a_custom_keyboard/handling_text_interactions_in_custom_keyboards#3570309",
      "kind": "article",
      "role": "codeListing",
      "url": "/documentation/uikit/keyboards_and_input/creating_a_custom_keyboard/handling_text_interactions_in_custom_keyboards#3570309"
    },
    "doc://com.apple.documentation/documentation/uikit/keyboards_and_input/creating_a_custom_keyboard/handling_text_interactions_in_custom_keyboards#3570305": {
      "title": "Listing 2",
      "type": "section",
      "identifier": "doc://com.apple.documentation/documentation/uikit/keyboards_and_input/creating_a_custom_keyboard/handling_text_interactions_in_custom_keyboards#3570305",
      "kind": "article",
      "role": "codeListing",
      "url": "/documentation/uikit/keyboards_and_input/creating_a_custom_keyboard/handling_text_interactions_in_custom_keyboards#3570305"
    },
    "doc://com.apple.documentation/documentation/uikit/uikeyinput/1614457-hastext": {
      "title": "hasText",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/uikit/uikeyinput/1614457-hastext",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/uikit/uikeyinput/1614457-hastext"
    },
    "doc://com.apple.documentation/documentation/uikit/keyboards_and_input/creating_a_custom_keyboard/handling_text_interactions_in_custom_keyboards#3592486": {
      "title": "Listing 3",
      "type": "section",
      "identifier": "doc://com.apple.documentation/documentation/uikit/keyboards_and_input/creating_a_custom_keyboard/handling_text_interactions_in_custom_keyboards#3592486",
      "kind": "article",
      "role": "codeListing",
      "url": "/documentation/uikit/keyboards_and_input/creating_a_custom_keyboard/handling_text_interactions_in_custom_keyboards#3592486"
    },
    "doc://com.apple.documentation/documentation/uikit/uitextdocumentproxy/1618194-adjusttextpositionbycharacteroff": {
      "title": "adjustTextPositionByCharacterOffset:",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/uikit/uitextdocumentproxy/1618194-adjusttextpositionbycharacteroff",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/uikit/uitextdocumentproxy/1618194-adjusttextpositionbycharacteroff",
      "fragments": [
        {
          "kind": "text",
          "text": "- "
        },
        {
          "kind": "identifier",
          "text": "adjustTextPositionByCharacterOffset:"
        }
      ]
    },
    "doc://com.apple.documentation/documentation/uikit/keyboards_and_input/creating_a_custom_keyboard/handling_text_interactions_in_custom_keyboards#3570315": {
      "title": "Listing 4",
      "type": "section",
      "identifier": "doc://com.apple.documentation/documentation/uikit/keyboards_and_input/creating_a_custom_keyboard/handling_text_interactions_in_custom_keyboards#3570315",
      "kind": "article",
      "role": "codeListing",
      "url": "/documentation/uikit/keyboards_and_input/creating_a_custom_keyboard/handling_text_interactions_in_custom_keyboards#3570315"
    },
    "doc://com.apple.documentation/documentation/uikit/uiinputviewcontroller": {
      "title": "UIInputViewController",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/uikit/uiinputviewcontroller",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/uikit/uiinputviewcontroller"
    },
    "doc://com.apple.documentation/documentation/uikit/uitextinputdelegate": {
      "title": "UITextInputDelegate",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/uikit/uitextinputdelegate",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/uikit/uitextinputdelegate"
    },
    "doc://com.apple.documentation/documentation/uikit/keyboards_and_input/creating_a_custom_keyboard/handling_text_interactions_in_custom_keyboards#3570456": {
      "title": "Listing 5",
      "type": "section",
      "identifier": "doc://com.apple.documentation/documentation/uikit/keyboards_and_input/creating_a_custom_keyboard/handling_text_interactions_in_custom_keyboards#3570456",
      "kind": "article",
      "role": "codeListing",
      "url": "/documentation/uikit/keyboards_and_input/creating_a_custom_keyboard/handling_text_interactions_in_custom_keyboards#3570456"
    },
    "doc://com.apple.documentation/documentation/uikit/keyboards_and_input/creating_a_custom_keyboard/handling_text_interactions_in_custom_keyboards#3570300": {
      "title": "Listing 6",
      "type": "section",
      "identifier": "doc://com.apple.documentation/documentation/uikit/keyboards_and_input/creating_a_custom_keyboard/handling_text_interactions_in_custom_keyboards#3570300",
      "kind": "article",
      "role": "codeListing",
      "url": "/documentation/uikit/keyboards_and_input/creating_a_custom_keyboard/handling_text_interactions_in_custom_keyboards#3570300"
    },
    "doc://com.apple.documentation/documentation/corefoundation/cfstringtokenizer": {
      "title": "CFStringTokenizer",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/corefoundation/cfstringtokenizer",
      "kind": "article",
      "role": "collectionGroup",
      "url": "/documentation/corefoundation/cfstringtokenizer"
    },
    "doc://com.apple.documentation/documentation/uikit/uitextdocumentproxy/1618190-documentcontextbeforeinput": {
      "title": "documentContextBeforeInput",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/uikit/uitextdocumentproxy/1618190-documentcontextbeforeinput",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/uikit/uitextdocumentproxy/1618190-documentcontextbeforeinput"
    },
    "doc://com.apple.documentation/documentation/uikit/uikeyinput/1614572-deletebackward": {
      "title": "deleteBackward",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/uikit/uikeyinput/1614572-deletebackward",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/uikit/uikeyinput/1614572-deletebackward",
      "fragments": [
        {
          "kind": "text",
          "text": "- "
        },
        {
          "kind": "identifier",
          "text": "deleteBackward"
        }
      ]
    },
    "doc://com.apple.documentation/documentation/uikit/uikeyinput/1614543-inserttext": {
      "title": "insertText:",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/uikit/uikeyinput/1614543-inserttext",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/uikit/uikeyinput/1614543-inserttext",
      "fragments": [
        {
          "kind": "text",
          "text": "- "
        },
        {
          "kind": "identifier",
          "text": "insertText:"
        }
      ]
    },
    "doc://com.apple.documentation/documentation/uikit/uitextdocumentproxy": {
      "title": "UITextDocumentProxy",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/uikit/uitextdocumentproxy",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/uikit/uitextdocumentproxy"
    },
    "doc://com.apple.documentation/documentation/uikit/uitextdocumentproxy/3152923-setmarkedtext": {
      "title": "setMarkedText:selectedRange:",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/uikit/uitextdocumentproxy/3152923-setmarkedtext",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/uikit/uitextdocumentproxy/3152923-setmarkedtext",
      "fragments": [
        {
          "kind": "text",
          "text": "- "
        },
        {
          "kind": "identifier",
          "text": "setMarkedText:selectedRange:"
        }
      ]
    },
    "doc://com.apple.documentation/documentation/uikit/keyboards_and_input/creating_a_custom_keyboard/handling_text_interactions_in_custom_keyboards#3570311": {
      "title": "Listing 7",
      "type": "section",
      "identifier": "doc://com.apple.documentation/documentation/uikit/keyboards_and_input/creating_a_custom_keyboard/handling_text_interactions_in_custom_keyboards#3570311",
      "kind": "article",
      "role": "codeListing",
      "url": "/documentation/uikit/keyboards_and_input/creating_a_custom_keyboard/handling_text_interactions_in_custom_keyboards#3570311"
    },
    "doc://com.apple.documentation/documentation/uikit/keyboards_and_input/creating_a_custom_keyboard/handling_text_interactions_in_custom_keyboards#3570304": {
      "title": "Listing 8",
      "type": "section",
      "identifier": "doc://com.apple.documentation/documentation/uikit/keyboards_and_input/creating_a_custom_keyboard/handling_text_interactions_in_custom_keyboards#3570304",
      "kind": "article",
      "role": "codeListing",
      "url": "/documentation/uikit/keyboards_and_input/creating_a_custom_keyboard/handling_text_interactions_in_custom_keyboards#3570304"
    },
    "doc://com.apple.documentation/documentation/uikit/keyboards_and_input/creating_a_custom_keyboard/handling_text_interactions_in_custom_keyboards#3570313": {
      "title": "Listing 9",
      "type": "section",
      "identifier": "doc://com.apple.documentation/documentation/uikit/keyboards_and_input/creating_a_custom_keyboard/handling_text_interactions_in_custom_keyboards#3570313",
      "kind": "article",
      "role": "codeListing",
      "url": "/documentation/uikit/keyboards_and_input/creating_a_custom_keyboard/handling_text_interactions_in_custom_keyboards#3570313"
    },
    "link-media-3570318": {
      "identifier": "link-media-3570318",
      "type": "link",
      "title": "Figure 2",
      "url": "/documentation/uikit/keyboards_and_input/creating_a_custom_keyboard/handling_text_interactions_in_custom_keyboards#3570318"
    },
    "media-3570318": {
      "identifier": "media-3570318",
      "type": "image",
      "variants": [
        {
          "traits": [
            "2x"
          ],
          "size": {
            "width": 130,
            "height": 81
          },
          "url": "https://docs-assets.developer.apple.com/published/9b1a3906d3/rendered2x-1585594586.png"
        }
      ],
      "alt": "Screenshot showing text showing marked text. The beginning of the word is marked to indicate that it’s being autocompleted, and the end of the word is selected to indicate that subsequent keystrokes will replace that portion of the text.",
      "title": "Figure 2"
    },
    "doc://com.apple.documentation/documentation/uikit/uitextdocumentproxy/3152924-unmarktext": {
      "title": "unmarkText",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/uikit/uitextdocumentproxy/3152924-unmarktext",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/uikit/uitextdocumentproxy/3152924-unmarktext",
      "fragments": [
        {
          "kind": "text",
          "text": "- "
        },
        {
          "kind": "identifier",
          "text": "unmarkText"
        }
      ]
    },
    "link-media-3570308": {
      "identifier": "link-media-3570308",
      "type": "link",
      "title": "Figure 1",
      "url": "/documentation/uikit/keyboards_and_input/creating_a_custom_keyboard/handling_text_interactions_in_custom_keyboards#3570308"
    },
    "media-3570308": {
      "identifier": "media-3570308",
      "type": "image",
      "variants": [
        {
          "traits": [
            "2x"
          ],
          "size": {
            "width": 366,
            "height": 413
          },
          "url": "https://docs-assets.developer.apple.com/published/b9f2e72c2e/custom-keyboard-app-extension@2x.png"
        },
        {
          "traits": [
            "dark",
            "2x"
          ],
          "size": {
            "width": 366,
            "height": 413
          },
          "url": "https://docs-assets.developer.apple.com/published/0cea39e95d/custom-keyboard-app-extension~dark@2x.png"
        }
      ],
      "alt": "Diagram showing the relationship of a custom keyboard extension process to the text input object. In the keyboard extension process the input view controller uses the text document proxy to insert a string into the text input view.",
      "title": "Figure 1"
    },
    "doc://com.apple.documentation/documentation/uikit/keyboards_and_input/creating_a_custom_keyboard/handling_text_interactions_in_custom_keyboards": {
      "title": "Handling Text Interactions in Custom Keyboards",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/uikit/keyboards_and_input/creating_a_custom_keyboard/handling_text_interactions_in_custom_keyboards",
      "kind": "article",
      "role": "article",
      "url": "/documentation/uikit/keyboards_and_input/creating_a_custom_keyboard/handling_text_interactions_in_custom_keyboards",
      "abstract": [
        {
          "type": "text",
          "text": "Insert, delete, and manipulate text by using a proxy to a text input view."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/technologies": {
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/technologies",
      "url": "/documentation/technologies",
      "kind": "technologies",
      "title": "Technologies"
    }
  },
  "primaryContentSections": [
    {
      "kind": "content",
      "content": [
        {
          "anchor": "overview",
          "level": 2,
          "text": "Overview",
          "type": "heading"
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "Custom keyboards execute in a separate process that doesn’t have direct access to the text a user is editing. A proxy object, "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/uikit/uitextdocumentproxy"
            },
            {
              "type": "text",
              "text": ", provides access to the input text view. Through the text document proxy you can insert or delete text, manipulate the insertion point, and access additional textual context around the insertion point."
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "image",
              "identifier": "media-3570308",
              "metadata": {
                "anchor": "3570308",
                "title": "Figure 1"
              }
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": []
        },
        {
          "level": 3,
          "type": "heading",
          "text": " Insert and Delete Text",
          "anchor": "3570302"
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "The text document proxy conforms to the "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/uikit/uikeyinput"
            },
            {
              "type": "text",
              "text": " protocol, providing methods for inserting and deleting text. To insert a character or string into the current input view:"
            }
          ]
        },
        {
          "type": "codeListing",
          "code": [
            "textDocumentProxy.insertText(\"Hello world.\")"
          ],
          "syntax": "swift",
          "metadata": {
            "anchor": "3570309",
            "title": "Listing 1"
          }
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "To delete the character preceding the current insertion point:"
            }
          ]
        },
        {
          "type": "codeListing",
          "code": [
            "textDocumentProxy.deleteBackward()"
          ],
          "syntax": "swift",
          "metadata": {
            "anchor": "3570305",
            "title": "Listing 2"
          }
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "You can determine if the input view has any text at all using the "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/uikit/uikeyinput/1614457-hastext"
            },
            {
              "type": "text",
              "text": " property:"
            }
          ]
        },
        {
          "type": "codeListing",
          "code": [
            "if textDocumentProxy.hasText {",
            "    // Do something with the text",
            "}",
            ""
          ],
          "syntax": "swift",
          "metadata": {
            "anchor": "3592486",
            "title": "Listing 3"
          }
        },
        {
          "level": 3,
          "type": "heading",
          "text": "Adjust the Insertion Point",
          "anchor": "3570303"
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "To move the insertion point in the text input view, use the "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/uikit/uitextdocumentproxy/1618194-adjusttextpositionbycharacteroff"
            },
            {
              "type": "text",
              "text": " method. For example, if you want to implement a forward delete action, move the insertion position forward by one character then delete backwards:"
            }
          ]
        },
        {
          "type": "codeListing",
          "code": [
            "// Move the text insertion position forward 1 character",
            "textDocumentProxy.adjustTextPosition(byCharacterOffset: 1)",
            "",
            "// Delete the previous character",
            "textDocumentProxy.deleteBackward()"
          ],
          "syntax": "swift",
          "metadata": {
            "anchor": "3570315",
            "title": "Listing 4"
          }
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "You might choose to enable this capability only when the insertion point isn’t at the end of the text being input by checking the context after the insertion point. See the “Get Context Around the Insertion Point” section below for more details."
            }
          ]
        },
        {
          "level": 3,
          "type": "heading",
          "text": "Respond to Changes While the User Is Editing",
          "anchor": "3570310"
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "While your keyboard is active, the user may perform operations that change the text or selection. Your custom keyboard controller, a subclass of "
            },
            {
              "type": "reference",
              "isActive": false,
              "identifier": "doc://com.apple.documentation/documentation/uikit/uiinputviewcontroller"
            },
            {
              "type": "text",
              "text": " that conforms to the "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/uikit/uitextinputdelegate"
            },
            {
              "type": "text",
              "text": " protocol, can automatically be informed of these text and selection changes. You can override two sets of methods in this delegate protocol to receive these notifications. The first set is called when text is changing, and the second is called when the selection is changing. Because your keyboard extension doesn’t have direct access to the text input field, the argument is "
            },
            {
              "type": "codeVoice",
              "code": "nil"
            },
            {
              "type": "text",
              "text": ". "
            }
          ]
        },
        {
          "type": "codeListing",
          "code": [
            "func textWillChange(_ textInput: UITextInput?)",
            "func textDidChange(_ textInput: UITextInput?)",
            "",
            "func selectionWillChange(_ textInput: UITextInput?)",
            "func selectionDidChange(_ textInput: UITextInput?)"
          ],
          "syntax": "swift",
          "metadata": {
            "anchor": "3570456",
            "title": "Listing 5"
          }
        },
        {
          "level": 3,
          "type": "heading",
          "text": "Get Context Around the Insertion Point",
          "anchor": "3570312"
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "To perform certain operations like autocomplete or autocapitalization, you may need additional context of the text surrounding what the user is typing. You can access the context before and after the insertion point as follows:"
            }
          ]
        },
        {
          "type": "codeListing",
          "code": [
            "let precedingText = textDocumentProxy.documentContextBeforeInput ?? \"\"",
            "let followingText = textDocumentProxy.documentContextAfterInput ?? \"\"",
            "let selectedText = textDocumentProxy.selectedText ?? \"\"",
            "let fullText = \"\\(precedingText)\\(selectedText)\\(followingText)\""
          ],
          "syntax": "swift",
          "metadata": {
            "anchor": "3570300",
            "title": "Listing 6"
          }
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "Use "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/corefoundation/cfstringtokenizer"
            },
            {
              "type": "text",
              "text": " to better understand the context by breaking the surrounding text (or combined text) into words, paragraphs, or sentences. This information enables you to implement autocapitalization."
            }
          ]
        },
        {
          "type": "orderedList",
          "items": [
            {
              "content": [
                {
                  "type": "paragraph",
                  "inlineContent": [
                    {
                      "type": "text",
                      "text": "Call "
                    },
                    {
                      "type": "reference",
                      "isActive": true,
                      "identifier": "doc://com.apple.documentation/documentation/uikit/uitextdocumentproxy/1618190-documentcontextbeforeinput"
                    },
                    {
                      "type": "text",
                      "text": " to get the text preceding the insertion point."
                    }
                  ]
                }
              ]
            },
            {
              "content": [
                {
                  "type": "paragraph",
                  "inlineContent": [
                    {
                      "type": "text",
                      "text": "Use "
                    },
                    {
                      "type": "reference",
                      "isActive": false,
                      "identifier": "doc://com.apple.documentation/documentation/corefoundation/cfstringtokenizer"
                    },
                    {
                      "type": "text",
                      "text": " to locate the beginning of the current word."
                    }
                  ]
                }
              ]
            },
            {
              "content": [
                {
                  "type": "paragraph",
                  "inlineContent": [
                    {
                      "type": "text",
                      "text": "Move the insertion point after the first character of the word."
                    }
                  ]
                }
              ]
            },
            {
              "content": [
                {
                  "type": "paragraph",
                  "inlineContent": [
                    {
                      "type": "text",
                      "text": "Call "
                    },
                    {
                      "type": "reference",
                      "isActive": true,
                      "identifier": "doc://com.apple.documentation/documentation/uikit/uikeyinput/1614572-deletebackward"
                    },
                    {
                      "type": "text",
                      "text": "."
                    }
                  ]
                }
              ]
            },
            {
              "content": [
                {
                  "type": "paragraph",
                  "inlineContent": [
                    {
                      "type": "text",
                      "text": "Call "
                    },
                    {
                      "type": "reference",
                      "isActive": true,
                      "identifier": "doc://com.apple.documentation/documentation/uikit/uikeyinput/1614543-inserttext"
                    },
                    {
                      "type": "text",
                      "text": " and pass the appropriate capitalized letter."
                    }
                  ]
                }
              ]
            },
            {
              "content": [
                {
                  "type": "paragraph",
                  "inlineContent": [
                    {
                      "type": "text",
                      "text": "Move the insertion point back to its original position."
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "level": 3,
          "type": "heading",
          "text": "Mark Text While the User Is Editing",
          "anchor": "3570316"
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "Some text input operations require multiple actions in order to complete a single character or word. For example, your keyboard might support a language that requires multiple keystrokes to compose a single character. "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/uikit/uitextdocumentproxy"
            },
            {
              "type": "text",
              "text": " allows you to insert text and mark some or all of it for subsequent editing operations. "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/uikit/keyboards_and_input/creating_a_custom_keyboard/handling_text_interactions_in_custom_keyboards#3570311"
            },
            {
              "type": "text",
              "text": " shows how you could insert a combining accent character as marked text using "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/uikit/uitextdocumentproxy/3152923-setmarkedtext"
            },
            {
              "type": "text",
              "text": ":"
            }
          ]
        },
        {
          "type": "codeListing",
          "code": [
            "let accentCharacter = \" \\u{0301}\"",
            "let range = NSRange(location: 0, length: accentCharacter.count)",
            "textDocumentProxy.setMarkedText(accentCharacter, selectedRange: range)"
          ],
          "syntax": "swift",
          "metadata": {
            "anchor": "3570311",
            "title": "Listing 7"
          }
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "Calling "
            },
            {
              "type": "codeVoice",
              "code": "setMarkedText"
            },
            {
              "type": "text",
              "text": " selects the text specified by "
            },
            {
              "type": "codeVoice",
              "code": "range"
            },
            {
              "type": "text",
              "text": ". Subsequent insertions replace the characters selected in the range. In the example above, a space with a combining acute accent is shown. If the next character input by the user is an "
            },
            {
              "type": "codeVoice",
              "code": "a"
            },
            {
              "type": "text",
              "text": ", you could then insert a combined "
            },
            {
              "type": "codeVoice",
              "code": "á"
            },
            {
              "type": "text",
              "text": ". "
            }
          ]
        },
        {
          "type": "codeListing",
          "code": [
            "textDocumentProxy.insertText(\"a\\u{0301}\")"
          ],
          "syntax": "swift",
          "metadata": {
            "anchor": "3570304",
            "title": "Listing 8"
          }
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "If the range passed to "
            },
            {
              "type": "reference",
              "isActive": false,
              "identifier": "doc://com.apple.documentation/documentation/uikit/uitextdocumentproxy/3152923-setmarkedtext"
            },
            {
              "type": "text",
              "text": " only covers a portion of the string passed in, the nonselected portion is marked with a background color. You could use this to display autocompleted content. For example, if you supported autocompletion of names and the user had typed “Anth”, you might display “Anthony” as the autocompletion:"
            }
          ]
        },
        {
          "type": "codeListing",
          "code": [
            "let text = \"Anthony\"",
            "let range = NSRange(location: 4, length: 3)",
            "textDocumentProxy.setMarkedText(text, selectedRange: range)"
          ],
          "syntax": "swift",
          "metadata": {
            "anchor": "3570313",
            "title": "Listing 9"
          }
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "The above would display the text as: "
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "image",
              "identifier": "media-3570318",
              "metadata": {
                "anchor": "3570318",
                "title": "Figure 2"
              }
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "As the user continues to type, you can update the marked text with subsequent calls to "
            },
            {
              "type": "reference",
              "isActive": false,
              "identifier": "doc://com.apple.documentation/documentation/uikit/uitextdocumentproxy/3152923-setmarkedtext"
            },
            {
              "type": "text",
              "text": ". "
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "Call "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/uikit/uitextdocumentproxy/3152924-unmarktext"
            },
            {
              "type": "text",
              "text": " to clear the marked text indication, leaving the text in the input view."
            }
          ]
        }
      ]
    }
  ],
  "legalNotices": {
    "copyright": "Copyright &copy; 2021 Apple Inc. All rights reserved.",
    "termsOfUse": "https://www.apple.com/legal/internet-services/terms/site.html",
    "privacyPolicy": "https://www.apple.com/privacy/privacy-policy"
  }
}