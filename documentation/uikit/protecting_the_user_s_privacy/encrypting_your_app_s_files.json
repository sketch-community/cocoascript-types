{
  "abstract": [
    {
      "type": "text",
      "text": "Protect the user’s data in iOS by encrypting it on disk."
    }
  ],
  "documentVersion": 0,
  "hierarchy": {
    "paths": [
      [
        "doc://com.apple.documentation/documentation/technologies",
        "doc://com.apple.documentation/documentation/uikit",
        "doc://com.apple.documentation/documentation/uikit/protecting_the_user_s_privacy"
      ],
      [
        "doc://com.apple.documentation/documentation/technologies",
        "doc://com.apple.documentation/documentation/appkit",
        "doc://com.apple.documentation/documentation/uikit/protecting_the_user_s_privacy"
      ]
    ]
  },
  "identifier": {
    "url": "doc://com.apple.documentation/documentation/uikit/protecting_the_user_s_privacy/encrypting_your_app_s_files",
    "interfaceLanguage": "occ"
  },
  "legacy_identifier": 2928955,
  "kind": "article",
  "metadata": {
    "title": "Encrypting Your App’s Files",
    "role": "article",
    "roleHeading": "Article",
    "modules": [
      {
        "name": "UIKit"
      }
    ]
  },
  "schemaVersion": {
    "major": 0,
    "minor": 1,
    "patch": 0
  },
  "sections": [],
  "variants": [
    {
      "traits": [
        {
          "interfaceLanguage": "occ"
        }
      ],
      "paths": [
        "documentation/uikit/protecting_the_user_s_privacy/encrypting_your_app_s_files",
        "documentation/appkit/protecting_the_user_s_privacy/encrypting_your_app_s_files"
      ]
    },
    {
      "traits": [
        {
          "interfaceLanguage": "swift"
        }
      ],
      "paths": [
        "documentation/uikit/protecting_the_user_s_privacy/encrypting_your_app_s_files",
        "documentation/appkit/protecting_the_user_s_privacy/encrypting_your_app_s_files"
      ]
    }
  ],
  "references": {
    "doc://com.apple.documentation/documentation/uikit": {
      "title": "UIKit",
      "identifier": "doc://com.apple.documentation/documentation/uikit",
      "url": "/documentation/uikit",
      "type": "topic",
      "kind": "symbol",
      "role": "collection"
    },
    "doc://com.apple.documentation/documentation/uikit/protecting_the_user_s_privacy": {
      "title": "Protecting the User’s Privacy",
      "identifier": "doc://com.apple.documentation/documentation/uikit/protecting_the_user_s_privacy",
      "url": "/documentation/uikit/protecting_the_user_s_privacy",
      "type": "topic",
      "kind": "article",
      "role": "article"
    },
    "doc://com.apple.documentation/documentation/appkit": {
      "title": "AppKit",
      "identifier": "doc://com.apple.documentation/documentation/appkit",
      "url": "/documentation/appkit",
      "type": "topic",
      "kind": "symbol",
      "role": "collection"
    },
    "doc://com.apple.documentation/documentation/uikit/uiapplicationdelegate/1623019-applicationprotecteddatawillbeco": {
      "title": "applicationProtectedDataWillBecomeUnavailable:",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/uikit/uiapplicationdelegate/1623019-applicationprotecteddatawillbeco",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/uikit/uiapplicationdelegate/1623019-applicationprotecteddatawillbeco",
      "fragments": [
        {
          "kind": "text",
          "text": "- "
        },
        {
          "kind": "identifier",
          "text": "applicationProtectedDataWillBecomeUnavailable:"
        }
      ]
    },
    "doc://com.apple.documentation/documentation/uikit/uiapplicationdelegate/1623044-applicationprotecteddatadidbecom": {
      "title": "applicationProtectedDataDidBecomeAvailable:",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/uikit/uiapplicationdelegate/1623044-applicationprotecteddatadidbecom",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/uikit/uiapplicationdelegate/1623044-applicationprotecteddatadidbecom",
      "fragments": [
        {
          "kind": "text",
          "text": "- "
        },
        {
          "kind": "identifier",
          "text": "applicationProtectedDataDidBecomeAvailable:"
        }
      ]
    },
    "doc://com.apple.documentation/documentation/foundation/nsdatawritingoptions/nsdatawritingfileprotectioncomplete": {
      "title": "NSDataWritingFileProtectionComplete",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/foundation/nsdatawritingoptions/nsdatawritingfileprotectioncomplete",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/foundation/nsdatawritingoptions/nsdatawritingfileprotectioncomplete"
    },
    "doc://com.apple.documentation/documentation/foundation/data/1779858-write": {
      "title": "write(to:options:)",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/foundation/data/1779858-write",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/foundation/data/1779858-write"
    },
    "doc://com.apple.documentation/documentation/foundation/data": {
      "title": "Data",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/foundation/data",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/foundation/data"
    },
    "doc://com.apple.documentation/documentation/uikit/protecting_the_user_s_privacy/encrypting_your_app_s_files#2928956": {
      "title": "Listing 1",
      "type": "section",
      "identifier": "doc://com.apple.documentation/documentation/uikit/protecting_the_user_s_privacy/encrypting_your_app_s_files#2928956",
      "kind": "article",
      "role": "codeListing",
      "url": "/documentation/uikit/protecting_the_user_s_privacy/encrypting_your_app_s_files#2928956",
      "abstract": [
        {
          "type": "text",
          "text": "Encrypting a file on first write"
        }
      ]
    },
    "doc://com.apple.documentation/documentation/foundation/nsurl/1413819-setresourcevalue": {
      "title": "setResourceValue:forKey:error:",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/foundation/nsurl/1413819-setresourcevalue",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/foundation/nsurl/1413819-setresourcevalue",
      "fragments": [
        {
          "kind": "text",
          "text": "- "
        },
        {
          "kind": "identifier",
          "text": "setResourceValue:forKey:error:"
        }
      ]
    },
    "doc://com.apple.documentation/documentation/foundation/nsurl": {
      "title": "NSURL",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/foundation/nsurl",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/foundation/nsurl"
    },
    "doc://com.apple.documentation/documentation/foundation/nsurlfileprotectionkey": {
      "title": "NSURLFileProtectionKey",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/foundation/nsurlfileprotectionkey",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/foundation/nsurlfileprotectionkey"
    },
    "doc://com.apple.documentation/documentation/uikit/protecting_the_user_s_privacy/encrypting_your_app_s_files#2928957": {
      "title": "Listing 2",
      "type": "section",
      "identifier": "doc://com.apple.documentation/documentation/uikit/protecting_the_user_s_privacy/encrypting_your_app_s_files#2928957",
      "kind": "article",
      "role": "codeListing",
      "url": "/documentation/uikit/protecting_the_user_s_privacy/encrypting_your_app_s_files#2928957",
      "abstract": [
        {
          "type": "text",
          "text": "Encrypting an existing file on disk"
        }
      ]
    },
    "doc://com.apple.documentation/documentation/uikit/protecting_the_user_s_privacy/requesting_access_to_protected_resources": {
      "title": "Requesting Access to Protected Resources",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/uikit/protecting_the_user_s_privacy/requesting_access_to_protected_resources",
      "kind": "article",
      "role": "article",
      "url": "/documentation/uikit/protecting_the_user_s_privacy/requesting_access_to_protected_resources",
      "abstract": [
        {
          "type": "text",
          "text": "Provide a purpose string that explains to the user why you need access to protected resources."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/uikit/protecting_the_user_s_privacy/encrypting_your_app_s_files": {
      "title": "Encrypting Your App’s Files",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/uikit/protecting_the_user_s_privacy/encrypting_your_app_s_files",
      "kind": "article",
      "role": "article",
      "url": "/documentation/uikit/protecting_the_user_s_privacy/encrypting_your_app_s_files",
      "abstract": [
        {
          "type": "text",
          "text": "Protect the user’s data in iOS by encrypting it on disk."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/technologies": {
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/technologies",
      "url": "/documentation/technologies",
      "kind": "technologies",
      "title": "Technologies"
    }
  },
  "seeAlsoSections": [
    {
      "identifiers": [
        "doc://com.apple.documentation/documentation/uikit/protecting_the_user_s_privacy/requesting_access_to_protected_resources"
      ],
      "title": "Supporting Privacy",
      "generated": true
    }
  ],
  "primaryContentSections": [
    {
      "kind": "content",
      "content": [
        {
          "anchor": "overview",
          "level": 2,
          "text": "Overview",
          "type": "heading"
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "Data protection is an iOS feature that you use to secure your app’s files and prevent unauthorized access to them. Data protection is enabled automatically when the user sets an active passcode for the device. You read and write your files normally, but the system encrypts and decrypts your content behind the scenes. The encryption and decryption processes are automatic and hardware accelerated. "
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "You specify the level of data protection that you want to apply to each of your files. There are four levels available, each of which determines when you may access the file. If you do not specify a protection level when creating a file, iOS applies the default protection level automatically."
            }
          ]
        },
        {
          "type": "unorderedList",
          "items": [
            {
              "content": [
                {
                  "type": "paragraph",
                  "inlineContent": [
                    {
                      "type": "strong",
                      "inlineContent": [
                        {
                          "type": "text",
                          "text": "No protection."
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "text": " The file is always accessible. "
                    }
                  ]
                }
              ]
            },
            {
              "content": [
                {
                  "type": "paragraph",
                  "inlineContent": [
                    {
                      "type": "strong",
                      "inlineContent": [
                        {
                          "type": "text",
                          "text": "Complete until first user authentication."
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "text": " (Default) The file is inaccessible until the first time the user unlocks the device. After the first unlocking of the device, the file remains accessible until the device shuts down or reboots."
                    }
                  ]
                }
              ]
            },
            {
              "content": [
                {
                  "type": "paragraph",
                  "inlineContent": [
                    {
                      "type": "strong",
                      "inlineContent": [
                        {
                          "type": "text",
                          "text": "Complete unless open."
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "text": " You can open existing files only when the device is unlocked. If you have a file already open, you may continue to access that file even after the user locks the device. You can also create new files and access them while the device is locked or unlocked."
                    }
                  ]
                }
              ]
            },
            {
              "content": [
                {
                  "type": "paragraph",
                  "inlineContent": [
                    {
                      "type": "strong",
                      "inlineContent": [
                        {
                          "type": "text",
                          "text": "Complete."
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "text": " The file is accessible only when the device is unlocked. "
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "To create and encrypt a new file in one step, construct a data object with the file's contents and call the "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/foundation/data/1779858-write"
            },
            {
              "type": "text",
              "text": " method. When calling the method, specify the data protection option that you want applied to the file. "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/uikit/protecting_the_user_s_privacy/encrypting_your_app_s_files#2928956"
            },
            {
              "type": "text",
              "text": " shows an example of how to write out the contents of a "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/foundation/data"
            },
            {
              "type": "text",
              "text": " instance to a file and encrypt it using the complete protection level. "
            }
          ]
        },
        {
          "type": "codeListing",
          "code": [
            "do {",
            "   try data.write(to: fileURL, options: .completeFileProtection)",
            "}",
            "catch {",
            "   // Handle errors.",
            "}"
          ],
          "syntax": "swift",
          "metadata": {
            "anchor": "2928956",
            "title": "Listing 1",
            "abstract": [
              {
                "type": "text",
                "text": "Encrypting a file on first write"
              }
            ]
          }
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "To change the data protection level of an existing file, use the "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/foundation/nsurl/1413819-setresourcevalue"
            },
            {
              "type": "text",
              "text": " method of "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/foundation/nsurl"
            },
            {
              "type": "text",
              "text": ". When calling this method, assign the new data protection option to the "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/foundation/nsurlfileprotectionkey"
            },
            {
              "type": "text",
              "text": " resource key. "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/uikit/protecting_the_user_s_privacy/encrypting_your_app_s_files#2928957"
            },
            {
              "type": "text",
              "text": " shows an example that adds this key to an existing file. "
            }
          ]
        },
        {
          "type": "codeListing",
          "code": [
            "do {",
            "   try (fileURL as NSURL).setResourceValue( ",
            "                  URLFileProtection.complete,",
            "                  forKey: .fileProtectionKey)",
            "}",
            "catch {",
            "   // Handle errors.",
            "}"
          ],
          "syntax": "swift",
          "metadata": {
            "anchor": "2928957",
            "title": "Listing 2",
            "abstract": [
              {
                "type": "text",
                "text": "Encrypting an existing file on disk"
              }
            ]
          }
        },
        {
          "type": "paragraph",
          "inlineContent": []
        },
        {
          "level": 3,
          "type": "heading",
          "text": "Manage Your Access to Encrypted Files",
          "anchor": "2928958"
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "Depending on a file’s protection level, attempts to read or write its contents could fail when the user subsequently locks the device. To ensure that your app is able to access files, do the following:"
            }
          ]
        },
        {
          "type": "unorderedList",
          "items": [
            {
              "content": [
                {
                  "type": "paragraph",
                  "inlineContent": [
                    {
                      "type": "text",
                      "text": "Choose the right data protection level for your needs."
                    }
                  ]
                }
              ]
            },
            {
              "content": [
                {
                  "type": "paragraph",
                  "inlineContent": [
                    {
                      "type": "text",
                      "text": "Use the app delegate’s "
                    },
                    {
                      "type": "reference",
                      "isActive": true,
                      "identifier": "doc://com.apple.documentation/documentation/uikit/uiapplicationdelegate/1623019-applicationprotecteddatawillbeco"
                    },
                    {
                      "type": "text",
                      "text": " and "
                    },
                    {
                      "type": "reference",
                      "isActive": true,
                      "identifier": "doc://com.apple.documentation/documentation/uikit/uiapplicationdelegate/1623044-applicationprotecteddatadidbecom"
                    },
                    {
                      "type": "text",
                      "text": " methods to close and reopen files with the "
                    },
                    {
                      "type": "reference",
                      "isActive": true,
                      "identifier": "doc://com.apple.documentation/documentation/foundation/nsdatawritingoptions/nsdatawritingfileprotectioncomplete"
                    },
                    {
                      "type": "text",
                      "text": " level."
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "Assign the complete protection level to files that your app accesses only when it is in the foreground. If your app supports background capabilities, such as handling location updates, assign a different protection level for files that you might access while in the background. For example, a fitness app might use the complete unless open protection level on a file that it uses to log location events in the background."
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "Files containing personal information about the user, or files created directly by the user, always warrant the strongest level of protection. Assign the complete protection level to user data files and manage access to those files using the app delegate methods. The app delegate methods give you time to close the files before they become inaccessible to your app."
            }
          ]
        }
      ]
    }
  ],
  "legalNotices": {
    "copyright": "Copyright &copy; 2021 Apple Inc. All rights reserved.",
    "termsOfUse": "https://www.apple.com/legal/internet-services/terms/site.html",
    "privacyPolicy": "https://www.apple.com/privacy/privacy-policy"
  }
}