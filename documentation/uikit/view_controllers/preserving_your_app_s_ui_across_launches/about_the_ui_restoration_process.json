{
  "abstract": [
    {
      "type": "text",
      "text": "Learn how to customize the UIKit state restoration process."
    }
  ],
  "documentVersion": 0,
  "hierarchy": {
    "paths": [
      [
        "doc://com.apple.documentation/documentation/technologies",
        "doc://com.apple.documentation/documentation/uikit",
        "doc://com.apple.documentation/documentation/uikit/view_controllers",
        "doc://com.apple.documentation/documentation/uikit/view_controllers/preserving_your_app_s_ui_across_launches"
      ],
      [
        "doc://com.apple.documentation/documentation/technologies",
        "doc://com.apple.documentation/documentation/uikit",
        "doc://com.apple.documentation/documentation/uikit/app_and_environment",
        "doc://com.apple.documentation/documentation/uikit/app_and_environment/responding_to_the_launch_of_your_app",
        "doc://com.apple.documentation/documentation/uikit/view_controllers/preserving_your_app_s_ui_across_launches"
      ]
    ]
  },
  "identifier": {
    "url": "doc://com.apple.documentation/documentation/uikit/view_controllers/preserving_your_app_s_ui_across_launches/about_the_ui_restoration_process",
    "interfaceLanguage": "occ"
  },
  "legacy_identifier": 2928972,
  "kind": "article",
  "metadata": {
    "title": "About the UI Restoration Process",
    "role": "article",
    "roleHeading": "Article",
    "modules": [
      {
        "name": "UIKit"
      }
    ]
  },
  "schemaVersion": {
    "major": 1,
    "minor": 0,
    "patch": 0
  },
  "sections": [],
  "variants": [
    {
      "traits": [
        {
          "interfaceLanguage": "occ"
        }
      ],
      "paths": [
        "documentation/uikit/view_controllers/preserving_your_app_s_ui_across_launches/about_the_ui_restoration_process",
        "documentation/uikit/app_and_environment/responding_to_the_launch_of_your_app/preserving_your_app_s_ui_across_launches/about_the_ui_restoration_process"
      ]
    },
    {
      "traits": [
        {
          "interfaceLanguage": "swift"
        }
      ],
      "paths": [
        "documentation/uikit/view_controllers/preserving_your_app_s_ui_across_launches/about_the_ui_restoration_process",
        "documentation/uikit/app_and_environment/responding_to_the_launch_of_your_app/preserving_your_app_s_ui_across_launches/about_the_ui_restoration_process"
      ]
    }
  ],
  "references": {
    "doc://com.apple.documentation/documentation/uikit": {
      "title": "UIKit",
      "identifier": "doc://com.apple.documentation/documentation/uikit",
      "url": "/documentation/uikit",
      "type": "topic",
      "kind": "symbol",
      "role": "collection"
    },
    "doc://com.apple.documentation/documentation/uikit/view_controllers": {
      "title": "View Controllers",
      "identifier": "doc://com.apple.documentation/documentation/uikit/view_controllers",
      "url": "/documentation/uikit/view_controllers",
      "type": "topic",
      "kind": "article",
      "role": "collectionGroup"
    },
    "doc://com.apple.documentation/documentation/uikit/view_controllers/preserving_your_app_s_ui_across_launches": {
      "title": "Preserving Your App's UI Across Launches",
      "identifier": "doc://com.apple.documentation/documentation/uikit/view_controllers/preserving_your_app_s_ui_across_launches",
      "url": "/documentation/uikit/view_controllers/preserving_your_app_s_ui_across_launches",
      "type": "topic",
      "kind": "article",
      "role": "article"
    },
    "doc://com.apple.documentation/documentation/uikit/app_and_environment": {
      "title": "App and Environment",
      "identifier": "doc://com.apple.documentation/documentation/uikit/app_and_environment",
      "url": "/documentation/uikit/app_and_environment",
      "type": "topic",
      "kind": "article",
      "role": "collectionGroup"
    },
    "doc://com.apple.documentation/documentation/uikit/app_and_environment/responding_to_the_launch_of_your_app": {
      "title": "Responding to the Launch of Your App",
      "identifier": "doc://com.apple.documentation/documentation/uikit/app_and_environment/responding_to_the_launch_of_your_app",
      "url": "/documentation/uikit/app_and_environment/responding_to_the_launch_of_your_app",
      "type": "topic",
      "kind": "article",
      "role": "article"
    },
    "doc://com.apple.documentation/documentation/uikit/uiviewcontroller/1621472-restorationclass": {
      "title": "restorationClass",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/uikit/uiviewcontroller/1621472-restorationclass",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/uikit/uiviewcontroller/1621472-restorationclass"
    },
    "doc://com.apple.documentation/documentation/uikit/uiviewcontrollerrestoration/1616859-viewcontrollerwithrestorationide": {
      "title": "viewControllerWithRestorationIdentifierPath:coder:",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/uikit/uiviewcontrollerrestoration/1616859-viewcontrollerwithrestorationide",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/uikit/uiviewcontrollerrestoration/1616859-viewcontrollerwithrestorationide",
      "fragments": [
        {
          "kind": "text",
          "text": "+ "
        },
        {
          "kind": "identifier",
          "text": "viewControllerWithRestorationIdentifierPath:coder:"
        }
      ]
    },
    "doc://com.apple.documentation/documentation/uikit/uiapplicationdelegate/1623062-application": {
      "title": "application:viewControllerWithRestorationIdentifierPath:coder:",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/uikit/uiapplicationdelegate/1623062-application",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/uikit/uiapplicationdelegate/1623062-application",
      "fragments": [
        {
          "kind": "text",
          "text": "- "
        },
        {
          "kind": "identifier",
          "text": "application:viewControllerWithRestorationIdentifierPath:coder:"
        }
      ]
    },
    "doc://com.apple.documentation/documentation/uikit/uiviewcontroller/1621499-restorationidentifier": {
      "title": "restorationIdentifier",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/uikit/uiviewcontroller/1621499-restorationidentifier",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/uikit/uiviewcontroller/1621499-restorationidentifier"
    },
    "doc://com.apple.documentation/documentation/uikit/view_controllers/preserving_your_app_s_ui_across_launches/about_the_ui_restoration_process#2928974": {
      "title": "Listing 1",
      "type": "section",
      "identifier": "doc://com.apple.documentation/documentation/uikit/view_controllers/preserving_your_app_s_ui_across_launches/about_the_ui_restoration_process#2928974",
      "kind": "article",
      "role": "codeListing",
      "url": "/documentation/uikit/view_controllers/preserving_your_app_s_ui_across_launches/about_the_ui_restoration_process#2928974"
    },
    "doc://com.apple.documentation/documentation/uikit/uiviewcontroller/1621429-decoderestorablestatewithcoder": {
      "title": "decodeRestorableStateWithCoder:",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/uikit/uiviewcontroller/1621429-decoderestorablestatewithcoder",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/uikit/uiviewcontroller/1621429-decoderestorablestatewithcoder",
      "fragments": [
        {
          "kind": "text",
          "text": "- "
        },
        {
          "kind": "identifier",
          "text": "decodeRestorableStateWithCoder:"
        }
      ]
    },
    "doc://com.apple.documentation/documentation/uikit/uiapplicationdelegate/1622987-application": {
      "title": "application:shouldRestoreApplicationState:",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/uikit/uiapplicationdelegate/1622987-application",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/uikit/uiapplicationdelegate/1622987-application",
      "fragments": [
        {
          "kind": "text",
          "text": "- "
        },
        {
          "kind": "identifier",
          "text": "application:shouldRestoreApplicationState:"
        }
      ]
    },
    "doc://com.apple.documentation/documentation/objectivec/yes": {
      "title": "YES",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/objectivec/yes",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/objectivec/yes"
    },
    "link-media-2934436": {
      "identifier": "link-media-2934436",
      "type": "link",
      "title": "Figure 1",
      "url": "/documentation/uikit/view_controllers/preserving_your_app_s_ui_across_launches/about_the_ui_restoration_process#2934436"
    },
    "media-2934436": {
      "identifier": "media-2934436",
      "type": "image",
      "variants": [
        {
          "traits": [
            "2x"
          ],
          "size": {
            "width": 491,
            "height": 538
          },
          "url": "https://docs-assets.developer.apple.com/published/9fd35a9f67/92b434a7-dc7e-479c-b668-dbb70bb1dd2e.png"
        }
      ],
      "title": "Figure 1",
      "abstract": [
        {
          "type": "text",
          "text": "The interface restoration sequence"
        }
      ]
    },
    "doc://com.apple.documentation/documentation/uikit/uistaterestoring/1616854-decoderestorablestatewithcoder": {
      "title": "decodeRestorableStateWithCoder:",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/uikit/uistaterestoring/1616854-decoderestorablestatewithcoder",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/uikit/uistaterestoring/1616854-decoderestorablestatewithcoder",
      "fragments": [
        {
          "kind": "text",
          "text": "- "
        },
        {
          "kind": "identifier",
          "text": "decodeRestorableStateWithCoder:"
        }
      ]
    },
    "doc://com.apple.documentation/documentation/uikit/uiapplicationdelegate/1622921-application": {
      "title": "application:didFinishLaunchingWithOptions:",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/uikit/uiapplicationdelegate/1622921-application",
      "kind": "symbol",
      "role": "symbol",
      "url": "/documentation/uikit/uiapplicationdelegate/1622921-application",
      "fragments": [
        {
          "kind": "text",
          "text": "- "
        },
        {
          "kind": "identifier",
          "text": "application:didFinishLaunchingWithOptions:"
        }
      ]
    },
    "doc://com.apple.documentation/documentation/uikit/view_controllers/preserving_your_app_s_ui_across_launches/about_the_ui_preservation_process": {
      "title": "About the UI Preservation Process",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/uikit/view_controllers/preserving_your_app_s_ui_across_launches/about_the_ui_preservation_process",
      "kind": "article",
      "role": "article",
      "url": "/documentation/uikit/view_controllers/preserving_your_app_s_ui_across_launches/about_the_ui_preservation_process",
      "abstract": [
        {
          "type": "text",
          "text": "Learn how to customize the UIKit state preservation process. "
        }
      ]
    },
    "doc://com.apple.documentation/documentation/uikit/view_controllers/preserving_your_app_s_ui_across_launches/about_the_ui_restoration_process": {
      "title": "About the UI Restoration Process",
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/uikit/view_controllers/preserving_your_app_s_ui_across_launches/about_the_ui_restoration_process",
      "kind": "article",
      "role": "article",
      "url": "/documentation/uikit/view_controllers/preserving_your_app_s_ui_across_launches/about_the_ui_restoration_process",
      "abstract": [
        {
          "type": "text",
          "text": "Learn how to customize the UIKit state restoration process."
        }
      ]
    },
    "doc://com.apple.documentation/documentation/technologies": {
      "type": "topic",
      "identifier": "doc://com.apple.documentation/documentation/technologies",
      "url": "/documentation/technologies",
      "kind": "technologies",
      "title": "Technologies"
    }
  },
  "seeAlsoSections": [
    {
      "identifiers": [
        "doc://com.apple.documentation/documentation/uikit/view_controllers/preserving_your_app_s_ui_across_launches/about_the_ui_preservation_process"
      ],
      "title": "Process Details",
      "generated": true
    }
  ],
  "primaryContentSections": [
    {
      "kind": "content",
      "content": [
        {
          "anchor": "overview",
          "level": 2,
          "text": "Overview",
          "type": "heading"
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "reference",
              "isActive": true,
              "identifier": "link-media-2934436"
            },
            {
              "type": "text",
              "text": " illustrates the sequence of calls that happens from the time your app launches until the time it is restored. Restoration occurs during the middle of your app’s initialization, and it proceeds only when a state restoration archive is available and your app delegate’s "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/uikit/uiapplicationdelegate/1622987-application"
            },
            {
              "type": "text",
              "text": " method returns "
            },
            {
              "type": "reference",
              "isActive": false,
              "identifier": "doc://com.apple.documentation/documentation/objectivec/yes"
            },
            {
              "type": "text",
              "text": ". "
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "image",
              "identifier": "media-2934436",
              "metadata": {
                "anchor": "2934436",
                "title": "Figure 1",
                "abstract": [
                  {
                    "type": "text",
                    "text": "The interface restoration sequence"
                  }
                ]
              }
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": []
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "The first step in the restoration process is to create the view controller objects (either explicitly or implicitly) for your interface. The second step is to decode and restore the state of those objects. Both steps are needed to recreate your view controller hierarchy. For example, after the creation of a navigation controller and its child view controllers, there is no immediate connection between those objects. It is actually the navigation controller’s "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/uikit/uistaterestoring/1616854-decoderestorablestatewithcoder"
            },
            {
              "type": "text",
              "text": " method that reestablishes the relationships to its child view controllers."
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "After state restoration finishes, UIKit calls the app delegate’s "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/uikit/uiapplicationdelegate/1622921-application"
            },
            {
              "type": "text",
              "text": " method. Use that method to make any last minute changes or additions to your interface. For example, you might add a login screen to the view controller hierarchy.  "
            }
          ]
        },
        {
          "level": 3,
          "type": "heading",
          "text": "Recreate Your View Controllers",
          "anchor": "2928973"
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "During restoration, UIKit tries to create or locate view controller objects from your preserved interface. UIKit first asks you to provide the view controller object. If you do not provide the view controller, UIKit looks for it implicitly. Here is the sequence of steps that UIKit follows to recreate view controllers:"
            }
          ]
        },
        {
          "type": "orderedList",
          "items": [
            {
              "content": [
                {
                  "type": "paragraph",
                  "inlineContent": [
                    {
                      "type": "strong",
                      "inlineContent": [
                        {
                          "type": "text",
                          "text": "Ask the view controller’s restoration class."
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "text": " A restoration class knows how to create a specific view controller. You designate a restoration class by assigning that class to the "
                    },
                    {
                      "type": "reference",
                      "isActive": true,
                      "identifier": "doc://com.apple.documentation/documentation/uikit/uiviewcontroller/1621472-restorationclass"
                    },
                    {
                      "type": "text",
                      "text": " property of your view controller. During restoration, UIKit calls the "
                    },
                    {
                      "type": "reference",
                      "isActive": true,
                      "identifier": "doc://com.apple.documentation/documentation/uikit/uiviewcontrollerrestoration/1616859-viewcontrollerwithrestorationide"
                    },
                    {
                      "type": "text",
                      "text": " method of the restoration class to request a new instance of the view controller, which your method then returns. If you return "
                    },
                    {
                      "type": "codeVoice",
                      "code": "nil"
                    },
                    {
                      "type": "text",
                      "text": ", UIKit stops trying to create the view controller and leaves it out of the restoration process."
                    }
                  ]
                }
              ]
            },
            {
              "content": [
                {
                  "type": "paragraph",
                  "inlineContent": [
                    {
                      "type": "strong",
                      "inlineContent": [
                        {
                          "type": "text",
                          "text": "Ask the app delegate."
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "text": " If the view controller had no restoration class, UIKit calls the "
                    },
                    {
                      "type": "reference",
                      "isActive": true,
                      "identifier": "doc://com.apple.documentation/documentation/uikit/uiapplicationdelegate/1623062-application"
                    },
                    {
                      "type": "text",
                      "text": " method of the app delegate. If you return "
                    },
                    {
                      "type": "codeVoice",
                      "code": "nil"
                    },
                    {
                      "type": "text",
                      "text": " from that method, UIKit continues searching."
                    }
                  ]
                }
              ]
            },
            {
              "content": [
                {
                  "type": "paragraph",
                  "inlineContent": [
                    {
                      "type": "strong",
                      "inlineContent": [
                        {
                          "type": "text",
                          "text": "Check for an existing object."
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "text": " UIKit looks for an already created view controller with the exact same restoration path. "
                    }
                  ]
                }
              ]
            },
            {
              "content": [
                {
                  "type": "paragraph",
                  "inlineContent": [
                    {
                      "type": "strong",
                      "inlineContent": [
                        {
                          "type": "text",
                          "text": "Instantiate the view controller from your storyboards."
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "text": " If it still does not have the view controller, UIKit automatically instantiates it from your app’s storyboards."
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "Before state restoration even begins, UIKit loads your app’s default view controllers from your storyboards. Because UIKit loads these view controllers for free, it is better not to create them using a restoration class or your app delegate. For all other view controllers, assign a restoration class only if the view controller is not defined in your storyboards. You might also assign a restoration class to prevent the creation of your view controller in specific circumstances. For example, you might want to avoid displaying the view controller if the associated restoration archive refers to stale or missing data. "
            }
          ]
        },
        {
          "type": "paragraph",
          "inlineContent": [
            {
              "type": "text",
              "text": "When recreating view controllers in code, always reassign a value to the view controller’s "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/uikit/uiviewcontroller/1621499-restorationidentifier"
            },
            {
              "type": "text",
              "text": " property in addition to any other initialization. Also assign a value to the "
            },
            {
              "type": "reference",
              "isActive": true,
              "identifier": "doc://com.apple.documentation/documentation/uikit/uiviewcontroller/1621472-restorationclass"
            },
            {
              "type": "text",
              "text": " property as appropriate. Assigning these values at creation time ensures that the view controller will be preserved during the next cycle. "
            }
          ]
        },
        {
          "type": "codeListing",
          "code": [
            "func viewController(withRestorationIdentifierPath ",
            "                    identifierComponents: [Any], ",
            "                    coder: NSCoder) -> UIViewController? {",
            "   let vc = MyViewController()",
            "        ",
            "   vc.restorationIdentifier = identifierComponents.last as? String",
            "   vc.restorationClass = MyViewController.self",
            "        ",
            "   return vc",
            "}"
          ],
          "syntax": "swift",
          "metadata": {
            "anchor": "2928974",
            "title": "Listing 1"
          }
        },
        {
          "type": "aside",
          "content": [
            {
              "type": "paragraph",
              "inlineContent": [
                {
                  "type": "text",
                  "text": "Your restoration class should always return the class expected by UIKit. The restoration archive includes the class of each preserved view controller. If your restoration class returns an instance of a different class, UIKit does not call that view controller’s "
                },
                {
                  "type": "reference",
                  "isActive": true,
                  "identifier": "doc://com.apple.documentation/documentation/uikit/uiviewcontroller/1621429-decoderestorablestatewithcoder"
                },
                {
                  "type": "text",
                  "text": " method."
                }
              ]
            }
          ],
          "style": "note",
          "name": "Note"
        }
      ]
    }
  ],
  "legalNotices": {
    "copyright": "Copyright &copy; 2020 Apple Inc. All rights reserved.",
    "termsOfUse": "https://www.apple.com/legal/internet-services/terms/site.html",
    "privacyPolicy": "https://www.apple.com/privacy/privacy-policy"
  }
}